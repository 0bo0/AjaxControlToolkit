// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License.
// See http://www.microsoft.com/opensource/licenses.mspx#Ms-PL.
// All other rights reserved.
(function(){var scriptName="ExtendedHTMLEditor";function execute(){var Hd="_ctl01",Gd="beforeActiveModeChanged",Fd="activeModeChanged",Ed="focused",Dd="name",Cd="placeholder",Bd="FORM",Ad="BLOCKQUOTE",zd="&quot;",yd="height",xd="width",wd="/",vd="font",ud="strong",td="FONT",sd="TBODY",rd="LEGEND",qd="FIELDSET",pd="DL",od="\n",nd="false",md="HTML",ld="'></span>",kd="></span>",jd="<span id=",id="_middle_add",hd="700",gd="background-color",fd="sub",ed="vertical-align",dd="line-through",cd="text-decoration",bd="font-style",ad="font-weight",Zc="subscript",Yc="superscript",Xc="strikethrough",Wc="OL",Vc="UL",Uc="string",Tc="formatblock",Sc="remain",Rc="justifyright",Qc="justifycenter",Pc="justifyfull",Oc="justifyleft",Nc="textarea",Mc="visibility",Lc="display",Kc="'/>",Jc="<span id='",Ic="StartToEnd",Hc="EndToStart",Gc="_left",Fc="_right",Ec=">",Dc="&amp;",Cc="paste",Bc="para",Ac="SPAN",zc="!!!<span></span>",yc="character",xc="&gt;",wc="&lt;",vc="inline",uc="BR",tc="SCRIPT",sc="LI",rc="<br/>",qc="'); background-position: center; background-repeat: no-repeat; background-color: #c0c0c0;",pc="application/x-mplayer2",oc="type",nc="border: 1px dotted #000000; background-image: url('",mc='$1 wmode="transparent"$2',lc="$1pseudomode=$3$4",kc="<",jc="align",ic="0",hc="src",gc="style",fc="wmode",ec="bgcolor",dc="pseudomode",cc="dummybgcolor",bc="dummysrc",ac="embed",Zb="dummytag",Yb="ig",Xb="(<[/]?)(teo",Wb="$1<br/>$3",Vb="$1&nbsp;$3",Ub="EditorDocument",ob='" media="all" /><link rel="stylesheet" href="',Tb="dblclick",Sb="keypress",nb="draggesture",mb="dragstart",Rb="P",lb='" media="all" /></head><body>',kb='<html><head><link rel="stylesheet" href="',jb="&",ib="javascript:false;",hb="blur",gb="focus",fb="_deactivate",eb="_activate",db="BackCompat",Qb="mouseup",cb="mouseout",bb="mouseover",Pb=" ",ab="DIV",Ob="TD",Z="TR",Nb="TABLE",Y="</body></html>",X="px",W="0px",T="Sys.Extended.UI.HTMLEditor.Popups",Mb="underline",S="superScript",R="subScript",Q="strikeThrough",Lb="EndToEnd",Kb="BODY",P="size",O="face",N="color",M="class",L="H",V="_right_",U="_left_",J="Ctrl-V",F="Apple-V",E=-1,D="mac",z="rtl",G="right",K="left",Jb="italic",Ib="&nbsp;",y="title",C='"',A="href",I="_self",Hb="span",B="IMG",Gb="EMBED",x="target",Fb="A",w="$1",Eb="div",t="font-size",s="fontsize",r=",",q="font-family",p="fontname",Db="forecolor",Cb="x",o="checkState",Bb="bold",b="setColor",Ab="backcolor",zb="keydown",yb="mousedown",xb="function",wb="control",vb="text",n="set_activeEditPanel",m="callMethod",l="visible",k="click",c="_onmousedown",j="_active",i="_mousedown",h="_hover",d="dispose",e="on",g="IFRAME",ub="TEXTAREA",f="INPUT",H="initialize",v="hidden",u="none",tb="undefined",sb=true,rb="",pb=null,qb=false,a="Sys.Extended.UI.HTMLEditor.ToolbarButton";Type.registerNamespace("Sys.Extended.UI.HTMLEditor");Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton.initializeBase(a,[b]);a._loaded=qb;a._editPanel=pb;a._activeModes=pb;a._app_onload$delegate=Function.createDelegate(a,a._app_onload);a._cssClass=rb;a._onmouseover$delegate=Function.createDelegate(a,a._onmouseover);a._onmouseout$delegate=Function.createDelegate(a,a._onmouseout);a._onmousedown$delegate=Function.createDelegate(a,a._onmousedown);a._onmouseup$delegate=Function.createDelegate(a,a._onmouseup);a._onclick$delegate=Function.createDelegate(a,a._onclick)};Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton.prototype={set_activeEditPanel:function(b){var a=this;a._editPanel=b;if(a._editPanel==pb)a.hideButton();else if(a.isAllowedActiveMode(a._editPanel.get_activeMode())&&a.canBeShown()){a.showButton();a.onEditPanelActivity()}else a.hideButton()},isImage:function(){return sb},checkRangeInDesign:function(){var a=this;if(typeof a._designPanel==tb)return qb;if(a._designPanel==pb)return qb;if(a._designPanel.isPopup())return qb;var b=Sys.Extended.UI.HTMLEditor.getSelParent(a._designPanel);if(b.nodeType==3)b=b.parentNode;return b.ownerDocument==a._designPanel._doc},get_buttonName:function(){var a=Object.getType(this).getName();a=a.substring(a.lastIndexOf(".")+1);return a},get_message:function(messageName){var expression="Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_"+this.get_buttonName()+"_message_"+messageName;return eval(expression)},isDisplayed:function(){var a=this.get_element();if(a){var b=a.style;return b.display!=u&&b.visibility!=v}else return qb},hideButton:function(){var a=this.get_element();if(a)a.style.display=u},showButton:function(){if(this.get_element().style.display==u)this.get_element().style.display=rb},canBeShown:function(){return sb},onEditPanelActivity:function(){},get_activeModes:function(){if(this._activeModes==pb)this._activeModes=[];return this._activeModes},set_activeModes:function(a){this.get_activeModes().push(a)},get_activeModesIds:function(){},set_activeModesIds:function(c){for(var b=c.split(";"),a=0;a<b.length;a++)this.set_activeModes(parseInt(b[a]))},set_toolTip:function(a){this.get_element().title=a},get_toolTip:function(){return this.get_element().title},isAllowedActiveMode:function(b){for(var a=0;a<this.get_activeModes().length;a++)if(this.get_activeModes()[a]==b)return sb;return qb},initialize:function(){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton.callBaseMethod(a,H);Sys.Application.add_load(a._app_onload$delegate);var b=a.get_element();a._cssClass=b.className;a.isImage()&&$addHandlers(b,{mouseover:a._onmouseover$delegate,mouseout:a._onmouseout$delegate,mousedown:a._onmousedown$delegate,mouseup:a._onmouseup$delegate,click:a._onclick$delegate});if(Sys.Extended.UI.HTMLEditor.isIE){function c(a){if(a.nodeType==1&&a.tagName){var b=a.tagName.toUpperCase();if(b!=f&&b!=ub&&b!=g)a.unselectable=e;for(var d=0;d<a.childNodes.length;d++)c(a.childNodes.item(d))}}c(b)}else try{b.style.MozUserSelect=u;b.parentNode.style.MozUserSelect=u}catch(d){}},dispose:function(){var a=this;a.isImage()&&$common.removeHandlers(a.get_element(),{mouseover:a._onmouseover$delegate,mouseout:a._onmouseout$delegate,mousedown:a._onmousedown$delegate,mouseup:a._onmouseup$delegate,click:a._onclick$delegate});a._loaded=qb;Sys.Application.remove_load(a._app_onload$delegate);Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton.callBaseMethod(a,d)},_app_onload:function(){this.onButtonLoaded();this._loaded=sb},onButtonLoaded:function(){},_onmouseover:function(){if(!this.isEnable())return qb;Sys.UI.DomElement.addCssClass(this.get_element(),this._cssClass+h);return sb},_onmouseout:function(){var a=this;if(!a.isEnable())return qb;Sys.UI.DomElement.removeCssClass(a.get_element(),a._cssClass+h);Sys.UI.DomElement.removeCssClass(a.get_element(),a._cssClass+i);return sb},_onmousedown:function(){if(!this.isEnable())return pb;Sys.UI.DomElement.addCssClass(this.get_element(),this._cssClass+i);return qb},_onmouseup:function(){if(!this.isEnable())return qb;Sys.UI.DomElement.removeCssClass(this.get_element(),this._cssClass+i);return sb},_onclick:function(){if(!this.isEnable())return qb;return sb},isEnable:function(){if(!this._loaded)return qb;if(this._editPanel==pb)return qb;return sb},setActivity:function(b){var a=this;if(b)Sys.UI.DomElement.addCssClass(a.get_element(),a._cssClass+j);else Sys.UI.DomElement.removeCssClass(a.get_element(),a._cssClass+j)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton",Sys.UI.Control);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.initializeBase(a,[b]);a._normalSrc=rb;a._hoverSrc=rb;a._downSrc=rb;a._activeSrc=rb;a._downTimer=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.prototype={get_normalSrc:function(){return this._normalSrc},set_normalSrc:function(b){this._normalSrc=b;var a=this.get_element();if(/none$/.test(a.src))a.src=b},get_hoverSrc:function(){return this._hoverSrc},set_hoverSrc:function(a){this._hoverSrc=a},get_downSrc:function(){return this._downSrc},set_downSrc:function(a){this._downSrc=a},get_activeSrc:function(){return this._activeSrc},set_activeSrc:function(a){this._activeSrc=a},isImage:function(){return sb},_onmouseover:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.callBaseMethod(a,"_onmouseover"))return qb;if(a._hoverSrc.length>0)a.get_element().src=a._hoverSrc;return sb},_onmouseout:function(){var a=this,b=a.get_element();if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.callBaseMethod(a,"_onmouseout"))return qb;if(a._hoverSrc.length>0)if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+i)&&a._downSrc.length>0)b.src=a._downSrc;else if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+j)&&a._activeSrc.length>0)b.src=a._activeSrc;else b.src=a._normalSrc;return sb},_onmousedown:function(){var a=this;if(Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.callBaseMethod(a,c)===pb)return pb;if(a._downSrc.length>0){a.get_element().src=a._downSrc;a._downTimer=setTimeout(Function.createDelegate(a,a._onmouseup),1e3)}return sb},_onmouseup:function(){var a=this,b=a.get_element();if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.callBaseMethod(a,"_onmouseup"))return qb;if(a._downSrc.length>0){if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+h)&&a._hoverSrc.length>0)b.src=a._hoverSrc;else if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+j)&&a._activeSrc.length>0)b.src=a._activeSrc;else b.src=a._normalSrc;if(a._downTimer!=pb){clearTimeout(a._downTimer);a._downTimer=pb}}return sb},setActivity:function(c){var a=this,b=a.get_element();if(a._activeSrc.length>0)if(c){if(!Sys.UI.DomElement.containsCssClass(b,a._cssClass+j))b.src=a._activeSrc}else if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+j))if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+i)&&a._downSrc.length>0)b.src=a._downSrc;else if(Sys.UI.DomElement.containsCssClass(b,a._cssClass+h)&&a._hoverSrc.length>0)b.src=a._hoverSrc;else b.src=a._normalSrc;Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.callBaseMethod(a,"setActivity",[c])}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton.prototype={initialize:function(){Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton.callBaseMethod(this,H)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton.initializeBase(a,[b]);a._onclick_option$delegate=Function.createDelegate(a,a._onclick_option);a._onchange$delegate=Function.createDelegate(a,a._onchange)};Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton.prototype={initialize:function(){var a=this,c=a.get_element().id;Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton.callBaseMethod(a,H);a._select=$get(c+"_select");$addHandler(a._select,"change",a._onchange$delegate);for(var b=0;b<a._select.options.length;b++){var d=a._select.options[b];$addHandler(d,k,a._onclick_option$delegate)}},dispose:function(){var a=this;for(var b=0;b<a._select.options.length;b++){var c=a._select.options[b];$removeHandler(c,k,a._onclick_option$delegate)}$removeHandler(a._select,"change",a._onchange$delegate);Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton.callBaseMethod(a,d)},isImage:function(){return qb},callMethod:function(){return sb},_onclick_option:function(b){if(!this.isEnable())return qb;var a=b.target;a.parentNode.value=a.value;Sys.Extended.UI.HTMLEditor._stopEvent(b);if(!Sys.Extended.UI.HTMLEditor.isSafari)return qb;this.callMethod(a.parentNode,b);return sb},_onchange:function(a){if(!this.isEnable())return qb;var b=a.target;Sys.Extended.UI.HTMLEditor._stopEvent(a);this.callMethod(b,a);return sb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.CommonButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton.initializeBase(this,[a]);this._designPanel=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton.prototype={_onmousedown:function(b){var a=this;if(a._designPanel==pb)return qb;if(a._designPanel.isPopup())return qb;if(Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton.callBaseMethod(a,c,[b])===pb)return qb;a.callMethod();return qb},onEditPanelActivity:function(){this._designPanel=this._editPanel.get_activePanel()},callMethod:function(){if(this._designPanel==pb)return qb;if(this._designPanel.isPopup())return qb;return sb},initialize:function(){var b=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton.callBaseMethod(b,H);if(Sys.Extended.UI.HTMLEditor.isOpera){var a=b.get_element();function d(a){a.style.display=rb;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes.item(b);c.nodeType==1&&d(c)}}function c(a,b){if(a.style.visibility!=b)a.style.visibility=b;for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d);e.nodeType==1&&c(e,b)}}if(b.canBeShown()){d(a);a.style.visibility=v}b.hideButton=function(){c(a,v)};b.showButton=function(){if(a.style.display==u)a.style.display=rb;c(a,l)}}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.BoxButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton.initializeBase(this,[a]);this._designPanel=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton.prototype={_onmousedown:function(b){var a=this;if(a._designPanel==pb)return qb;if(a._designPanel.isPopup())return qb;if(Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton.callBaseMethod(a,c,[b])===pb)return qb;a.callMethod();return qb},onEditPanelActivity:function(){this._designPanel=this._editPanel.get_activePanel()},callMethod:function(){if(this._designPanel==pb)return qb;if(this._designPanel.isPopup())return qb;return sb},initialize:function(){var b=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton.callBaseMethod(b,H);if(Sys.Extended.UI.HTMLEditor.isOpera){var a=b.get_element();function d(a){a.style.display=rb}function c(a){if(a.style.visibility==v)a.style.visibility=l}if(b.canBeShown()){d(a);a.style.visibility=v}b.hideButton=function(){a.style.visibility=v};b.showButton=function(){if(a.style.display==u)a.style.display=rb;c(a)}}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton.initializeBase(this,[a]);this._designPanel=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton.prototype={onEditPanelActivity:function(){this._designPanel=this._editPanel.get_activePanel();this.checkState()},checkState:function(){if(!this.checkRangeInDesign())return qb;return sb},initialize:function(){var b=this,a=b.get_element();Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton.callBaseMethod(b,H);if(Sys.Extended.UI.HTMLEditor.isOpera){if(b.canBeShown()){a.style.display=rb;a.style.visibility=v}b.hideButton=function(){a.style.visibility=v};b.showButton=function(){if(a.style.display==u)a.style.display=rb;a.style.visibility=l}}},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton.callBaseMethod(this,m))return qb;if(this._designPanel==pb)return qb;if(this._designPanel.isPopup())return qb;return sb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.SelectButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton.prototype={};Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton.prototype={onEditPanelActivity:function(){Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton.callBaseMethod(this,"onEditPanelActivity");this.setActivity(this.checkState())},checkState:function(){if(!this.checkRangeInDesign())return qb;return sb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton.initializeBase(this,[a]);this._activeMode=Sys.Extended.UI.HTMLEditor.ActiveModeType.Design};Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton.prototype={get_activeMode:function(){return this._activeMode},set_activeMode:function(a){this._activeMode=a},_onclick:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton.callBaseMethod(this,"_onclick"))return qb;var a=this;setTimeout(function(){a._editPanel.set_activeMode(a._activeMode)},0);return sb},onEditPanelActivity:function(){this.setActivity(this._editPanel.get_activeMode()==this._activeMode)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.ImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.initializeBase(a,[b]);a._relatedPopup=pb;a._autoClose=sb;a._forclose_onmousedown$delegate=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.prototype={set_activeEditPanel:function(b){var a=this;a._editPanel!=b&&a._editPanel!=pb&&a.closePopup();Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.callBaseMethod(a,n,[b])},get_autoClose:function(){return this._autoClose},set_autoClose:function(a){this._autoClose=a},get_relatedPopup:function(){return this._relatedPopup},set_relatedPopup:function(a){this._relatedPopup=a},openPopup:function(g,i,h){var a=this;if(a._autoClose&&a._forclose_onmousedown$delegate!=pb)return;if(a._relatedPopup!=pb){a._bookmark=pb;if(Sys.Extended.UI.HTMLEditor.isIE){var d=a._designPanel._getSelection();a._selType=d.type.toLowerCase();var c=a._designPanel._createRange(d);if(a._selType==vb||a._selType==u)try{a._bookmark=c.duplicate()}catch(j){}else if(a._selType==wb){a._bookmark=c.item(0);c.remove(0);d.empty()}}if(typeof a._relatedPopup.set_relatedElement==xb){a._relatedPopup.set_relatedElement(a.get_element());a._forclose_onmousedown$delegate=Function.createDelegate(a,a._forclose_onmousedown);if(a._autoClose){var e=a._designPanel.get_element().contentWindow,f=e.document.body,b=a;setTimeout(function(){if(b._forclose_onmousedown$delegate!=pb){Sys.Extended.UI.HTMLEditor._addEvent(f,yb,b._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._addEvent(f,zb,b._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._addEvent(document.body,zb,b._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._addEvent(e,yb,b._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._addEvent(document.body,yb,b._forclose_onmousedown$delegate);document.documentElement&&Sys.Extended.UI.HTMLEditor._addEvent(document.documentElement,yb,b._forclose_onmousedown$delegate)}},0)}a._relatedPopup.open(g)}else a._relatedPopup.open(g,i,h)}},_forclose_onmousedown:function(){var a=this;if(a._forclose_onmousedown$delegate==pb)return sb;if(a._relatedPopup.isOpened)a._relatedPopup.close();else return;if(a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)try{if(a._bookmark){if(Sys.Extended.UI.HTMLEditor.isIE){var b;if(a._selType==wb){b=a._designPanel._doc.body.createControlRange();b.add(a._bookmark)}else b=a._bookmark;b.select()}a._bookmark=pb}if(!Sys.Extended.UI.HTMLEditor.isIE){var c=a._designPanel._getSelection(),b=a._designPanel._createRange(c);a._designPanel._removeAllRanges(c);a._designPanel._selectRange(c,b);a._designPanel.focusEditor()}}catch(h){}var f=a;setTimeout(function(){if(f._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)try{f._editPanel.updateToolbar()}catch(a){}},0);if(a._autoClose)try{var d=a._designPanel.get_element().contentWindow,e=d.document.body;document.documentElement&&Sys.Extended.UI.HTMLEditor._removeEvent(document.documentElement,yb,a._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(e,zb,a._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(document.body,zb,a._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(e,yb,a._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(d,yb,a._forclose_onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(document.body,yb,a._forclose_onmousedown$delegate)}catch(h){}a._forclose_onmousedown$delegate=pb},closePopup:function(){this._forclose_onmousedown$delegate!=pb&&this._forclose_onmousedown$delegate(pb)},dispose:function(){this._forclose_onmousedown$delegate!=pb&&this._forclose_onmousedown$delegate(pb);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.callBaseMethod(this,d)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector.prototype={};Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector.initializeBase(this,[a]);this._fixedColorButton=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector.prototype={get_fixedColorButton:function(){return this._fixedColorButton},set_fixedColorButton:function(a){this._fixedColorButton=a},callMethod:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector.callBaseMethod(a,m))return qb;a.openPopup(Function.createDelegate(a,a._onopened));return sb},_onopened:function(a){a.setColor=Function.createDelegate(this,this.setColor)},setColor:function(a){this.closePopup();this._fixedColorButton!=pb&&this._fixedColorButton.set_defaultColor(a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector",Sys.Extended.UI.HTMLEditor.ToolbarButton.Selector);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton.initializeBase(a,[b]);a._defaultColor="#000000";a._colorDiv=pb;a._methodButton=pb};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton.prototype={get_defaultColor:function(){return this._defaultColor},set_defaultColor:function(a){this._defaultColor=a;if(this._colorDiv!=pb)this._colorDiv.get_element().style.backgroundColor=a},get_colorDiv:function(){return this._colorDiv},set_colorDiv:function(a){this._colorDiv=a},get_methodButton:function(){return this._methodButton},set_methodButton:function(a){this._methodButton=a},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton.callBaseMethod(this,m))return qb;this.setColor(this.get_defaultColor())},setColor:function(){},initialize:function(){var a=this;Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton.callBaseMethod(a,H);if(a._methodButton!=pb)a._methodButton.callMethod=Function.createDelegate(a,a.callMethod);if(a._colorDiv!=pb)a._colorDiv.callMethod=Function.createDelegate(a,a.callMethod)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton.prototype={set_activeEditPanel:function(c){var a=this;if(a._editPanel!=c&&a._editPanel!=pb){var b=a.get_relatedPopup();if(typeof b._forceImClose==xb){var d=b._forceImClose;d(b._iframe.contentWindow)}}Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton.callBaseMethod(a,n,[c])},callMethod:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton.callBaseMethod(a,m))return qb;a.openPopup(Function.createDelegate(a,a._onopened));return sb},_onopened:function(b){var a=this;b.popupMediator.set_callMethodByName("OK",Function.createDelegate(a,a._onOK));b.popupMediator.set_callMethodByName("Cancel",Function.createDelegate(a,a._onCancel));var c=a.get_relatedPopup();c._popup=a._designPanel._popup;c._forceImClose=Function.createDelegate(a,a._onCancel);a._designPanel._popup=a.get_relatedPopup();a.opened(b)},opened:function(){},_onOK:function(b){var a=this;a.okCheck(b)&&a._exit(Function.createDelegate(a,a.ok),b)},_onCancel:function(b){var a=this;a.cancelCheck(b)&&a._exit(Function.createDelegate(a,a.cancel),b)},_exit:function(c,b){var a=this;a.closePopup();a._designPanel._popup=a.get_relatedPopup()._popup;a.get_relatedPopup()._popup=pb;a.get_relatedPopup()._forceImClose=pb;c(b)},ok:function(){},cancel:function(){},okCheck:function(){return sb},cancelCheck:function(){return sb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Ab,qb,rb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector.callBaseMethod(this,m))return qb},setColor:function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector.callBaseMethod(this,b,[a]);this._designPanel._execCommand(Ab,qb,a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector",Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Bb,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(Bb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList.callBaseMethod(this,m))return qb;this._designPanel._execCommand("InsertUnorderedList")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton.prototype={callMethod:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton.callBaseMethod(a,m))return qb;a.openPopup(Function.createDelegate(a,a._onopened));return sb},_onopened:function(a){a.setColor=Function.createDelegate(this,this.setColor)},setColor:function(){this.closePopup()}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModePopupImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy.prototype={canBeShown:function(){return Sys.Extended.UI.HTMLEditor.isIE},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy.callBaseMethod(this,m))return qb;var a=this._designPanel;if(Sys.Extended.UI.HTMLEditor.isIE){a.openWait();setTimeout(function(){a.isShadowed();a._copyCut("c",sb);a.closeWait();a._ifShadow()},0)}else a._copyCut("c",sb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut.callBaseMethod(this,m))return qb;var a=this._designPanel;if(Sys.Extended.UI.HTMLEditor.isIE){a.openWait();setTimeout(function(){a.isShadowed();a._copyCut(Cb,sb);a.closeWait()},0)}else a._copyCut(Cb,sb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent.callBaseMethod(this,m))return qb;this._designPanel._execCommand("Outdent")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode.prototype={};Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode",Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor.prototype={setColor:function(a){this._designPanel._execCommand(Ab,qb,a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor",Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor.prototype={setColor:function(a){this._designPanel._execCommand(Db,qb,a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor",Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedColorButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.prototype={initialize:function(){Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.callBaseMethod(this,H)},callMethod:function(a){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.callBaseMethod(this,m))return qb;try{var b=this._designPanel;b._execCommand(p,qb,a.options.item(a.selectedIndex).value)}catch(d){}},checkState:function(){var e=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.callBaseMethod(e,o))return qb;var f=e._designPanel,a=pb;try{a=Function.createDelegate(f,Sys.Extended.UI.HTMLEditor._queryCommandValue)(p)}catch(i){}if(!f._FontNotSet)if(!a||a.length==0)a=Sys.Extended.UI.HTMLEditor.getStyle(f._doc.body,q);var c=e._select,b=0;if(a&&a.length>0){var g=a.toLowerCase().split(r)[0].replace(/^(['"])/,rb).replace(/(['"])$/,rb);for(b=0;b<c.options.length;b++){var h=c.options.item(b).value.toLowerCase().split(r)[0];if(h==g)break}if(b==c.options.length)try{var d=document.createElement("OPTION");d.value=a.replace(/^(['"])/,rb).replace(/(['"])$/,rb);d.text=a.split(r)[0].replace(/^(['"])/,rb).replace(/(['"])$/,rb);c.add(d,Sys.Extended.UI.HTMLEditor.isIE?b:pb);$addHandler(d,k,e._onclick_option$delegate)}catch(i){b=0}}c.selectedIndex=b}};Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.prototype={initialize:function(){Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.callBaseMethod(this,H)},callMethod:function(a){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.callBaseMethod(this,m))return qb;try{var b=this._designPanel;b._execCommand("FontSize",qb,Sys.Extended.UI.HTMLEditor.fontSizeSeek(a.options.item(a.selectedIndex).value))}catch(d){}},checkState:function(){var c=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.callBaseMethod(c,o))return qb;var f=c._designPanel,a=pb,g=c._select.id;try{a=Function.createDelegate(f,Sys.Extended.UI.HTMLEditor._queryCommandValue)(s,g)}catch(j){}if(a)a=a.toString();if(!f._FontNotSet)if(!a||a.length==0){a=Sys.Extended.UI.HTMLEditor.getStyle(f._doc.body,t);a=Sys.Extended.UI.HTMLEditor._TryTransformFromPxToPt(a,c,g)}try{var d=c._select,b=0;if(a&&a.length>0){var h=a.toLowerCase().split(r)[0];for(b=0;b<d.options.length;b++){var i=Sys.Extended.UI.HTMLEditor.fontSizeSeek(d.options.item(b).value.toLowerCase().split(r)[0]);if(i==h)break}if(b==d.options.length)try{var e=document.createElement("OPTION");e.value=a;e.text=a;d.add(e,Sys.Extended.UI.HTMLEditor.isIE?b:pb);$addHandler(e,k,c._onclick_option$delegate)}catch(j){b=0}}d.selectedIndex=b}catch(j){}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeSelectButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor.callBaseMethod(this,m))return qb},setColor:function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor.callBaseMethod(this,b,[a]);this._designPanel._execCommand(Db,qb,a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColor",Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Db,qb,rb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector.callBaseMethod(this,m))return qb},setColor:function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector.callBaseMethod(this,b,[a]);this._designPanel._execCommand(Db,qb,a)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector",Sys.Extended.UI.HTMLEditor.ToolbarButton.ColorSelector);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator.prototype={isImage:function(){return qb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator",Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeImageButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode.prototype={};Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode",Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent.callBaseMethod(this,m))return qb;this._designPanel._execCommand("Indent")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR.callBaseMethod(this,m))return qb;var a=this._designPanel;try{a._saveContent();var e=a._doc.createElement(Eb);e.innerHTML="<hr>";var b=e.firstChild,c=a._getSafePlace();if(!c)return;var d=c.parentNode;d.insertBefore(b,c);d.removeChild(c);b=b.nextSibling?b.nextSibling:b;Sys.Extended.UI.HTMLEditor._setCursor(b,a);setTimeout(function(){a.onContentChanged();a._editPanel.updateToolbar()},0);a.focusEditor();return sb}catch(f){}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink.initializeBase(this,[a]);this._emptySrc=window.location.href.replace(/(http[s]*\:\/\/)[^\u0000]*/i,w)};Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink.prototype={callMethod:function(){var b=this,c=b._designPanel,d=c._getSelection(),e=c._createRange(d),a=Sys.Extended.UI.HTMLEditor.getSelParent(c);if(a.nodeType==3)a=a.parentNode;while(a&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb)a=a.parentNode;if(a&&a.tagName.toUpperCase()==Fb){b._edit=sb;b._editLink(a)}else{b._edit=qb;b._createLink()}if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink.callBaseMethod(b,m))return qb;return sb},opened:function(a){this._preparePopup(a)},ok:function(c){var a=this,b=c.popupMediator.getField(x);if(b!=pb)a._obj.target=b.value;var d=c.popupMediator.getField("url");if(d!=pb)a._obj.href=d.value;if(/^javascript:/.test(a._obj.href)){a._obj.target=pb;try{a._obj.removeAttribute(x)}catch(e){}}else{var b=c.popupMediator.getField(x);if(b!=pb)a._obj.target=b.value}if(a._edit)a._edit_callback(sb);else a._create_callback(sb)},cancel:function(){if(this._edit)this._edit_callback(qb);else this._create_callback(qb)},_createLink:function(){var b=this,a=b._designPanel,j=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb,g=a._getSelection(),c=a._createRange(g);b._txt=pb;if(!(a.isControl()&&Sys.Extended.UI.HTMLEditor.getSelParent(a).tagName&&(Sys.Extended.UI.HTMLEditor.getSelParent(a).tagName.toUpperCase()==Gb||Sys.Extended.UI.HTMLEditor.getSelParent(a).tagName.toUpperCase()==B))&&!(!a.isControl()&&(Sys.Extended.UI.HTMLEditor.isIE&&c.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&j.length>0))){a._saveContent();var i=a._doc.createElement(Hb);i.innerHTML="new link";i.id=Sys.Extended.UI.HTMLEditor.smartClassName;var l=sb;if(Sys.Extended.UI.HTMLEditor.isIE&&a.isControl()){var d=c.item(0),m=a._doc.createElement(Hb);d.parentNode.insertBefore(m,d);b._txt=i.firstChild;d.parentNode.insertBefore(b._txt,d);var n=a._doc.createElement(Hb);d.parentNode.insertBefore(n,d);d.parentNode.removeChild(d);a.setSelectionAfterOperation([m,n],qb);l=qb}else{a.insertHTML(Sys.Extended.UI.HTMLEditor.getHTML(i,sb));var f=a._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName);b._txt=f.firstChild;f.parentNode.insertBefore(f.firstChild,f);f.parentNode.removeChild(f)}if(!Sys.Extended.UI.HTMLEditor.isIE){c=a._createRange();c.setStart(b._txt,0);c.setEnd(b._txt,(rb+b._txt.data+rb).length);a._removeAllRanges(g);a._selectRange(g,c)}else l&&c.select();j=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb;g=a._getSelection();c=a._createRange(g)}if(a.isControl()&&Sys.Extended.UI.HTMLEditor.getSelParent(a).tagName.toUpperCase()==B||!a.isControl()&&(Sys.Extended.UI.HTMLEditor.isIE&&c.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&j.length>0)){a._saveContent();b._obj={target:"default",href:b._emptySrc,title:rb};for(var k=a._doc.getElementsByTagName(Fb),h=[],e=0;e<k.length;e++)h.push([k[e],rb+k[e].href+rb]);a._execCommand("createLink",qb,b._emptySrc);b._oldList=[];for(var e=0;e<h.length;e++){var o=h[e][0],p=h[e][1];o.href==p&&b._oldList.push(o)}}},_editLink:function(b){var a=this._designPanel;this._obj=b;a._saveContent()},_preparePopup:function(c){var a=this;if(a._obj.target&&a._obj.target.length>0&&a._obj.target=="default")a._obj.target=a.get_relatedPopup().get_defaultTarget();var d=c.popupMediator.getField(x);if(d!=pb)d.value=a._obj.target&&a._obj.target.length>0&&a._obj.target.substr(0,1)=="_"?a._obj.target.toLowerCase():I;var b=c.popupMediator.getField("url");if(b!=pb){if(a._edit)b.value=Sys.Extended.UI.HTMLEditor.getRealAttribute(a._obj,A);else b.value=a._obj.href;if(b.value.length==0)b.value=a._emptySrc;b.value=b.value.replace(/\&quot;/g,C);setTimeout(function(){Sys.Extended.UI.HTMLEditor.setSelectionRange(b,0,b.value.length)},0)}},_edit_callback:function(c){var a=this,b=a._designPanel;try{if(!c)b._undo(qb);else{if(a._obj.title.length==0){a._obj.title=pb;a._obj.removeAttribute(y)}b.onContentChanged()}}catch(d){}return sb},okCheck:function(b){var c=b.popupMediator.getField("url");if(c!=pb){var a=c.value;if(a==rb||a.length>=3&&a.substr(a.length-3,3)=="://"){b.alert(this.get_message("EmptyURL"));b.setTimeout(function(){try{c.focus()}catch(a){}},0);return qb}return sb}return qb},_create_callback:function(k){var a=this,b=a._designPanel;try{if(k){for(var e=b._doc.getElementsByTagName(Fb),i=0,g=0;g<e.length;g++){for(var j=sb,f=e[g],h=0;h<a._oldList.length;h++)if(f==a._oldList[h]){j=qb;break}if(!j)continue;i=g;if(a._obj.target)f.target=a._obj.target;f.href=a._obj.href;if(a._obj.title.length>0)f.title=a._obj.title}if(a._txt)a._txt.data=a._obj.href;if(e.length>0){var d=e[i],c=b._doc.createElement(Hb);c.innerHTML=Ib;if(d.nextSibling!=pb)d.parentNode.insertBefore(c,d.nextSibling);else d.parentNode.appendChild(c);setTimeout(function(){Sys.Extended.UI.HTMLEditor._setCursor(c,b);setTimeout(function(){d.parentNode.removeChild(c)},0)},0)}setTimeout(function(){b._editPanel.updateToolbar();b.onContentChanged()},0)}else{b._undo(qb);b.__stack.pop();if(a._txt){b._undo(qb);b.__stack.pop()}}b.focusEditor()}catch(l){}return sb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink",Sys.Extended.UI.HTMLEditor.ToolbarButton.OkCancelPopupButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Jb,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(Jb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState("center")},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter.callBaseMethod(this,m))return qb;this._designPanel._execCommand("JustifyCenter")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState("justify")},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull.callBaseMethod(this,m))return qb;this._designPanel._execCommand("JustifyFull")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState(K)},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft.callBaseMethod(this,m))return qb;this._designPanel._execCommand("JustifyLeft")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState(G)},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight.callBaseMethod(this,m))return qb;this._designPanel._execCommand("JustifyRight")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr.prototype={callMethod:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr.callBaseMethod(a,m))return qb;a._designPanel._doc.body.style.direction=!a.checkState()?rb:z;if(!Sys.Extended.UI.HTMLEditor.isIE){var b=a._designPanel._getSelection(),d=a._designPanel._createRange(b);a._designPanel._removeAllRanges(b);a._designPanel._selectRange(b,d);a._designPanel.focusEditor()}var c=a;setTimeout(function(){c._editPanel.updateToolbar()},0)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr.callBaseMethod(this,o))return qb;if(!(this._designPanel._doc.body.style.direction&&this._designPanel._doc.body.style.direction==z))return sb;return qb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList.callBaseMethod(this,m))return qb;this._designPanel._execCommand("InsertOrderedList")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState(rb)},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph.callBaseMethod(this,m))return qb;this._designPanel._execCommand("Paragraph")}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste.prototype={canBeShown:function(){return Sys.Extended.UI.HTMLEditor.isIE},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste.callBaseMethod(this,m))return qb;var a=this._designPanel;if(Sys.Extended.UI.HTMLEditor.isIE){a._saveContent();a.openWait();setTimeout(function(){a._paste(sb);a.closeWait()},0)}else{var b=a._getSelection(),c=a._createRange(b);a._removeAllRanges(b);alert(String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_Use_verb,Sys.Extended.UI.HTMLEditor.isSafari&&navigator.userAgent.indexOf(D)!=E?F:J));a._selectRange(b,c);a.isWord=qb;a.isPlainText=qb}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText.callBaseMethod(this,m))return qb;var a=this._designPanel;if(Sys.Extended.UI.HTMLEditor.isIE){a._saveContent();a.openWait();setTimeout(function(){a._paste(qb);a.closeWait()},0)}else{var b=a._getSelection(),d=a._createRange(b),c=String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_Use_verb,Sys.Extended.UI.HTMLEditor.isSafari&&navigator.userAgent.indexOf(D)!=E?F:J),e=String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_OnPastePlainText,c);alert(e);setTimeout(function(){a._removeAllRanges(b);a._selectRange(b,d)},0);a.isPlainText=sb}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord.callBaseMethod(this,m))return qb;var a=this._designPanel;if(Sys.Extended.UI.HTMLEditor.isIE){a._saveContent();a.openWait();setTimeout(function(){a._paste(sb,sb);a.closeWait()},0)}else{var b=a._getSelection(),d=a._createRange(b),c=String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_Use_verb,Sys.Extended.UI.HTMLEditor.isSafari&&navigator.userAgent.indexOf(D)!=E?F:J),e=String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_OnPasteFromMSWord,c);alert(e);setTimeout(function(){a._removeAllRanges(b);a._selectRange(b,d)},0);a.isWord=sb}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode.prototype={};Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode",Sys.Extended.UI.HTMLEditor.ToolbarButton.ModeButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo.callBaseMethod(this,m))return qb;this._designPanel.redo()}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment.prototype={checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment.callBaseMethod(this,o))return qb;return this._designPanel._textAlignState(pb)},callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment.callBaseMethod(this,m))return qb;var a=this._designPanel,b=this._editPanel;a._saveContent();a.MSIE_justify(K,sb);a.onContentChanged();setTimeout(function(){b.updateToolbar()},0)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink.callBaseMethod(this,m))return qb;var b=this._designPanel,d=b._getSelection(),e=b._createRange(d),a=Sys.Extended.UI.HTMLEditor.getSelParent(b);if(a.nodeType==3)a=a.parentNode;while(a&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb)a=a.parentNode;if(a&&a.tagName.toUpperCase()==Fb){b._saveContent();var c=a.firstChild;while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);c&&Sys.Extended.UI.HTMLEditor._setCursor(c,b);setTimeout(function(){b._editPanel.updateToolbar()},0);b.onContentChanged()}}};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.callBaseMethod(this,m))return qb;var a=this._designPanel;setTimeout(function(){var D=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb,k=a._getSelection(),i=a._createRange(k),c=pb,y=qb;if(!a.isControl()&&(Sys.Extended.UI.HTMLEditor.isIE&&i.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&D.length>0))c=a._getTextNodeCollection();else{c=a._tryExpand();y=sb}if(c!=pb&&c.length>0){var z=qb,r=sb,G=pb;a._saveContent();var g=a._doc.createElement(Hb);g.id=U;var f=a._doc.createElement(Hb);f.id=V;var E=c[0].parentNode,C=c[c.length-1].parentNode;E.insertBefore(g,c[0]);if(c[c.length-1].nextSibling)C.insertBefore(f,c[c.length-1].nextSibling);else C.appendChild(f);while(r){r=qb;for(var h=0;h<c.length;h++){var d=c[h].parentNode;if(d)if(c[h].previousSibling==pb&&c[h].nextSibling==pb){var o=d.tagName.toUpperCase();if(Sys.Extended.UI.HTMLEditor.isStyleTag(o)&&o!=Fb&&(d.className!=Sys.Extended.UI.HTMLEditor.smartClassName||o.substr(0,1)==L)){var s=Sys.Extended.UI.HTMLEditor.differAttr(d,[M,N,O,P]);z=sb;if(s.length==0){var m=d.parentNode,l=d.firstChild?d.firstChild:pb,u=pb;if(o.toUpperCase().substr(0,1)==L&&Sys.Extended.UI.HTMLEditor.isIE){u=a._doc.createElement("p");u.className=Sys.Extended.UI.HTMLEditor.smartClassName;m.insertBefore(u,d);while(d.firstChild)u.appendChild(d.firstChild)}else{while(d.firstChild)m.insertBefore(d.firstChild,d);if(o.toUpperCase().substr(0,1)==L){var F=a._doc.createElement("br");m.insertBefore(F,d)}}m.removeChild(d);r=sb}else{for(var m=d.parentNode,x=a._doc.createElement(o),t=0;t<s.length;t++)x.setAttribute(s[t][0],s[t][1]);m.insertBefore(x,d);while(d.firstChild)x.appendChild(d.firstChild);m.removeChild(d)}}}}}for(var h=0;h<c.length;h++){var l=c[h],e=c[h].parentNode!=pb&&typeof c[h].parentNode!=tb?c[h].parentNode:pb;if(e){var j=pb;while(e&&e.tagName&&e.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(e.tagName)&&e.tagName.toUpperCase()!=Fb&&Sys.Extended.UI.HTMLEditor.differAttr(e,[M,N,O,P]).length==0){j=e;e=e.parentNode}if(j){z=sb;function w(c,b,d,e){var a=d.cloneNode(qb);if(c)if(c.push&&typeof c.push==xb)for(var g=0;g<c.length;g++)a.appendChild(c[g]);else a.appendChild(c);while(b){var l=e?b.previousSibling:b.nextSibling;if(b.nodeType==1||b.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+b.data+rb).length>0){if(b.nodeType==1){Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)&&b.tagName.toUpperCase()!=Fb&&(!b.id||b.id!=U&&b.id!=V)&&Sys.Extended.UI.HTMLEditor.spanJoiner(b);if(Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)&&b.childNodes.length==0&&(!b.id||b.id!=U&&b.id!=V))b=pb}if(b)if(a.childNodes.length==0||!e)a.appendChild(b);else a.insertBefore(b,a.firstChild)}b=l}if(a.childNodes.length==0){delete a;a=pb}else if(a.childNodes.length==1&&a.firstChild.nodeType==3&&(rb+a.firstChild.data+rb).length==0){delete a;a=pb}else if(Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)){for(var i=a.childNodes.length,f=0;f<a.childNodes.length;f++){var h=a.childNodes.item(f);if(h.nodeType==1&&!Sys.Extended.UI.HTMLEditor.isStyleTag(h.tagName))i--}if(i==0){var k=[];while(a.firstChild){var h=a.removeChild(a.firstChild);k.push(h)}a=k}}if(d==j)return a;else return w(a,e?d.previousSibling:d.nextSibling,d.parentNode,e)}e=l.parentNode;if(l.previousSibling==pb&&l.nextSibling==pb&&e&&e.tagName&&e.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(e.tagName)&&Sys.Extended.UI.HTMLEditor.differAttr(e,[M,N,O,P]).length>0)l=e;var p=w(pb,l.previousSibling,l.parentNode,sb),q=w(pb,l.nextSibling,l.parentNode,qb),d=j.parentNode;if(p){if(p.push&&typeof p.push==xb)for(var n=0;n<p.length;n++)d.insertBefore(p[n],j);else d.insertBefore(p,j);if(Sys.Extended.UI.HTMLEditor.isIE){g=a._doc.getElementById(U);f=a._doc.getElementById(V)}}d.insertBefore(l,j);if(q){if(q.push&&typeof q.push==xb)for(var n=0;n<q.length;n++)d.insertBefore(q[n],j);else d.insertBefore(q,j);if(Sys.Extended.UI.HTMLEditor.isIE){g=a._doc.getElementById(U);f=a._doc.getElementById(V)}}d.removeChild(j)}}}if(y){if(Sys.Extended.UI.HTMLEditor.isIE&&a.__saveBM__!=pb){try{var b=g.parentNode;b.removeChild(g);while(b&&b.childNodes.length==0){b.parentNode.removeChild(b);b=b.parentNode}b=f.parentNode;b.removeChild(f);while(b&&b.childNodes.length==0){b.parentNode.removeChild(b);b=b.parentNode}g=pb;f=pb}catch(H){}var k=a._getSelection(),i=a._createRange(k);i.moveToBookmark(a.__saveBM__);i.select();a.__saveBM__=pb}else if(a.__saveBM__!=pb){if(a.__saveBM__[0].nodeType==3){var k=a._getSelection(),i=a._doc.createRange();i.setStart(a.__saveBM__[0],a.__saveBM__[1]);i.setEnd(a.__saveBM__[0],a.__saveBM__[1]);a._removeAllRanges(k);a._selectRange(k,i)}else{a._trySelect(a.__saveBM__[0],a.__saveBM__[0]);a.__saveBM__[0].parentNode.removeChild(a.__saveBM__[0])}a.__saveBM__=pb}}else if(!Sys.Extended.UI.HTMLEditor.isIE){c=[];var r=qb;function B(a,b){while(a){if(a==f){r=sb;return}if(a.nodeType==3){while(a.nextSibling&&a.nextSibling.nodeType==3){a.data=rb+a.data+rb+a.nextSibling.data+rb;a.parentNode.removeChild(a.nextSibling)}Sys.Extended.UI.HTMLEditor.Trim(rb+a.data+rb).length>0&&c.push(a)}else B(a.firstChild,qb);if(r)return;var d=a.parentNode;if(b)while(a&&a.nextSibling==pb)a=a.parentNode;a=a.nextSibling}}B(g,sb);i=a._doc.createRange();i.setStart(c[0],0);i.setEnd(c[c.length-1],(rb+c[c.length-1].data+rb).length);a._removeAllRanges(k);a._selectRange(k,i)}else try{k=a._getSelection();var v=a._createRange(k),A=a._createRange(k);v.moveToElementText(g);A.moveToElementText(f);v.setEndPoint(Lb,A);v.select()}catch(H){}try{var b;if(g!=pb){b=g.parentNode;b.removeChild(g);while(b&&b.childNodes.length==0){b.parentNode.removeChild(b);b=b.parentNode}}if(f!=pb){b=f.parentNode;b.removeChild(f);while(b&&b.childNodes.length==0){b.parentNode.removeChild(b);b=b.parentNode}}}catch(H){}a.onContentChanged();a._editPanel.updateToolbar()}},0)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl.prototype={callMethod:function(){var a=this;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl.callBaseMethod(a,m))return qb;a._designPanel._doc.body.style.direction=!a.checkState()?z:rb;if(!Sys.Extended.UI.HTMLEditor.isIE){var b=a._designPanel._getSelection(),d=a._designPanel._createRange(b);a._designPanel._removeAllRanges(b);a._designPanel._selectRange(b,d);a._designPanel.focusEditor()}var c=a;setTimeout(function(){c._editPanel.updateToolbar()},0)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl.callBaseMethod(this,o))return qb;if(this._designPanel._doc.body.style.direction&&this._designPanel._doc.body.style.direction==z)return sb;return qb}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Q,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(Q)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript.callBaseMethod(this,m))return qb;this._designPanel._execCommand(R,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(R)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript.callBaseMethod(this,m))return qb;this._designPanel._execCommand(S,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(S)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline.callBaseMethod(this,m))return qb;this._designPanel._execCommand(Mb,qb,pb)},checkState:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline.callBaseMethod(this,o))return qb;return this._designPanel._queryCommandState(Mb)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline",Sys.Extended.UI.HTMLEditor.ToolbarButton.ToggleButton);Type.registerNamespace(a);Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo.callBaseMethod(this,m))return qb;this._designPanel.undo()}};Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.Popup=function(b){var a=this;Sys.Extended.UI.HTMLEditor.Popups.Popup.initializeBase(a,[b]);a._iframe=pb;a._top=0;a._left=0;a._doc=pb;a._initialContent=rb;a._cssPath=rb;a._autoDimensions=sb;a._registeredFields=[];a._registeredHandlers=[];a._app_onload$delegate=Function.createDelegate(a,a._app_onload);a.isOpened=qb;a.isLoaded=qb;a.isLoading=qb};Sys.Extended.UI.HTMLEditor.Popups.Popup.prototype={getDocument:function(){return this._doc},getPopupMediator:function(){if(this._iframe.contentWindow&&this._iframe.contentWindow.popupMediator)return this._iframe.contentWindow.popupMediator;else return pb},get_registeredFields:function(){return this._registeredFields},set_registeredFields:function(value){this._registeredFields=eval(value)},get_registeredHandlers:function(){return this._registeredHandlers},set_registeredHandlers:function(value){this._registeredHandlers=eval(value)},get_initialContent:function(){return this._initialContent},set_initialContent:function(a){this._initialContent=a},get_cssPath:function(){return this._cssPath},set_cssPath:function(a){this._cssPath=a},get_autoDimensions:function(){return this._autoDimensions},set_autoDimensions:function(a){this._autoDimensions=a},get_iframe:function(){return this._iframe},set_iframe:function(a){this._iframe=a},checkCorrectLoaded:function(c){var a=this,b=a;if(b.isLoaded&&(b._iframe.style.height==W||b._iframe.style.width==W))a.isLoaded=qb;if(!a.isLoaded){!a.isLoading&&a.reload();typeof c!=tb&&setTimeout(c,10);return qb}return sb},_baseOpen:function(b,e,d){var a=this,c=a;if(!a.checkCorrectLoaded(function(){c._baseOpen(b,e,d)}))return;var f=a.get_element();if(typeof d!=tb)a._left=parseInt(d);if(typeof e!=tb)a._top=parseInt(e);f.style.top=a._top+X;f.style.left=a._left+X;setTimeout(function(){typeof b==xb&&c._onDocumentLoaded(b);c.isOpened=sb},0)},open:function(a,c,b){this._baseOpen(a,c,b)},close:function(a){var b=this.get_element();this.isOpened=qb;b.style.top="-2000px";b.style.left="-2000px";typeof a==xb&&a()},reload:function(){var a=this;a.isLoading=sb;var c=a.get_element(),d=c.parentNode;document.body.appendChild(c);d.appendChild(a.get_element());a._doc=a._iframe.contentWindow.document;a._doc.open();var b=new Sys.StringBuilder;b.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html><head>');a._cssPath.length>0&&b.append('<link rel="stylesheet" href="'+a._cssPath+'" media="all" />');b.append("<script>var __loaded__ = false;</sc"+"ript></head><body style='margin:0px; padding:0px; border-width:0px;' onload='__loaded__ = true;'>");a._autoDimensions&&b.append("<table cellspacing='0' cellpadding='0' border='0'><tr><td>");b.append(a._initialContent);a._autoDimensions&&b.append("</td></tr></table>");b.append(Y);a._doc.write(b.toString());a._doc.close();a.isLoaded=qb;a._afterReload()},_afterReload:function(){var c=this,b=c._iframe.contentWindow,a=c;c.isLoaded=b.__loaded__;if(!(a._doc.body&&a._doc.body.innerHTML))c.isLoaded=qb;if(!c.isLoaded){setTimeout(function(){a._afterReload()},10);return}c.isLoaded=qb;b.popupMediator={};b.popupMediator.registeredFields=c._registeredFields;b.popupMediator.registeredHandlers=c._registeredHandlers;b.popupMediator.get_callMethodByName=function(e){for(var c=b.popupMediator.registeredHandlers,a=0;a<c.length;a++){var d=c[a];if(d.name==e)return d.callMethod}return pb};b.popupMediator.set_callMethodByName=function(f,e){for(var c=b.popupMediator.registeredHandlers,a=0;a<c.length;a++){var d=c[a];if(d.name==f)d.callMethod=e}};b.popupMediator.getField=function(e){for(var c=b.popupMediator.registeredFields,a=0;a<c.length;a++){var d=c[a];if(d.name==e)return b.document.getElementById(d.clientID)}return pb};b.Sys=Sys;for(var d=0;d<c._registeredHandlers.length;d++)$find(c._registeredHandlers[d].clientID).activate(b.document.getElementById(c._registeredHandlers[d].clientID));if(Sys.Extended.UI.HTMLEditor.isIE)a._doc.onselectstart=function(){var c=a._iframe.contentWindow.event,b=c.srcElement.tagName.toUpperCase();if(b==f||b==ub)return sb;return qb};else{a._doc.onmousedown=function(b){var a=b.target.tagName.toUpperCase();if(a==f||a==ub||a=="SELECT")return sb;if(Sys.Extended.UI.HTMLEditor.isSafari)if(a==Nb||a==Z||a==Ob||a==ab)return sb;return qb};for(var e=a._doc.getElementsByTagName("input"),d=0;d<e.length;d++)e[d].setAttribute("autocomplete","off")}if(c._autoDimensions){a._iframe.style.height="1000px";a._iframe.style.width="1000px";setTimeout(function(){a._iframe.style.height=a._doc.body.firstChild.offsetHeight+X;a._iframe.style.width=a._doc.body.firstChild.offsetWidth+X;a.isLoaded=sb;a.isLoading=qb},0)}else{a.isLoaded=sb;a.isLoading=qb}},_onDocumentLoaded:function(b){var a=this,c=a;if(!a.isLoaded){setTimeout(function(){c._onDocumentLoaded(b)},10);return}a.isLoaded=sb;b(a._iframe.contentWindow)},initialize:function(){this.__appLoaded__=qb;Sys.Extended.UI.HTMLEditor.Popups.Popup.callBaseMethod(this,H);Sys.Application.add_load(this._app_onload$delegate)},dispose:function(){var a=this;Sys.Application.remove_load(a._app_onload$delegate);a.isOpened&&a.close();Sys.Extended.UI.HTMLEditor.Popups.Popup.callBaseMethod(a,d)},_app_onload:function(){var a=this;if(a.__appLoaded__)return;a.__appLoaded__=sb;var b=a.get_element();if(Sys.Extended.UI.HTMLEditor.isReallyVisible(b)){a._parentNode_=b.parentNode;a.reload()}}};Sys.Extended.UI.HTMLEditor.Popups.Popup.registerClass("Sys.Extended.UI.HTMLEditor.Popups.Popup",Sys.UI.Control);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup=function(a){Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.initializeBase(this,[a]);this._relatedElement=pb};Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.prototype={get_relatedElement:function(){return this._relatedElement},set_relatedElement:function(a){this._relatedElement=a},open:function(g){var a=this;if(a._relatedElement!=pb){var i=a;if(!a.checkCorrectLoaded(function(){i.open(g)}))return;var h=$common.getLocation(a._relatedElement),c=h.x,d=h.y+a._relatedElement.offsetHeight,b=Sys.Extended.UI.HTMLEditor.getClientViewportElement(a._iframe),f=b.clientWidth+b.scrollLeft,e=b.clientHeight+b.scrollTop;if(d<b.scrollTop)d=b.scrollTop;if(c<b.scrollLeft)c=b.scrollLeft;if(d+a._iframe.offsetHeight>e)d-=d+a._iframe.offsetHeight-e;if(c+a._iframe.offsetWidth>f)c-=c+a._iframe.offsetWidth-f;Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.callBaseMethod(a,"open",[g,d,c])}},close:function(a){Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.callBaseMethod(this,"close",[a])},initialize:function(){Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.callBaseMethod(this,H)},dispose:function(){Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.callBaseMethod(this,d)}};Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup.registerClass("Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup",Sys.Extended.UI.HTMLEditor.Popups.Popup);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup=function(a){Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup.initializeBase(this,[a]);this._contentDiv=pb};Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup.prototype={get_contentDiv:function(){return this._contentDiv},set_contentDiv:function(a){this._contentDiv=a},initialize:function(){Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup.callBaseMethod(this,H);this.set_initialContent(this._contentDiv.innerHTML)},dispose:function(){Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup.callBaseMethod(this,d)}};Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup.registerClass("Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup",Sys.Extended.UI.HTMLEditor.Popups.AttachedPopup);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup=function(a){Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup.prototype={initialize:function(){Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup.callBaseMethod(this,H)},dispose:function(){Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup.callBaseMethod(this,d)}};Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup.registerClass("Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup",Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton=function(b){var a=this;Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton.initializeBase(a,[b]);a._loaded=qb;a._activated=pb;a._app_onload$delegate=Function.createDelegate(a,a._app_onload);a._cssClass=rb;a._name=rb;a._onmouseover$delegate=Function.createDelegate(a,a._onmouseover);a._onmouseout$delegate=Function.createDelegate(a,a._onmouseout);a._onmousedown$delegate=Function.createDelegate(a,a._onmousedown);a._onmouseup$delegate=Function.createDelegate(a,a._onmouseup);a._onclick$delegate=Function.createDelegate(a,a._onclick)};Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton.prototype={isImage:function(){return sb},set_toolTip:function(a){this.get_element().title=a},get_toolTip:function(){return this.get_element().title},set_name:function(a){this._name=a},get_name:function(){return this._name},initialize:function(){var a=this,b=a.get_element();Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton.callBaseMethod(a,H);Sys.Application.add_load(a._app_onload$delegate);a._cssClass=b.className.split(Pb)[0];a.isImage()&&$addHandlers(b,{mouseover:a._onmouseover$delegate,mouseout:a._onmouseout$delegate,mousedown:a._onmousedown$delegate,mouseup:a._onmouseup$delegate,click:a._onclick$delegate});if(Sys.Extended.UI.HTMLEditor.isIE){function c(a){if(a.nodeType==1&&a.tagName){var b=a.tagName.toUpperCase();if(b!=f&&b!=ub&&b!=g)a.unselectable=e;for(var d=0;d<a.childNodes.length;d++)c(a.childNodes.item(d))}}c(b)}else try{b.style.MozUserSelect=u;b.parentNode.style.MozUserSelect=u}catch(d){}},activate:function(b){var a=this;a._activated=b;if(a.isImage()){Sys.Extended.UI.HTMLEditor._addEvent(a._activated,bb,a._onmouseover$delegate);Sys.Extended.UI.HTMLEditor._addEvent(a._activated,cb,a._onmouseout$delegate);Sys.Extended.UI.HTMLEditor._addEvent(a._activated,yb,a._onmousedown$delegate);Sys.Extended.UI.HTMLEditor._addEvent(a._activated,Qb,a._onmouseup$delegate);Sys.Extended.UI.HTMLEditor._addEvent(a._activated,k,a._onclick$delegate)}},dispose:function(){var a=this;if(a.isImage()&&a._activated!=pb){Sys.Extended.UI.HTMLEditor._removeEvent(a._activated,bb,a._onmouseover$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(a._activated,cb,a._onmouseout$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(a._activated,yb,a._onmousedown$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(a._activated,Qb,a._onmouseup$delegate);Sys.Extended.UI.HTMLEditor._removeEvent(a._activated,k,a._onclick$delegate)}a._activated=pb;a._loaded=qb;Sys.Application.remove_load(a._app_onload$delegate);Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton.callBaseMethod(a,d)},_app_onload:function(){if(this._loaded)return;this.onButtonLoaded();this._loaded=sb},onButtonLoaded:function(){},_onmouseover:function(){if(!this.isEnable())return qb;Sys.UI.DomElement.addCssClass(this._activated,this._cssClass+h);return sb},_onmouseout:function(c){var b=this;if(!b.isEnable())return qb;var a=c.toElement||c.relatedTarget;try{while(a&&typeof a!=tb)if(a==b._activated)break;else a=a.parentNode}catch(d){a=pb}if(a!=pb)return sb;Sys.UI.DomElement.removeCssClass(b._activated,b._cssClass+h);Sys.UI.DomElement.removeCssClass(b._activated,b._cssClass+i);return sb},_onmousedown:function(){if(!this.isEnable())return pb;Sys.UI.DomElement.addCssClass(this._activated,this._cssClass+i);return qb},_onmouseup:function(){if(!this.isEnable())return qb;Sys.UI.DomElement.removeCssClass(this._activated,this._cssClass+i);return sb},_onclick:function(a){if(!this.isEnable())return qb;this.callMethod(a);return sb},callMethod:function(){var a=this,c=a._activated.ownerDocument||a._activated.document||target,b=c.defaultView||c.parentWindow,d=b.popupMediator.get_callMethodByName(a._name);Function.createDelegate(a,d)(b)},isEnable:function(){if(!this._loaded)return qb;return sb}};Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton.registerClass("Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton",Sys.UI.Control);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton=function(a){Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton.initializeBase(this,[a]);this._designPanel=pb};Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton.prototype={};Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton.registerClass("Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton",Sys.Extended.UI.HTMLEditor.Popups.PopupCommonButton);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton=function(a){Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton.prototype={};Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton.registerClass("Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton",Sys.Extended.UI.HTMLEditor.Popups.PopupBoxButton);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup=function(a){Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup.prototype={};Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup.registerClass("Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup",Sys.Extended.UI.HTMLEditor.Popups.AttachedTemplatePopup);Type.registerNamespace(T);Sys.Extended.UI.HTMLEditor.Popups.LinkProperties=function(b){var a=this;Sys.Extended.UI.HTMLEditor.Popups.LinkProperties.initializeBase(a,[b]);a._defaultTarget=I;a._targetTextHolder=pb;a._urlTextHolder=pb};Sys.Extended.UI.HTMLEditor.Popups.LinkProperties.prototype={get_defaultTarget:function(){return this._defaultTarget},set_defaultTarget:function(a){this._defaultTarget=a}};Sys.Extended.UI.HTMLEditor.Popups.LinkProperties.registerClass("Sys.Extended.UI.HTMLEditor.Popups.LinkProperties",Sys.Extended.UI.HTMLEditor.Popups.OkCancelAttachedTemplatePopup);Sys.Extended.UI.HTMLEditor.ModePanel=function(b){var a=this;Sys.Extended.UI.HTMLEditor.ModePanel.initializeBase(a,[b]);a._activated=qb;a._isActivating=qb;a._editPanel=pb;a._cachedContent=pb;a._onbeforeunload$delegate=Function.createDelegate(a,a._onbeforeunload)};Sys.Extended.UI.HTMLEditor.ModePanel.prototype={set_editPanel:function(a){this._editPanel=a},get_content:function(){var a=this;if(a._activated)return a._getContent();else if(a._cachedContent!=pb)return a._cachedContent;else return rb},set_content:function(b){var a=this;a._cachedContent=b;if(!a._activated&&!a._isActivating)a._activate(b);else if(!a._isActivating)a._setContent(b);else{var c=a;setTimeout(function(){c.set_content(b)},10);return qb}return sb},_activate:function(){this.get_element().style.display=rb;this._isActivating=sb},_activateFinished:function(){var a=this;a._activated=sb;a._isActivating=qb;a._editPanel._setActive();a._editPanel.get_autofocus()&&a._focus()},_deactivate:function(){this.get_element().style.display=u;this._activated=qb;this._isActivating=qb},initialize:function(){Sys.Extended.UI.HTMLEditor.ModePanel.callBaseMethod(this,H);Sys.Extended.UI.HTMLEditor.isIE&&$addHandlers(window,{beforeunload:this._onbeforeunload$delegate})},dispose:function(){var a=this;Sys.Extended.UI.HTMLEditor.isIE&&$common.removeHandlers(window,{beforeunload:a._onbeforeunload$delegate});if(a._activated&&!Sys.Extended.UI.HTMLEditor.isIE){a._onbeforeunload();a._deactivate()}Sys.Extended.UI.HTMLEditor.ModePanel.callBaseMethod(a,d)},_onbeforeunload:function(){var a=this;if(a._activated)if(!a._editPanel._contentPrepared){a._editPanel._prepareContentForPostback(a.get_content());a._editPanel._contentPrepared=sb}},_getContent:function(){if(this._cachedContent!=pb)return this._cachedContent;else return rb},_setContent:function(){},_focus:function(){this._focused()},_focused:function(a){this._editPanel._focused(a);this._editPanel.set_autofocus(sb)},_really_focused:function(){this._editPanel._really_focused();this._editPanel.set_autofocus(sb)}};Sys.Extended.UI.HTMLEditor.ModePanel.registerClass("Sys.Extended.UI.HTMLEditor.ModePanel",Sys.UI.Control);Sys.Extended.UI.HTMLEditor.HtmlPanel=function(b){var a=this;Sys.Extended.UI.HTMLEditor.HtmlPanel.initializeBase(a,[b]);a._onfocus$delegate=Function.createDelegate(a,a._onfocus);if(Sys.Extended.UI.HTMLEditor.isIE&&document.compatMode!=db)a._onresize$delegate=Function.createDelegate(a,a._onresize)};Sys.Extended.UI.HTMLEditor.HtmlPanel.prototype={_activate:function(c){var a=this;a._shouldResize=qb;var b=a.get_element();if(Sys.Extended.UI.HTMLEditor.isIE&&Sys.Browser.version>6&&document.compatMode!=db&&b.parentNode.clientHeight>0)a._shouldResize=sb;Sys.Extended.UI.HTMLEditor.HtmlPanel.callBaseMethod(a,eb);if(Sys.Extended.UI.HTMLEditor.isIE){b.value=rb;var d=a;setTimeout(function(){b.value=c},0)}else b.value=c;$addHandlers(b,{focus:a._onfocus$delegate});a._shouldResize&&$addHandlers(b,{resize:a._onresize$delegate});a._activateFinished()},_deactivate:function(){var a=this,b=a.get_element();a._shouldResize&&$common.removeHandlers(b,{resize:a._onresize$delegate});a._shouldResize=qb;$common.removeHandlers(b,{focus:a._onfocus$delegate});b.value=rb;Sys.Extended.UI.HTMLEditor.HtmlPanel.callBaseMethod(a,fb)},_getContent:function(){return this.get_element().value},_setContent:function(b){this.get_element().value=b;try{var a=this.get_element();a.focus();setTimeout(function(){Sys.Extended.UI.HTMLEditor.setSelectionRange(a,0,0)},0)}catch(c){}},_focus:function(){try{var a=this.get_element();a.focus();setTimeout(function(){Sys.Extended.UI.HTMLEditor.setSelectionRange(a,0,0)},0)}catch(c){}var b=this;setTimeout(function(){b._focused()},0)},_onfocus:function(){this._really_focused();var a=this.get_element();setTimeout(function(){a.focus()},0);return sb},_onresize:function(){var b=this.get_element(),a=b.parentNode.clientHeight;if(a>0)b.style.height=a+X}};Sys.Extended.UI.HTMLEditor.HtmlPanel.registerClass("Sys.Extended.UI.HTMLEditor.HtmlPanel",Sys.Extended.UI.HTMLEditor.ModePanel);Sys.Extended.UI.HTMLEditor.PreviewPanel=function(b){var a=this;Sys.Extended.UI.HTMLEditor.PreviewPanel.initializeBase(a,[b]);a._focus$delegate=Function.createDelegate(a,a._focus_event);a._blur$delegate=Function.createDelegate(a,a._blur_event);a._doc=pb;a._content=rb;a._panel_timer=pb};Sys.Extended.UI.HTMLEditor.PreviewPanel.prototype={_focus:function(){try{this.get_element().contentWindow.focus()}catch(a){}this._focused()},_focus_event:function(){var a=this;if(a._panel_timer==pb){var c=a.get_element().contentWindow,b=a;a._really_focused();a._panel_timer=setTimeout(function(){c.focus();b._really_focused();b._panel_timer=pb},0)}return sb},_blur_event:function(){if(this._panel_timer!=pb){clearTimeout(this._panel_timer);this._panel_timer=pb}return sb},_activate:function(b){var a=this;Sys.Extended.UI.HTMLEditor.PreviewPanel.callBaseMethod(a,eb);a._content=b;a._wasFocused=qb;a._initIframe(b);Sys.Extended.UI.HTMLEditor._addEvents(a.get_element().contentWindow,[gb],a._focus$delegate);Sys.Extended.UI.HTMLEditor._addEvents(a.get_element().contentWindow,[hb],a._blur$delegate);a._activateFinished()},_deactivate:function(){var a=this;Sys.Extended.UI.HTMLEditor._removeEvents(a.get_element().contentWindow,[hb],a._blur$delegate);Sys.Extended.UI.HTMLEditor._removeEvents(a.get_element().contentWindow,[gb],a._focus$delegate);if(Sys.Extended.UI.HTMLEditor.isIE)try{a._doc.open();a._doc.write(rb);a._doc.close();a.get_element().src=ib}catch(b){}a._doc=pb;a._content=rb;Sys.Extended.UI.HTMLEditor.PreviewPanel.callBaseMethod(a,fb)},_initIframe:function(c){var a=this,b=Sys.Extended.UI.HTMLEditor.Trim(c);a._doc=a.get_element().contentWindow.document;if(Sys.Extended.UI.HTMLEditor.isIE)b=b.replace(/&amp;/ig,jb);a._doc.open();a._doc.write(kb+a._editPanel.get_documentCssPath()+lb+b+Y);a._doc.close()},_getContent:function(){return this._content},_setContent:function(a){this._content=a;this._initIframe(a)}};Sys.Extended.UI.HTMLEditor.PreviewPanel.registerClass("Sys.Extended.UI.HTMLEditor.PreviewPanel",Sys.Extended.UI.HTMLEditor.ModePanel);Sys.Extended.UI.HTMLEditor.DesignPanel=function(b){var a=this;Sys.Extended.UI.HTMLEditor.DesignPanel.initializeBase(a,[b]);a._doc=pb;a._updated_now=qb;a._updateTimer=pb;a._popup=pb;a._contextElement=pb;a._a_prize=qb;a.__stack=pb;a._StyleForTyping=pb;a.isWord=qb;a.isPlainText=qb;a.dfltBlockElement=Rb;a._FontNotSet=sb;a._design_timer1=pb;a._events$delegate=Function.createDelegate(a,Sys.Extended.UI.HTMLEditor.DesignPanelEventHandler);a._blur$delegate=Function.createDelegate(a,a._blur);a._focus$delegate=Function.createDelegate(a,a._focus_event)};Sys.Extended.UI.HTMLEditor.DesignPanel.prototype={initialize:function(){Sys.Extended.UI.HTMLEditor.DesignPanel.callBaseMethod(this,H)},dispose:function(){Sys.Extended.UI.HTMLEditor.DesignPanel.callBaseMethod(this,d)},_activate:function(b){var a=this;Sys.Extended.UI.HTMLEditor.DesignPanel.callBaseMethod(a,eb);a._wasFocused=qb;a._initIframe(b);a._onDocumentLoaded()},_deactivate:function(){var a=this;a._deactivateCommon();if(Sys.Extended.UI.HTMLEditor.isIE){a._doc.open();a._doc.write(rb);a._doc.close();a.get_element().src=ib}a._doc=pb;Sys.Extended.UI.HTMLEditor.DesignPanel.callBaseMethod(a,fb)},_deactivateCommon:function(){var a=this;a._editPanel.__blured=qb;for(var c=a._doc.body.getElementsByTagName(B),b=0;b<c.length;b++)if(c[b].getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute)&&c[b].getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute).length>0)try{if(Sys.Extended.UI.HTMLEditor.isIE)$removeHandler(c[b],mb,Sys.Extended.UI.HTMLEditor.stopDrag);else $removeHandler(c[b],nb,Sys.Extended.UI.HTMLEditor.stopDrag)}catch(d){}Sys.Extended.UI.HTMLEditor._removeEvents(a._doc,[zb,Sb,yb,Qb,Tb],a._events$delegate);Sys.Extended.UI.HTMLEditor._removeEvents(a.get_element().contentWindow,[hb],a._blur$delegate);Sys.Extended.UI.HTMLEditor._removeEvents(a.get_element().contentWindow,[gb],a._focus$delegate)},_initIframe:function(b){var a=this,c=Sys.Extended.UI.HTMLEditor.Trim(a._prepareContent(b));a._doc=a.get_element().contentWindow.document;if(!Sys.Extended.UI.HTMLEditor.isIE)a._doc.designMode=e;a._doc.open();a._doc.write(kb+a._editPanel.get_documentCssPath()+ob+a._editPanel.get_designPanelCssPath()+lb+c+Y);a._doc.close();a._doc.id=Ub;if(Sys.Extended.UI.HTMLEditor.isIE){a._doc.body.contentEditable=sb;a._tryForward=sb}},_blur:function(){var a=this;a._editPanel.__blured=sb;if(!Sys.Extended.UI.HTMLEditor.isIE&&a._design_timer1!=pb){clearTimeout(a._design_timer1);a._design_timer1=pb}return sb},_focus_event:function(){var a=this;a._editPanel.__blured=qb;if(Sys.Extended.UI.HTMLEditor.isIE)a._really_focused();else{var b=a;Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel=a._editPanel;if(a._design_timer1==pb)a._design_timer1=setTimeout(function(){b._really_focused();b._design_timer1=pb},0)}return sb},_onDocumentLoaded:function(){var a=this;try{!Sys.Extended.UI.HTMLEditor.isIE&&this._doc.queryCommandValue(Db);var b=a._doc.body.innerHTML}catch(c){setTimeout(function(){a._onDocumentLoaded()},10);return}this._afterBodyIsFormed();setTimeout(function(){a._activateFinished();Sys.Extended.UI.HTMLEditor.isIE&&!a._editPanel.get_autofocus()&&a._getSelection().empty()},0)},_afterBodyIsFormed:function(){var b=this,d=b;Sys.Extended.UI.HTMLEditor._addEvents(b._doc,[zb,Sb,yb,Qb,Tb],b._events$delegate);Sys.Extended.UI.HTMLEditor._addEvents(b.get_element().contentWindow,[hb],b._blur$delegate);Sys.Extended.UI.HTMLEditor._addEvents(b.get_element().contentWindow,[gb],b._focus$delegate);Sys.Extended.UI.HTMLEditor.inspectForShadows(d._doc.body);var a=b._doc.body;if(a.childNodes.length==1&&a.firstChild.tagName&&a.firstChild.tagName.toUpperCase()==ab&&a.firstChild.style.cssText.length>0&&a.firstChild.style.direction.length>0&&Sys.Extended.UI.HTMLEditor.getStyle(a.firstChild,"position")!="absolute"){a.style.cssText=a.firstChild.style.cssText;var c=a.firstChild;while(c.firstChild)a.insertBefore(c.firstChild,c);a.removeChild(c)}d._clearP()},_getContent:function(){var a="$1$3",c=this;if(c._popup!=pb)if(typeof c._popup._forceImClose==xb){var t=c._popup._forceImClose;t(c._popup._iframe.contentWindow)}c._clearP();var b;if(Sys.Extended.UI.HTMLEditor.isIE){Sys.Extended.UI.HTMLEditor.spanJoiner(c._doc.body,c._doc);b=Sys.Extended.UI.HTMLEditor.getHTML(c._doc.body,qb,sb);b=b.replace(/(<td[^>]*?>)([\s ]*?)(<\/td[^>]*?>)/ig,Vb).replace(/(<td[^>]*?>)\s*(&nbsp;)\s*(<\/td[^>]*?>)/ig,Wb).replace(/(<p[^>]*?>)\s*(&nbsp;)\s*(<\/p[^>]*?>)/ig,Wb);b=(c._doc.body.style.cssText.length>0?'<div style="'+c._doc.body.style.cssText.replace(C,"'")+'">':rb)+b+(c._doc.body.style.cssText.length>0?"</div>":rb);if(c._editPanel.get_noScript())b=b.replace(/(<script(?:[^>]*?)>(?:[^<]*?)<\/script(?:[^>]*?)>)/gi,rb);if(/<embed/ig.test(b))b=b.replace(/(<embed(?:.*?))(\sloop=\"true\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\splay=\"true\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\sbgcolor=\"\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\sscale=\"\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\shspace=\"0\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\svspace=\"0\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(\swmode=\"[^\"]+\")((?:.*?)>)/ig,a).replace(/(<embed(?:.*?))(pseudomode=)(\"[^\"]*\")((?:.*?)>)/ig,"$1wmode=$3$4").replace(/(<embed(?:.*?))(\swmode=\"\")((?:.*?)>)/ig,a);var s=new RegExp(Xb+Sys.Extended.UI.HTMLEditor.smartClassName+":)",Yb);b=b.replace(s,w)}else{var h=c._doc.createElement(ab),q=new Sys.Extended.UI.HTMLEditor.DesignPanel.ScriptRecover;h.style.cssText=c._doc.body.style.cssText;!c._editPanel.get_noScript()&&c._doc.body.innerHTML.replace(/<script(?:[^>]*?)>(.*?)<\/script(?:[^>]*?>)/gi,function(a,b){return q.regReplScript1(a,b)});h.innerHTML=Sys.Extended.UI.HTMLEditor.Trim(c._doc.body.innerHTML);for(var p=h.getElementsByTagName(B),l=[],i=0;i<p.length;i++)l.push(p[i]);for(var o=0;o<l.length;o++){var d=l[o],k;k=d.getAttribute(Zb);if(k&&k.length>0&&k.toLowerCase()==ac){var u=d.getAttribute(bc),j=d.getAttribute(cc),m=d.getAttribute(dc),r=d.attributes,f=c._doc.createElement(Gb);f.src=u;f.width=d.width;f.height=d.height;if(j&&j.length>0){j=Sys.Extended.UI.HTMLEditor.tryReplaceRgb(j);f.setAttribute(ec,j)}m&&m.length>0&&f.setAttribute(fc,m);for(var i=0;i<r.length;++i){var n=r.item(i);if(!n.specified)continue;var e=n.name.toLowerCase(),g=n.value;if(e==Zb||e==bc||e==cc||e==gc||e==fc||e==dc||e==hc)continue;if(e=="loop"&&g=="true")continue;if(e=="play"&&g=="true")continue;if(e=="hspace"&&g==ic)continue;if(e=="vspace"&&g==ic)continue;if(e=="scale"&&g.length==0)continue;if(e==jc&&g.length==0)continue;f.setAttribute(e,g)}if(d.style.width&&d.style.width.length>0)f.style.width=d.style.width;if(d.style.height&&d.style.height.length>0)f.style.height=d.style.height;d.parentNode.insertBefore(f,d);d.parentNode.removeChild(d)}}Sys.Extended.UI.HTMLEditor.spanJoiner(h,c._doc);b=Sys.Extended.UI.HTMLEditor.getHTML(h,h.style.cssText.length>0?sb:qb,sb);if(!c._editPanel.get_noScript())b=b.replace(/(<script(?:[^>]*?)>)(.*?)(<\/script(?:[^>]*?)>)/gi,function(a,b,c,d){return q.regReplFromScript1(a,b,c,d)});else b=b.replace(/(<script(?:[^>]*?)>(?:[^<]*?)<\/script(?:[^>]*?)>)/gi,rb);delete h}b=Sys.Extended.UI.HTMLEditor.brXHTML(b.replace(/^([\n|\r]+)/,rb));if(c._editPanel.get_noUnicode())b=b.replace(/([\u0080-\uFFFF])/g,function(b,a){return "&#"+a.charCodeAt(0).toString(10)+";"});if(Sys.Extended.UI.HTMLEditor.Trim(b)=="<br />")b=rb;return b},_setContent:function(b){var a=this;a._deactivateCommon();var c=Sys.Extended.UI.HTMLEditor.Trim(a._prepareContent(b));a._doc.open();a._doc.write(kb+a._editPanel.get_documentCssPath()+ob+a._editPanel.get_designPanelCssPath()+lb+c+Y);a._doc.close();if(Sys.Extended.UI.HTMLEditor.isIE){a._doc.body.contentEditable=sb;a._tryForward=sb}a._afterBodyIsFormed();a._editPanel.get_autofocus()&&a._focus();Sys.Extended.UI.HTMLEditor.isIE&&!a._editPanel.get_autofocus()&&a._getSelection().empty()},_focus:function(a){this.focusEditor();this._focused(a)},focusEditor:function(){var a=this;try{a.get_element().contentWindow.focus()}catch(b){}if(!a._wasFocused){a._wasFocused=sb;!a._editPanel.get_startEnd()&&a._setToEnd()}},_prepareContent:function(n){var g=this,a=n;a=a.replace(/<object(?:[^>]*?)>(?:[^\u0000]*?)(<embed(?:[^>]*?)>)(?:[^\u0000]*?)<\/object(?:[^>]*?)>/gi,w);if(Sys.Extended.UI.HTMLEditor.isIE){a=Sys.Extended.UI.HTMLEditor.Trim(a.replace(/([\n\r]+<)/g,kc).replace(/([^>])([\n\r]+)([^<])/g,"$1 $3")).replace(/(&amp;)/g,"&amp;amp;").replace(/<br\s*[\/]*>\s*<\/td>/ig,"</td>").replace(/(<td[^>]*?>)([\s ]*?)(<\/td[^>]*?>)/ig,Vb).replace(/(<p[^>]*?>)\s*(<br[^>]*?>)\s*(<\/p[^>]*?>)/ig,Vb);if(/<embed/ig.test(a))a=a.replace(/(<embed(?:.*?))(wmode=)(\"[^\"]*\")((?:.*?)>)/ig,lc).replace(/(<embed)([^>]*?>)/ig,mc);a=a.replace(/&amp;/ig,jb);return a}else{var i=new Sys.Extended.UI.HTMLEditor.DesignPanel.ScriptRecover,f=document.createElement(ab);!g._editPanel.get_noScript()&&a.replace(/<script(?:[^>]*?)>(.*?)<\/script(?:[^>]*?>)/gi,function(a,b){return i.regReplScript1(a,b)});f.innerHTML=Sys.Extended.UI.HTMLEditor.Trim(a.replace(/([^>])([\n\r]+)([^<])/g,"$1 $3"));for(var l=f.getElementsByTagName(Gb),h=[],e=0;e<l.length;e++)h.push(l[e]);for(var k=0;k<h.length;k++){var b=h[k],c=document.createElement(B),m=b.attributes;c.src=g._editPanel.get_imagePath_1x1();c.setAttribute(Zb,ac);for(var e=0;e<m.length;++e){var j=m.item(e);if(!j.specified)continue;var d=j.name.toLowerCase(),n=j.value;if(d==hc)d=bc;else if(d==ec)d=cc;else if(d==fc)d=dc;c.setAttribute(d,n)}c.style.cssText=nc+(c.getAttribute(oc).toLowerCase()==pc?g._editPanel.get_imagePath_media():tthis._editPanel.get_imagePath_flash())+qc;if(b.style.width&&b.style.width.length>0)c.style.width=b.style.width;if(b.style.height&&b.style.height.length>0)c.style.height=b.style.height;b.parentNode.insertBefore(c,b);b.parentNode.removeChild(b)}Sys.Extended.UI.HTMLEditor.spanJoiner(f,document);a=Sys.Extended.UI.HTMLEditor.Trim(Sys.Extended.UI.HTMLEditor.getHTML(f,qb,sb));if(!g._editPanel.get_noScript())a=a.replace(/(<script(?:[^>]*?)>)(.*?)(<\/script(?:[^>]*?)>)/gi,function(a,b,c,d){return i.regReplFromScript1(a,b,c,d)});delete f;delete i;a=Sys.Extended.UI.HTMLEditor.brXHTML(a);if(a.length==0)a=rc;return a}},_clearP:function(){try{var a=this._doc.body;if(a.firstChild)if(a.firstChild.nodeType==3){var c=Sys.Extended.UI.HTMLEditor.Trim(rb+a.firstChild.data+rb);if(c.length==0)a.removeChild(a.firstChild);else if(c!=rb+a.firstChild.data+rb)a.firstChild.data=c}if(Sys.Extended.UI.HTMLEditor.isIE)if(a.childNodes.length==1){a=a.firstChild;if(a.nodeType==1){var b=a.tagName.toLowerCase();if(b=="p"||b=="ul"||b=="ol"){var e=qb,f=b=="ul"||b=="ol";function d(a){var c=qb;if(a.nodeType==1){var b=a.tagName.toUpperCase();if(!(f&&b==sc))if(Sys.Extended.UI.HTMLEditor.isRestricted(a)||b==B||b==g||b==Gb||b==tc)return sb;if(a.childNodes.length>1)return sb;if(a.childNodes.length==0)return qb;c|=d(a.firstChild)}else if(a.nodeType==3)c|=sb;return c}if(a.childNodes.length==1)if(!d(a.firstChild)){a.removeChild(a.firstChild);e=sb}(e||a.parentNode.innerHTML.toLowerCase()=="<p>&nbsp;</p>")&&this._doc.body.removeChild(a)}}}}catch(g){}},isControl:function(){try{var c=this._getSelection();if(Sys.Extended.UI.HTMLEditor.isIE)if(c.type.toLowerCase()==wb)return sb;else return qb;else{var a=this._createRange(c),b=this._getParent(a);if(b.nodeType!=3&&a.startContainer==a.endContainer){if(!b.tagName)return qb;if(a.startContainer.childNodes.item(a.startOffset)==pb)return qb;if(a.startOffset==a.endOffset&&a.startContainer.childNodes.item(a.startOffset).tagName&&(a.startContainer.childNodes.item(a.startOffset).tagName.toUpperCase()==uc||Sys.Extended.UI.HTMLEditor.isStyleTag(a.startContainer.childNodes.item(a.startOffset).tagName)))return qb;if(b.tagName.toUpperCase()==Kb&&a.startOffset==0&&a.endOffset>0&&a.endOffset==b.childNodes.length)return qb;if(a.startOffset==a.endOffset&&a.startContainer.childNodes.item(a.startOffset).nodeType==3)return qb;return sb}else return qb}}catch(d){return sb}},isPopup:function(){return this._popup!=pb},_getSelection:function(){var a=this;if(Sys.Extended.UI.HTMLEditor.isIE){var b=a._doc.selection;return b}else{a.focusEditor();var b,c,d,e=a.get_element().contentWindow;b=e.getSelection();c=a._createRange(b);d=c.startContainer;try{while(d&&d.nodeType)d=d.parentNode}catch(f){a._removeAllRanges(b);c=a._createRange(b);c.setStart(a._saved_startContainer,a._saved_startOffset);c.setEnd(a._saved_startContainer,a._saved_startOffset);a._selectRange(b,c);b=e.getSelection()}return b}},_createRange:function(b){var a=this;if(Sys.Extended.UI.HTMLEditor.isIE)if(typeof b==tb)return a._doc.body.createTextRange();else return b.createRange();else{a.focusEditor();if(typeof b==tb)return a._doc.createRange();else try{var c=b.getRangeAt(0);return c}catch(d){return a._doc.createRange()}}},toEndOfProtected:function(){var c=this,f=this._getSelection(),b;try{b=this._createRange(f)}catch(g){return qb}var a;if(!Sys.Extended.UI.HTMLEditor.isIE){a=Sys.Extended.UI.HTMLEditor.contentEditable(b.startContainer);if(a==pb)a=Sys.Extended.UI.HTMLEditor.contentEditable(b.endContainer)}else a=Sys.Extended.UI.HTMLEditor.contentEditable(Sys.Extended.UI.HTMLEditor.getSelParent(c));if(Sys.Extended.UI.HTMLEditor.isIE&&a!=pb){try{b.remove(a)}catch(g){}b=c._doc.body.createControlRange();b.add(a);b.select()}else if(!Sys.Extended.UI.HTMLEditor.isIE&&a!=pb){var e=c._getSelection(),d;if(a.nextSibling!=pb&&a.nextSibling.nodeType==3)d=a.nextSibling;else{d=c._doc.createTextNode(rb);if(a.nextSibling!=pb)a.parentNode.insertBefore(d,a.nextSibling);else a.parentNode.appendChild(d)}c._removeAllRanges(e);var b=c._createRange(e);b.setStart(d,0);b.setEnd(d,0);c._selectRange(e,b)}return sb},_commonPaste:function(g){var c=this,a=c;c._saveContent();if(Sys.Extended.UI.HTMLEditor.isIE){c.openWait();setTimeout(function(){a._paste(!a._editPanel.get_noPaste());a.closeWait()},0);Sys.Extended.UI.HTMLEditor._stopEvent(g)}else if(!c.isPlainText&&!c.isWord&&!c._editPanel.get_noPaste())setTimeout(function(){Sys.Extended.UI.HTMLEditor.operateAnchors(a,a._doc,!a._editPanel.get_showAnchors());Sys.Extended.UI.HTMLEditor.operatePlaceHolders(a,a._doc,!a._editPanel.get_showPlaceHolders());Sys.Extended.UI.HTMLEditor.inspectForShadows(a._doc.body);a._checkImages(a._doc.body);a.onContentChanged()},0);else{var d=a._getSafePlace();if(d!=pb){var b=a._doc.createElement(Eb);b.style.display=vc;b.style.borderStyle=u;d.parentNode.insertBefore(b,d);b.appendChild(d);b.removeChild(d);b.innerHTML="xx";var f=a._getSelection(),e=a._createRange();a._removeAllRanges(f);e.setStart(b.firstChild,0);e.setEnd(b.firstChild,1);a._selectRange(f,e);a.openWait();setTimeout(function(){var h=b.parentNode;b.lastChild.deleteData(b.lastChild.length-1,1);if(a.isWord){b.innerHTML=Sys.Extended.UI.HTMLEditor.cleanUp(b.innerHTML);Sys.Extended.UI.HTMLEditor.replaceOldTags(b,a);Sys.Extended.UI.HTMLEditor.spanJoiner(b,a._doc)}else{var f=document.createElement(Eb);f.innerHTML=Sys.Extended.UI.HTMLEditor.cleanUp(b.innerHTML);b.innerHTML=f.innerText.replace(/</g,wc).replace(/>/g,xc).replace(/\r/g,rb).replace(/\n/g,rc).replace(/\t/g,Ib);delete f}while(b.firstChild)h.insertBefore(b.firstChild,b);var d=pb,c=pb;if(b.nextSibling&&b.nextSibling.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3){d=b.nextSibling;c=b.previousSibling}h.removeChild(b);var e=pb;if(d!=pb&&c!=pb){e=c.data.length;c.data=rb+c.data+rb+d.data+rb;d.parentNode.removeChild(d)}a.isWord=qb;a.isPlainText=qb;a.closeWait();if(e!=pb){var i=a._getSelection(),g=a._createRange();a._removeAllRanges(i);g.setStart(c,e);g.setEnd(c,e);a._selectRange(i,g)}a.onContentChanged()},0)}else Sys.Extended.UI.HTMLEditor._stopEvent(g)}},_selectRange:function(b,a){b.addRange(a);this.focusEditor()},_selectRng:function(a){var b=this,f=b._getSelection();if(!Sys.Extended.UI.HTMLEditor.isIE){var g=b._doc.createRange();g.setStart(a[0],0);g.setEnd(a[a.length-1],(rb+a[a.length-1].data+rb).length);b._removeAllRanges(f);b._selectRange(f,g)}else{var c=b._createRange(f),d=b._createRange(f),h=b._doc.createElement(Hb),e=b._doc.createElement(Hb);a[0].parentNode.insertBefore(h,a[0]);if(a[a.length-1].nextSibling)a[a.length-1].parentNode.insertBefore(e,a[a.length-1].nextSibling);else a[a.length-1].parentNode.appendChild(e);try{c.moveToElementText(h);var i=c.moveStart(yc,1);c.moveStart(yc,-i);d.moveToElementText(e);i=d.moveEnd(yc,E);d.moveEnd(yc,-i);c.setEndPoint(Lb,d);c.select()}catch(j){}a[0].parentNode.removeChild(h);a[a.length-1].parentNode.removeChild(e)}},_removeAllRanges:function(a){a.removeAllRanges()},_setToEnd:function(){var a=this;setTimeout(function(){a._setToEnd_();a._editPanel.updateToolbar()},0)},_setToEnd_:function(){var a=this;if(Sys.Extended.UI.HTMLEditor.isIE){var f=a._getSelection(),d=a._createRange(f);if(f.type.toLowerCase()!=wb){d.moveEnd("textedit",1);d.collapse(qb)}d.select();a.focusEditor();return}var e=0,b=a._doc.body,c=pb;if(b.lastChild&&b.lastChild.nodeType==3){b=b.lastChild;e=(rb+b.data+rb).length}else{var g=a._doc.createTextNode(rb);if(b.lastChild&&b.lastChild.nodeType==1&&b.lastChild.tagName.toUpperCase()==uc)b.insertBefore(g,b.lastChild);else b.appendChild(g);b=g;e=0}var f=a._getSelection();a._removeAllRanges(f);var d=a._createRange();d.setStart(b,e);d.setEnd(b,e);a._selectRange(f,d);c!=pb&&a._doc.body.removeChild(c);a.focusEditor();if(!Sys.Extended.UI.HTMLEditor.isSafari&&!Sys.Extended.UI.HTMLEditor.isOpera)try{var c=a._doc.createElement("button");c.style.width=W;c.style.height="20px";a._doc.body.appendChild(c);c.focus();c.blur();a.focusEditor();a._doc.body.removeChild(c)}catch(h){}},isShadowed:function(){var b=this;if(!b.isControl())return qb;var e=b._getSelection(),a=b._createRange(e),c;if(Sys.Extended.UI.HTMLEditor.isIE)c=a.item(0);else c=a.startContainer.childNodes.item(a.startOffset);if(c.tagName&&c.tagName.toUpperCase()==B&&c.getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute)&&c.getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute).length>0){var d=b.getAttachedElement(c);if(d!=pb){if(Sys.Extended.UI.HTMLEditor.isIE){a=b._doc.body.createControlRange();a.add(d);a.select()}else try{var f=Sys.Extended.UI.HTMLEditor.__getIndex(d);e.collapseToEnd();b._removeAllRanges(e);a=b._createRange(e);a.setStart(d.parentNode,f);a.setEnd(d.parentNode,f+1);b._selectRange(e,a)}catch(g){return sb}return qb}return sb}return qb},_ifShadow:function(){if(Sys.Extended.UI.HTMLEditor.isIE)try{var g=this._doc.selection}catch(h){return qb}var b=this,d=pb,a=Sys.Extended.UI.HTMLEditor.getSelParent(b);while(a&&(a.nodeType==3||a.tagName&&a.tagName.toUpperCase()!=Kb)){if(a.nodeType==3||!a.tagName){a=a.parentNode;continue}var f=a.tagName.toUpperCase();if(f==Nb&&a.getAttribute(Sys.Extended.UI.HTMLEditor.noContextMenuAttribute)&&a.getAttribute(Sys.Extended.UI.HTMLEditor.noContextMenuAttribute)=="yes"){d=a.rows.item(0).cells.item(0).firstChild;if(Sys.Extended.UI.HTMLEditor.isIE&&f==Rb)d=d.firstChild;break}a=a.parentNode}if(d!=pb){var e=b._getSelection(),c=b._createRange(e);if(Sys.Extended.UI.HTMLEditor.isIE){c=b._doc.body.createControlRange();c.add(d);c.select()}else try{e.collapseToEnd();b._removeAllRanges(e);c=b._createRange(e);c.setStart(d.parentNode,0);c.setEnd(d.parentNode,1);b._selectRange(e,c)}catch(h){}}},_saveContent:function(){var a=this,b,d,c;try{try{b=a._getSelection();d=a._createRange(b)}catch(e){}c=new Sys.Extended.UI.HTMLEditor._Marker(a,d,b)}catch(e){return}if(!a.__stack){a.__stack=[];a.__stackPos=0}while(a.__stackPos<a.__stack.length)a.__stack.pop();if(a.__stack.length==Sys.Extended.UI.HTMLEditor.__stackMaxSize){a.__stack.reverse();a.__stack.pop();a.__stack.reverse()}a.__stack.push(c);a.__stackPos=a.__stack.length},_restoreContent:function(){var a=this;if(a.__stack&&a.__stackPos>=0&&a.__stackPos<a.__stack.length){var b=a.__stack[a.__stackPos],f,d;if(Sys.Extended.UI.HTMLEditor.isIE){function o(d,b,e,a,c){return b.replace(/\salign=[^\s>]*/ig,rb)+(a=='"X"'?rb:"align="+a)+c.replace(/\salign=[^\s>]*/ig,rb)}for(var l=a._doc.body.getElementsByTagName(Gb),h=[],c=0;c<l.length;c++)h.push(l[c]);for(var i=0;i<h.length;i++)h[i].parentNode.removeChild(h[i]);var g=b._save.replace(/&amp;/ig,jb);g=g.replace(/(<embed(?:.*?))(teoalign=)(\"[^\"]*\")((?:.*?)>)/ig,o);a._doc.body.innerHTML=zc+Sys.Extended.UI.HTMLEditor.Trim(g);a._doc.body.firstChild&&a._doc.body.removeChild(a._doc.body.firstChild);a._doc.body.firstChild&&a._doc.body.removeChild(a._doc.body.firstChild);var k=Sys.Extended.UI.HTMLEditor.getHrefsText(g);Sys.Extended.UI.HTMLEditor.setHrefsText(a._doc.body,k);if(a._editPanel.get_relativeImages()){k=Sys.Extended.UI.HTMLEditor.getImagesText(g);Sys.Extended.UI.HTMLEditor.setImagesText(a._doc.body,k)}Sys.Extended.UI.HTMLEditor.setNames(a._doc.body,b._nArr);Sys.Extended.UI.HTMLEditor.operateAnchors(a,a._doc,!a._editPanel.get_showAnchors());Sys.Extended.UI.HTMLEditor.operatePlaceHolders(a,a._doc,!a._editPanel.get_showPlaceHolders());if(b._tree!=pb){var e=a._doc.body,c;try{for(c=b._tree.length-1;c>=0;c--)e=e.childNodes.item(b._tree[c])}catch(q){if(a.__stackPos>0){a.__stackPos--;a._restoreContent();a.__stackPos++}return}try{var n=a._doc.body.createControlRange();n.add(e);n.select()}catch(q){}}else{var j=a;setTimeout(function(){try{if(j._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel){f=j._getSelection();d=j._createRange(f);if(f.type.toLowerCase()!=wb)try{d.moveToPoint(b._offsetLeft,b._offsetTop)}catch(a){}d.select()}}catch(a){}},0)}}else{if(Sys.Extended.UI.HTMLEditor.isOpera)a._doc.body.innerHTML=Sys.Extended.UI.HTMLEditor.Trim(b._save);else{a._doc.body.innerHTML=rb;for(var c=0;c<b._save.childNodes.length;c++)a._doc.body.appendChild(b._save.childNodes.item(c).cloneNode(sb))}Sys.Extended.UI.HTMLEditor.operateAnchors(a,a._doc,!a._editPanel.get_showAnchors());Sys.Extended.UI.HTMLEditor.operatePlaceHolders(a,a._doc,!a._editPanel.get_showPlaceHolders());try{f=a._getSelection();d=a._createRange();a._removeAllRanges(f)}catch(q){}for(var p=rb,e=a._doc.body,c=b._tree.length-1;c>=0;c--){p+=Pb+b._tree[c];e=e.childNodes.item(b._tree[c])}var m=b._offset;try{d.setStart(e,m);d.setEnd(e,m)}catch(q){Sys.Extended.UI.HTMLEditor.inspectForShadows(a._doc.body);return}try{a._selectRange(f,d)}catch(q){}}try{Sys.Extended.UI.HTMLEditor.inspectForShadows(a._doc.body)}catch(q){}}},SaveContent:function(){this._saveContent()},RestoreContent:function(){this._undo(qb)},_undo:function(c){var a=this;if(a.__stack)if(a.__stackPos>0){a.__stackPos==a.__stack.length&&c&&a._saveContent();do{var d=Sys.Extended.UI.HTMLEditor.Trim(a._doc.body.innerHTML);a.__stackPos--;a._restoreContent()}while(Sys.Extended.UI.HTMLEditor.Trim(a._doc.body.innerHTML)==d&&a.__stackPos>0&&c);var b=a;setTimeout(function(){try{b._ifShadow()}catch(a){}if(b._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)try{b._editPanel.updateToolbar()}catch(a){}!c&&b.onContentChanged()},0)}},_redo:function(){var a=this;if(a.__stack)if(a.__stackPos<a.__stack.length-1){a.__stackPos++;var b=a,c;if(Sys.Extended.UI.HTMLEditor.isIE){c=b._doc.body.getElementsByTagName(Gb).length;if(c>0){var d=b._body.ownerDocument.createElement(Eb);b._body.appendChild(d);setTimeout(function(){b._body.removeChild(d)},0)}}a._restoreContent();var b=a;setTimeout(function(){b._ifShadow();b._editPanel.updateToolbar()},0)}},undo:function(){this._undo(sb);this.onContentChanged()},redo:function(){this._redo();this.onContentChanged()},_contextMenuCallP:function(){},onContentChanged:function(){},_copyCut:function(h,p){var a=this,k=a;if(Sys.Extended.UI.HTMLEditor.isIE){var c=a._getSelection(),b=a._createRange(c),i=qb,e=rb;h==Cb&&a._saveContent();if(c.type.toLowerCase()==wb){i=sb;e=Sys.Extended.UI.HTMLEditor.getHTML(b.item(0),sb)}else if(b.text!=rb){i=sb;e=b.htmlText;var n=b.duplicate(),g=a._getTextNodeCollection();if(g.length<1)return;var l=Sys.Extended.UI.HTMLEditor._commonParent(g[0],g[g.length-1]);if(l!=pb&&g[0].previousSibling&&g[0].previousSibling.nodeType==3){var f=l.parent;while(f&&f.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(f.tagName)){var m=f.cloneNode(qb);m.innerHTML=e;e=m.outerHTML;f=f.parentNode}}c=a._getSelection();c.empty();b=a._createRange(c);b.setEndPoint(Lb,n);b.setEndPoint("StartToStart",n);b.select()}else if(b.htmlText!=rb){i=sb;e=b.htmlText}if(i){var d=a._doc.createElement(ab);d.innerHTML=zc+e;d.removeChild(d.firstChild);d.removeChild(d.firstChild);var j=Sys.Extended.UI.HTMLEditor.getHTML(d,qb,sb),o=new RegExp(Xb+Sys.Extended.UI.HTMLEditor.smartClassName+":)",Yb);j=j.replace(o,w);delete d;a._contentCopy(j,sb);b.select();if(h==Cb){c.clear();a._clearP()}}else if(h==Cb){c.clear();a._clearP()}p&&setTimeout(function(){k._editPanel.updateToolbar()},0)}else if(h==Cb){a._saveContent();var c=a._getSelection(),b=a._createRange(c);a._removeAllRanges(c);b.deleteContents();if(a._doc.body.innerHTML==rb){a._doc.body.innerHTML=rc;b.setStart(a._doc.body,0);b.setEnd(a._doc.body,0)}k.onContentChanged();a._selectRange(c,b)}else{var c=a._getSelection(),b=a._createRange(c);a._removeAllRanges(c);alert(String.format(Sys.Extended.UI.Resources.HTMLEditor_toolbar_button_Use_verb,Sys.Extended.UI.HTMLEditor.isSafari&&navigator.userAgent.indexOf(D)!=E?"Apple-C":"Ctrl-C"));a._selectRange(c,b)}},_paste:function(m,n){var c=this,d=c,o=c._getSelection(),g=c._createRange(o),k,l;if(!m){k=g.offsetLeft;l=g.offsetTop;c.insertHTML(c._getPlain());d.onContentChanged();return}if(c._editPanel.get_noPaste())return;k=g.offsetLeft;l=g.offsetTop;var b=c._doc.createElement(Hb),a,h=c._contentCopy(rb,qb,n);if(/<[\/]*p[\s>]+/i.test(h)||/<[\/]*h/i.test(h))a=c._getSafePlace();else{a=c._doc.createElement(Ac);a.id=Sys.Extended.UI.HTMLEditor.smartClassName;if(!c.insertHTML(Sys.Extended.UI.HTMLEditor.getHTML(a,sb)))return;a=c._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName);if(a){a.id=pb;a.removeAttribute("id");a.setAttribute(Bc,"no")}}b.innerHTML=h;if(!a)return;c._checkImages(b);var i=a.parentNode,f=a.getAttribute(Bc);if(f!="no"){if(f.indexOf(K)>=0&&b.firstChild)if(b.firstChild.tagName&&b.firstChild.tagName.toUpperCase()==Rb){while(b.firstChild.firstChild)a.previousSibling.appendChild(b.firstChild.firstChild);b.removeChild(b.firstChild)}if(f.indexOf(G)>=0&&b.lastChild)if(b.lastChild.tagName&&b.lastChild.tagName.toUpperCase()==Rb){while(b.lastChild.lastChild)a.nextSibling.insertBefore(b.lastChild.lastChild,a.nextSibling.firstChild);b.removeChild(b.lastChild)}}var j=a,e=pb;if(b.childNodes.length==0&&f.indexOf(K)>=0&&f.indexOf(G)>=0){if(a.nextSibling.firstChild){e=c._doc.createElement(Hb);j=e;e.innerHTML="111";a.previousSibling.appendChild(e)}while(a.nextSibling.firstChild)a.previousSibling.appendChild(a.nextSibling.firstChild);i.removeChild(a.nextSibling)}else while(b.firstChild)i.insertBefore(b.firstChild,a);setTimeout(function(){var c=d._getSelection(),b=d._createRange(c);if(c.type.toLowerCase()==wb)while(b.length>0)b.remove(0);try{b.collapse(qb)}catch(f){}d.focusEditor();Sys.Extended.UI.HTMLEditor._setCursor(j,d);e&&e.parentNode.removeChild(e);i.removeChild(a);Sys.Extended.UI.HTMLEditor.inspectForShadows(d._doc.body);d.onContentChanged();b.select()},0)},_contentCopy:function(i,l,m){var b=this;if(i!=rb)i=i.replace(/(<td[^>]*?>)([\s ]*?)(<\/td[^>]*?>)/ig,Vb).replace(/(<td[^>]*?>)\s*(&nbsp;)\s*(<\/td[^>]*?>)/ig,Wb).replace(/(<p[^>]*?>)\s*(&nbsp;)\s*(<\/p[^>]*?>)/ig,Wb);var e=b._doc.createElement("iframe");e.width=ic;e.height=ic;if(Sys.Extended.UI.HTMLEditor.isIE)e.src=ib;b._doc.appendChild(e);var a=e.contentWindow.document;a.write("<html><head></head><body>"+i+Y);a.close();a.body.contentEditable=sb;var j=a.body.createTextRange(),n=qb;if(i==rb){j.execCommand(Cc);for(var q=a.createElement(ab),d=0;d<a.body.childNodes.length;d++){var h=a.body.childNodes.item(d);if(h.nodeType==8){var c=rb+h.data+rb;if(c.search(/StartFragment/i)>=0)if(h.nextSibling&&h.nextSibling.nodeType==3){var c=rb+h.nextSibling.data+rb;if(c.length)if(c.charCodeAt(0)==160){c=c.substr(1);h.nextSibling.data=c;n=sb;break}}}}if(typeof m!=tb&&m)a.body.innerHTML=Sys.Extended.UI.HTMLEditor.cleanUp(a.body.innerHTML);var c=Sys.Extended.UI.HTMLEditor.Trim(Sys.Extended.UI.HTMLEditor.getHTML(a.body,qb,sb));c=c.replace(/(<script(?:[^>]*?)>(?:[^<]*?)<\/script(?:[^>]*?)>)/gi,rb);a.body.innerHTML=c;if(!l){Sys.Extended.UI.HTMLEditor.operateAnchors(b,a,!b.showAnchors);Sys.Extended.UI.HTMLEditor.operatePlaceHolders(b,a,!b.showPlaceHolders);for(var k=a.body.getElementsByTagName(Gb),f=[],d=0;d<k.length;d++)f.push(k[d]);for(var g=0;g<f.length;g++)f[g].parentNode.removeChild(f[g])}delete j;delete q;if(l&&Sys.Extended.UI.HTMLEditor.isIE)j=a.body.createTextRange()}if(l&&Sys.Extended.UI.HTMLEditor.isIE){if(i!=rb){Sys.Extended.UI.HTMLEditor.operateAnchors(b,a,sb);Sys.Extended.UI.HTMLEditor.operatePlaceHolders(b,a,sb)}j.select();j.execCommand("copy")}for(var p=Sys.Extended.UI.HTMLEditor.Trim(a.body.innerHTML).replace(/<br\s*[\/]*>\s*<\/td>/ig,"</td>").replace(/(<td[^>]*?>)([\s ]*?)(<\/td[^>]*?>)/ig,Vb).replace(/(<p[^>]*?>)\s*(<br[^>]*?>)\s*(<\/p[^>]*?>)/ig,Vb).replace(/(<embed(?:.*?))(wmode=)(\"[^\"]*\")((?:.*?)>)/ig,lc).replace(/(<embed)([^>]*?>)/ig,mc),k=a.body.getElementsByTagName(Gb),f=[],d=0;d<k.length;d++)f.push(k[d]);for(var g=0;g<f.length;g++)f[g].parentNode.removeChild(f[g]);e.src=rb;var o=b;o._doc.removeChild(e);delete e;return p},insertHTML:function(p,i){var f="<span>qqq</span>",b=this;b.focusEditor();var w=b._getSelection();if(typeof i==tb)i=b._createRange(w);if(Sys.Extended.UI.HTMLEditor.isIE){function r(b,a){return '<span class="'+Sys.Extended.UI.HTMLEditor.smartClassName+"_script\" style='display:none;visibility:hidden;'>"+a.replace(/&/g,Dc).replace(/</g,wc).replace(/>/g,xc)+"</span>"}function q(b,a){return a.replace(/&gt;/g,Ec).replace(/&lt;/g,kc).replace(/&amp;/g,jb)}var c='<span id="'+Sys.Extended.UI.HTMLEditor.smartClassName+'">111<span></span>'+p+"</span>",u=Sys.Extended.UI.HTMLEditor.getHrefsText(c),s=Sys.Extended.UI.HTMLEditor.getImagesText(c);if(!b._editPanel.get_noScript())c=c.replace(/(<script(?:[^>]*?)>.*?<\/script(?:[^>]*?)>)/gi,r);else c=c.replace(/(<script(?:[^>]*?)>.*?<\/script(?:[^>]*?)>)/gi,rb);var x=b;try{i.pasteHTML(c)}catch(y){return qb}var a=b._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName);a.innerHTML=f+Sys.Extended.UI.HTMLEditor.getHTML(a,qb,sb).replace(new RegExp("<span(?:[^>]*?)class="+Sys.Extended.UI.HTMLEditor.smartClassName+"_script(?:[^>]*?)>(.*?)</span(?:[^>]*?)>","gi"),q)+f;a.removeChild(a.firstChild);a.removeChild(a.lastChild);Sys.Extended.UI.HTMLEditor.setHrefsText(a,u);Sys.Extended.UI.HTMLEditor.setImagesText(a,s);a.firstChild&&a.removeChild(a.firstChild);a.firstChild&&a.removeChild(a.firstChild);while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);delete a;return sb}else{var k=b._doc.createElement(Eb);k.innerHTML=p;for(var n=k.getElementsByTagName(Gb),j=[],g=0;g<n.length;g++)j.push(n[g]);for(var m=0;m<j.length;m++){var h=j[m],e=document.createElement(B),o=h.attributes;e.src=b._images_list[1];e.setAttribute(Zb,ac);for(var g=0;g<o.length;++g){var l=o.item(g);if(!l.specified)continue;var d=l.name.toLowerCase(),t=l.value;if(d==hc)d=bc;else if(d==ec)d=cc;else if(d==fc)d=dc;e.setAttribute(d,t)}e.getAttribute(oc);e.style.cssText=nc+(e.getAttribute(oc).toLowerCase()==pc?b._images_list[3]:b._images_list[2])+qc;h.parentNode.insertBefore(e,h);h.parentNode.removeChild(h)}var v=b.insertNodeAtSelection(k,i);return v}},insertNodeAtSelection:function(d,b){var c=this;if(!Sys.Extended.UI.HTMLEditor.isIE){var e=c._getSelection();if(typeof b==tb)try{b=c._createRange(e)}catch(k){c._removeAllRanges(e);return qb}var a=b.startContainer,i=b.startOffset;if(a.ownerDocument.id!=Ub)return qb;if(b.startContainer.nodeType==1&&b.startContainer.tagName.toUpperCase()==Z||b.endContainer.nodeType==1&&b.endContainer.tagName.toUpperCase()==Z)return qb;c._removeAllRanges(e);b.deleteContents();try{b=c._createRange()}catch(k){c._removeAllRanges(e);return qb}switch(a.nodeType){case 3:a=a.splitText(i);while(d.firstChild)a.parentNode.insertBefore(d.firstChild,a);b.setStart(a,0);b.setEnd(a,0);break;case 1:case 11:try{c._removeAllRanges(e);if(a.childNodes.length>=i+1){a=a.childNodes.item(i);while(d.firstChild)a.parentNode.insertBefore(d.firstChild,a);var f=c._doc.createTextNode(rb);a.parentNode.insertBefore(f,a);a=f}else{var f=c._doc.createTextNode(rb);if(Sys.Extended.UI.HTMLEditor.canHaveChildren(a)){while(d.firstChild)a.appendChild(d.firstChild);a.appendChild(f)}else{while(d.firstChild)a.parentNode.insertBefore(d.firstChild,a);a.parentNode.insertBefore(f,a)}a=f}if(a.nodeType==1){for(var g=a.parentNode,j=g,h=0;h<g.childNodes.length;h++)if(a==g.childNodes.item(h))break;b.setStart(g,h);b.setEnd(g,h)}else{b.setStart(a,0);b.setEnd(a,0)}}catch(k){c._removeAllRanges(e);return qb}}c._selectRange(e,b);return sb}else return qb},trickWithStyles:function(j){var a=this,c=a._doc.getElementById(j);if(c!=pb)if(c.nextSibling&&c.nextSibling.nodeType==3){var b=c.nextSibling;c.parentNode.removeChild(c);var e=(rb+b.data+rb).indexOf(Pb);if(e>0)b.splitText(e);else e==0&&b.splitText(1);if(a.n_arr!=pb)for(var h=0;h<a.n_arr.length;h++)a.MSIE_applyCssStyle(a.n_arr[h],[b],qb);a.n_arr=pb;var g=a._getSelection();if(!Sys.Extended.UI.HTMLEditor.isIE){var f=a._doc.createRange();f.setStart(b,b.length);f.setEnd(b,b.length);a._removeAllRanges(g);a._selectRange(g,f)}else{var i=a._createRange(g),d=a._doc.createElement(Hb);if(b.nextSibling)b.parentNode.insertBefore(d,b.nextSibling);else b.parentNode.appendChild(d);try{i.moveToElementText(d);i.select()}catch(k){}d.parentNode.removeChild(d)}}else c.parentNode.removeChild(c)},_getParent:function(a){if(Sys.Extended.UI.HTMLEditor.isIE)return a.parentElement();else return a.startContainer},_checkImages:function(g){var a="qwerty.gif";if(this._editPanel.get_relativeImages())for(var f=g.getElementsByTagName(B),e=0;e<f.length;e++){var b=f[e];if(b.src.indexOf("http://")>=0){var c=b.src;b.src=a;var d=b.src.indexOf(a);if(c.substr(0,d)==b.src.substr(0,d))c=c.substr(d,c.length-d);b.src=c}}},_getSafePlace:function(c){var e=this,a=e._doc.createElement(Ac),h=e;a.id=Sys.Extended.UI.HTMLEditor.smartClassName;if(typeof c==tb){if(!e.insertHTML(Sys.Extended.UI.HTMLEditor.getHTML(a,sb)))return pb}else{if(c.nextSibling==pb)c.parentNode.appendChild(a);else c.parentNode.insertBefore(a,c.nextSibling);c.parentNode.removeChild(c)}a=e._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName);a.id=pb;a.removeAttribute("id");a.setAttribute(Bc,"no");var b=a.parentNode,d=b.tagName.toUpperCase();while(d!=Kb&&d!=Ob&&d!=Rb&&d!=ab)if(Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)){b=b.parentNode;d=b.tagName.toUpperCase()}else break;if(d==Rb){a.setAttribute(Bc,rb);function g(j,a,d,e){var k,c=Sys.Extended.UI.HTMLEditor.myClone(d,h._doc,qb);j&&c.appendChild(j);while(a){if(a.nodeType==1||a.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+a.data+rb).length>0){var f=pb;if(a.tagName&&a.tagName.toUpperCase()==tc)f=a.text;var i=Sys.Extended.UI.HTMLEditor.myClone(a,h._doc,sb);if(c.childNodes.length==0||!e)c.appendChild(i);else c.insertBefore(i,c.firstChild);if(f!=pb)i.text=f}a=e?a.previousSibling:a.nextSibling}if(c.childNodes.length==0){delete c;c=pb}if(d==b)return c;else return g(c,e?d.previousSibling:d.nextSibling,d.parentNode,e)}var i=g(pb,a.previousSibling,a.parentNode,sb),j=g(pb,a.nextSibling,a.parentNode,qb),f=b.parentNode;if(i){f.insertBefore(i,b);a.setAttribute(Bc,a.getAttribute(Bc)+" left")}f.insertBefore(a,b);if(j){f.insertBefore(j,b);a.setAttribute(Bc,a.getAttribute(Bc)+" right")}f.removeChild(b)}return a},noContextMenuAttributeName:function(){return Sys.Extended.UI.HTMLEditor.noContextMenuAttribute},_getTextNodeCollection:function(t){var c=this,d=[];if(c.isControl())return d;var l=c._getSelection(),h=c._createRange(l),k=Sys.Extended.UI.HTMLEditor.smartClassName+Fc,o=Sys.Extended.UI.HTMLEditor.smartClassName+Gc,e=pb,g=pb,n;if(typeof t==tb){if(Sys.Extended.UI.HTMLEditor.isIE){e=h.duplicate();g=h.duplicate();e.setEndPoint(Hc,h);g.setEndPoint(Ic,h)}else{e=h.cloneRange();g=h.cloneRange();e.setEnd(e.startContainer,e.startOffset);g.setStart(g.endContainer,g.endOffset);n=e.endOffset}if(!c.insertHTML(Jc+k+Kc,g))return d;else{if(Sys.Extended.UI.HTMLEditor.isOpera){e.setEnd(e.startContainer,n);e.setStart(e.startContainer,n)}if(!c.insertHTML(Jc+o+Kc,e)){var q=c._doc.getElementById(k);if(q!=pb){f=q.parentNode;f.removeChild(q)}var p=c._doc.getElementById(rl);if(p!=pb){f=p.parentNode;f.removeChild(p)}return d}}}else{var i;i=c._doc.createElement(Ac);i.id=k;c._doc.body.appendChild(i);i=c._doc.createElement(Ac);i.id=o;c._doc.body.insertBefore(i,c._doc.body.firstChild)}var a=c._doc.getElementById(o),b=c._doc.getElementById(k);if(a==pb||b==pb){var f;if(a!=pb){f=a.parentNode;f.removeChild(a)}if(b!=pb){f=b.parentNode;f.removeChild(b)}return []}while(a.firstChild)a.removeChild(a.firstChild);while(b.firstChild)b.removeChild(b.firstChild);while(a.previousSibling&&a.previousSibling.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+a.previousSibling.data+rb).length==0)a.parentNode.removeChild(a.previousSibling);while(a.nextSibling&&a.nextSibling.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+a.nextSibling.data+rb).length==0)a.parentNode.removeChild(a.nextSibling);while(b.previousSibling&&b.previousSibling.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+b.previousSibling.data+rb).length==0)b.parentNode.removeChild(b.previousSibling);while(b.nextSibling&&b.nextSibling.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+b.nextSibling.data+rb).length==0)b.parentNode.removeChild(b.nextSibling);var s=qb,j=c;function r(a,c){while(a){if(a.id&&a.id==k){s=sb;return}if(a.nodeType==3){while(a.nextSibling&&(a.nextSibling.nodeType==3||!Sys.Extended.UI.HTMLEditor.isIE&&typeof j.__saveBM__!=tb&&j.__saveBM__!=pb&&j.__saveBM__[0]==a.nextSibling)){if(a.nextSibling.nodeType==3)a.data=rb+a.data+rb+a.nextSibling.data+rb;else{j.__saveBM__[0]=a;j.__saveBM__[1]=(rb+a.data+rb).length}a.parentNode.removeChild(a.nextSibling)}Sys.Extended.UI.HTMLEditor.Trim(rb+a.data+rb).length>0&&d.push(a)}else{var b=a.tagName;if(a.tagName){b=b.toUpperCase();if(!(b=="MAP"||b=="AREA"||b==tc||b=="NOSCRIPT"))!(a.style&&(Sys.Extended.UI.HTMLEditor.getStyle(a,Lc)==u||Sys.Extended.UI.HTMLEditor.getStyle(a,Mc)==v))&&r(a.firstChild,qb)}}if(s)return;var e=a.parentNode;if(c)while(a.nextSibling==pb)a=a.parentNode;a=a.nextSibling}}r(a,sb);var f;f=a.parentNode;f.removeChild(a);f=b.parentNode;f.removeChild(b);if(typeof t==tb)if(Sys.Extended.UI.HTMLEditor.isIE){l.empty();g.select()}else if(d.length>0){c._removeAllRanges(l);var m=c._createRange();m.setEnd(d[d.length-1],d[d.length-1].length);m.setStart(d[d.length-1],d[d.length-1].length);c._selectRange(l,m)}return d},_getPlain:function(){var a=this._doc.createElement(Nc);a.width=ic;a.height=ic;this._doc.appendChild(a);var c=a.createTextRange();c.execCommand(Cc);var b=a.value;b=b.replace(/</g,wc).replace(/>/g,xc).replace(/\r/g,rb).replace(/\n/g,rc);this._doc.removeChild(a);return b},_execCommand:function(c,g,b){var d="createlink",a=this,h=a,e,f;if(Sys.Extended.UI.HTMLEditor.isIE&&!a.isControl()){e=a._getSelection();f=a._createRange(e);var i=f.parentElement();if(i.tagName.toUpperCase()==ub)return}c.toLowerCase()!=d&&a._saveContent();switch(c.toLowerCase()){case d:if(Sys.Extended.UI.HTMLEditor.isIE||!g)a._doc.execCommand(c,g,b);else{var b;(b=prompt("Enter URL"))&&a._doc.execCommand(c,qb,b)}break;case Ab:case Db:case p:case s:a.MSIE_applyCommand(c.toLowerCase(),b);break;case "indent":a.MSIE_indent(sb);break;case "outdent":a.MSIE_indent(qb);break;case Oc:a.MSIE_justify(K);break;case Pc:a.MSIE_justify("justify");break;case Qc:a.MSIE_justify("center");break;case Rc:a.MSIE_justify(G);break;case "paragraph":a.MSIE_justify(Sc,qb,Rb);break;case Tc:if(b!=pb&&typeof b==Uc&&b.length==2)if(b.substr(0,1).toUpperCase()==L&&parseInt(b.substr(1,1))>0){a.MSIE_justify(Sc,qb,b);break}a._doc.execCommand(c,g,b);break;case "insertunorderedlist":a.MSIE_list(Vc);break;case "insertorderedlist":a.MSIE_list(Wc);break;case Bb:case Jb:case Mb:case Xc:case Yc:case Zc:a.MSIE_applyCommand(c.toLowerCase());break;default:a._doc.execCommand(c,g,b)}a.onContentChanged();if(!Sys.Extended.UI.HTMLEditor.isIE){e=a._getSelection();f=a._createRange(e);a._removeAllRanges(e);a._selectRange(e,f);a.focusEditor()}var h=a;setTimeout(function(){h._editPanel.updateToolbar()},0)},MSIE_indent:function(a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.MSIE_indent)(a)},MSIE_justify:function(c,b,a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.MSIE_justify)(c,b,a)},MSIE_list:function(a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.MSIE_list)(a)},getSelectionAfterOperation:function(a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.getSelectionAfterOperation)(a)},setSelectionAfterOperation:function(b,a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.setSelectionAfterOperation)(b,a)},get_paragraphs:function(){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.get_paragraphs)()},getPseudoP:function(){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.getPseudoP)()},getPseudoP_Recur:function(b,c,a){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.getPseudoP_Recur)(b,c,a)},unWrap:function(a,b){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.unWrap)(a,b)},tryUnWrap:function(a,c,b){return Function.createDelegate(this,Sys.Extended.UI.HTMLEditor.tryUnWrap)(a,c,b)},MSIE_applyCommand:function(i,e){var a=this,g=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb;if(a.isControl())return;var d=a._getSelection(),c=a._createRange(d),j=Sys.Extended.UI.HTMLEditor.isIE?[c.boundingLeft,c.boundingTop]:[c.startContainer,c.startOffset],h=Sys.Extended.UI.HTMLEditor.isIE&&c.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&g.length>0,b={name:u,value:u};switch(i.toLowerCase()){case Bb:b={name:ad,value:Bb,repl:qb};break;case Jb:b={name:bd,value:Jb,repl:qb};break;case Mb:b={name:cd,value:Mb,repl:qb};break;case Xc:b={name:cd,value:dd,repl:qb};break;case Yc:b={name:ed,value:"super",repl:qb};break;case Zc:b={name:ed,value:fd,repl:qb};break;case Db:b={name:N,value:e,repl:qb};break;case Ab:b={name:gd,value:e,repl:qb};break;case p:b={name:q,value:e,repl:qb};break;case s:b={name:t,value:e,repl:qb}}if(h){var f=a._getTextNodeCollection();a.MSIE_applyCssStyle(b,f,sb)}else{if(a.isControl())return;var f=a._tryExpand();if(f.length>0){a.MSIE_applyCssStyle(b,f,qb);if(Sys.Extended.UI.HTMLEditor.isIE&&a.__saveBM__!=pb){d=a._getSelection();c=a._createRange(d);c.moveToBookmark(a.__saveBM__);c.select();a.__saveBM__=pb}else if(a.__saveBM__!=pb){if(a.__saveBM__[0].nodeType==3){d=a._getSelection();c=a._doc.createRange();c.setStart(a.__saveBM__[0],a.__saveBM__[1]);c.setEnd(a.__saveBM__[0],a.__saveBM__[1]);a._removeAllRanges(d);a._selectRange(d,c)}else{a._trySelect(a.__saveBM__[0],a.__saveBM__[0]);a.__saveBM__[0].parentNode.removeChild(a.__saveBM__[0])}a.__saveBM__=pb}}else a._setStyleForTyping(b)}},MSIE_applyCssStyle:function(h,c,F){var i=this,b=h.name.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()}),d=h.value,H=h.repl,x=qb,y=qb;i._saveContent();var J=Sys.Extended.UI.HTMLEditor.smartClassName+Fc,I=Sys.Extended.UI.HTMLEditor.smartClassName+Gc,o=i._doc.createElement(Ac);o.id=I;var m=i._doc.createElement(Ac);m.id=J;c[0].parentNode.insertBefore(o,c[0]);if(c[c.length-1].nextSibling!=pb)c[c.length-1].parentNode.insertBefore(m,c[c.length-1].nextSibling);else c[c.length-1].parentNode.appendChild(m);Sys.Extended.UI.HTMLEditor.unStyle(o);Sys.Extended.UI.HTMLEditor.unStyle(m);for(var n=[],g=0;g<c.length;g++){for(var l=c[g],a=l.parentNode,w=0;w<n.length;w++){var u=n[w];if(u.parent==a){u.textNodes.push(l);break}}w==n.length&&n.push({parent:a,textNodes:[l]})}for(var g=0;g<n.length;g++){var u=n[g];if(u.textNodes.length>1){var e=u.textNodes,t=i._doc.createElement(Ac),r=i._doc.createElement(Ac);e[0].parentNode.insertBefore(t,e[0]);if(e[e.length-1].nextSibling!=pb)e[e.length-1].parentNode.insertBefore(r,e[e.length-1].nextSibling);else e[e.length-1].parentNode.appendChild(r);Sys.Extended.UI.HTMLEditor._moveTagsUp(t,r);t.parentNode.removeChild(t);r.parentNode.removeChild(r)}}for(var g=0;g<c.length;g++){var l=c[g],a=l.parentNode,A=qb;while(a&&a.tagName&&a.childNodes.length==1&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)){var f=a.tagName.toUpperCase();if((f=="I"||f=="EM")&&h.name==bd||(f=="B"||f=="STRONG")&&h.name==ad||(f=="S"||f=="STRIKE")&&h.name==cd||f=="U"&&h.name==cd||(f=="SUB"||f=="SUP")&&h.name==ed){var s=a;a=a.parentNode;while(s.firstChild)a.insertBefore(s.firstChild,s);a.removeChild(s);A=sb;continue}else if(a.style&&a.style[b]&&a.style[b].length>0){var k=a.style[b];if(b.toLowerCase().indexOf(N)>=0||b=="fontFamily"||b=="fontSize")a.style[b]=d;else if(H)try{a.style[b]=a.style[b]+Pb+d;if(k==a.style[b])a.style[b]=d}catch(K){a.style[b]=d}else if(!x){var C=k.replace(d,rb);if(b=="fontWeight"&&k.toString()==hd)C=rb;if(C==k)try{a.style[b]=a.style[b]+Pb+d;if(k==a.style[b])a.style[b]=d}catch(K){a.style[b]=d}else{a.style[b]=C.replace(/,/,rb);y=sb}x=sb}else if(y)a.style[b]=k.replace(d,rb).replace(/,/,rb);else try{a.style[b]=a.style[b]+Pb+d;if(k==a.style[b])a.style[b]=d}catch(K){a.style[b]=d}A=sb}a=a.parentNode}if(!A&&!y){var v;v=i._doc.createElement(Ac);v.style[b]=d;var G=l.parentNode;G.insertBefore(v,l);v.appendChild(l);x=sb}}var j=Sys.Extended.UI.HTMLEditor._commonTotalParent(o,m),E=j.parent.childNodes.item(j.indexFirst).previousSibling,q=j.parent.childNodes.item(j.indexLast).nextSibling;o.parentNode.removeChild(o);m.parentNode.removeChild(m);var D=0,p=j.parent.childNodes.length;if(E!=pb)D=Sys.Extended.UI.HTMLEditor.__getIndex(E);if(q!=pb){p=Sys.Extended.UI.HTMLEditor.__getIndex(q)+1;if(p<j.parent.childNodes.length)if(q.nodeType==3)p++;else if(q.nodeType==1){var B=q.tagName.toUpperCase();if(B!=Z&&B!=Ob&&B!=sc)p++}}Sys.Extended.UI.HTMLEditor.spanJoiner(j.parent,i._doc,D,p);var z=i;F&&z._selectRng(c);setTimeout(function(){!Sys.Extended.UI.HTMLEditor.isIE&&z.focusEditor();z._editPanel.updateToolbar()},0)},_tryExpand:function(o){var h="'></span><span id='",a=this,t=[],i,j,m=a._getSelection(),b=a._createRange(m),l,k,v=Sys.Extended.UI.HTMLEditor.smartClassName+"_right_add",u=Sys.Extended.UI.HTMLEditor.smartClassName+"_left_add",p=Sys.Extended.UI.HTMLEditor.smartClassName+id;if(Sys.Extended.UI.HTMLEditor.isIE&&typeof o==tb){b.execCommand(Bb);a.__saveBM__=b.getBookmark();b.execCommand(Bb)}if(Sys.Extended.UI.HTMLEditor.isIE){var d=pb,q=jd+p+kd,n=b.duplicate();try{b.pasteHTML(q)}catch(w){}d=a._doc.getElementById(p);if(d==pb)return [];if(typeof o!=tb)a.__saveBM__=d;if(d.nextSibling!=pb&&!Sys.Extended.UI.HTMLEditor.isInlineElement(d.nextSibling)){d.parentNode.removeChild(d);return []}b.expand("word");b.select();if(b.text.length==0){d.parentNode.removeChild(d);n.select();return []}var s=new RegExp(q,Yb);if(!s.test(b.htmlText.replace(/[\n\r]/g,rb))){d.parentNode.removeChild(d);n.select();return []}s=new RegExp(q+"(</span>|&nbsp;|[\\s])*$",Yb);if(s.test(b.htmlText.replace(/[\n\r]/g,rb))){d.parentNode.removeChild(d);n.select();return []}while(b.text.length>0&&b.text.substr(b.text.length-1,1)==Pb){b.moveEnd(yc,E);b.select();if(b.text.length==0){d.parentNode.removeChild(d);n.select();return []}}typeof o==tb&&d.parentNode.removeChild(d);return a._getTextNodeCollection()}function r(b){var a=/[\d\w]/;if(a.test(b))return qb;a=/[\u0080-\u024F]/;if(a.test(b))return qb;a=/[\u0370-\u2000]/;if(a.test(b))return qb;return sb}if(!a.insertHTML(Jc+u+h+p+h+v+ld))return [];var c=a._doc.getElementById(u),e=a._doc.getElementById(v),g=a._doc.getElementById(p);Sys.Extended.UI.HTMLEditor.positionInParagraph(c,c.previousSibling,sb,c.parentNode,r);try{a._trySelect(c,e)}catch(w){}l=a._getSelection();k=a._createRange(l);i=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb;j=Sys.Extended.UI.HTMLEditor.isIE&&k.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&i.length>0;if(!j||a._getTextNodeCollection().length==0){var f=a._doc.createTextNode(rb);c.parentNode.insertBefore(f,c);c.parentNode.removeChild(c);e.parentNode.removeChild(e);g.parentNode.removeChild(g);var b=a._doc.createRange();b.setStart(f,0);b.setEnd(f,0);b.setStart(f,0);b.setEnd(f,0);a._removeAllRanges(m);a._selectRange(m,b);return []}e.parentNode.insertBefore(c,g);Sys.Extended.UI.HTMLEditor.positionInParagraph(e,e.nextSibling,qb,e.parentNode,r);a._trySelect(c,e);l=a._getSelection();k=a._createRange(l);i=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb;j=Sys.Extended.UI.HTMLEditor.isIE&&k.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&i.length>0;if(!j||a._getTextNodeCollection().length==0){var f=a._doc.createTextNode(rb);c.parentNode.insertBefore(f,c);c.parentNode.removeChild(c);e.parentNode.removeChild(e);g.parentNode.removeChild(g);var b=a._doc.createRange();b.setStart(f,0);b.setEnd(f,0);b.setStart(f,0);b.setEnd(f,0);a._removeAllRanges(m);a._selectRange(m,b);return []}Sys.Extended.UI.HTMLEditor.positionInParagraph(c,c.previousSibling,sb,c.parentNode,r);a._trySelect(c,e);l=a._getSelection();k=a._createRange(l);i=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):rb;j=Sys.Extended.UI.HTMLEditor.isIE&&k.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&i.length>0;if(Sys.Extended.UI.HTMLEditor.isIE)if(typeof o!=tb)a.__saveBM__=g;else g.parentNode.removeChild(g);else a.__saveBM__=[g,0];if(j)t=a._getTextNodeCollection();c.parentNode.removeChild(c);e.parentNode.removeChild(e);return t},_setStyleForTyping:function(c){var a=this,i=c.name.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()}),h=c.value,j=c.repl;if(a._StyleForTyping==pb)a._StyleForTyping=[];for(var e=[],d=sb,b=0;b<a._StyleForTyping.length;b++){var g=a._StyleForTyping[b].name.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()}),f=a._StyleForTyping[b].value;if(!(g==i&&(f==h||j)))e.push(a._StyleForTyping[b]);else d=qb}a._StyleForTyping=e;d&&a._StyleForTyping.push(c)},_trySelect:function(b,c){var a=this,d=a._getSelection(),h=pb,i=pb;if(Sys.Extended.UI.HTMLEditor.isIE){d.empty();d=a._getSelection();var e=a._createRange(d),f=a._createRange(d);try{b!=pb&&e.moveToElementText(b);c!=pb&&f.moveToElementText(c);if(b!=pb&&c!=pb){e.setEndPoint(Lb,f);e.select()}else if(b!=pb)e.select();else c!=pb&&f.select()}catch(j){}}else try{h=a._doc.createTextNode(rb);i=a._doc.createTextNode(rb);b.parentNode.insertBefore(h,b);c.parentNode.insertBefore(i,c);var g=a._doc.createRange();g.setStart(h,0);g.setEnd(i,0);a._removeAllRanges(d);a._selectRange(d,g)}catch(j){}},getSelectedHTML:function(){var c=this._getSelection(),b=this._createRange(c),a=pb;if(Sys.Extended.UI.HTMLEditor.isIE)a=b.htmlText;else if(Sys.Extended.UI.HTMLEditor.isSafari&&(c.type=="Caret"||c.type=="None"))a=rb;else{if(Sys.Extended.UI.HTMLEditor.isSafari)if(b.cloneContents()==pb)return rb;a=Sys.Extended.UI.HTMLEditor.getHTML(b.cloneContents(),qb)}return a},_queryCommandState:function(g){var f=this,i=f._rangeStartEnd();if(i==pb)return qb;try{var a={name:u,value:u};switch(g.toLowerCase()){case Bb:a={name:ad,value:Bb};break;case Jb:a={name:bd,value:Jb};break;case Mb:a={name:cd,value:Mb};break;case Xc:a={name:cd,value:dd};break;case Yc:a={name:ed,value:"super"};break;case Zc:a={name:ed,value:fd}}var b=i.start,c=i.end,d=Sys.Extended.UI.HTMLEditor.getStyle(b,a.name).toString().toLowerCase(),e=Sys.Extended.UI.HTMLEditor.getStyle(c,a.name).toString().toLowerCase();if(a.name==ad&&d==hd)d=Bb;if(a.name==ad&&e==hd)e=Bb;if(/MSIE (5|6)/.test(navigator.userAgent)&&g.toLowerCase()==Xc&&(d==Mb||e==Mb)){while(b&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)){if(b.style.textDecoration.indexOf(dd)>=0){d=b.style.textDecoration;break}b=b.parentNode}while(c&&Sys.Extended.UI.HTMLEditor.isStyleTag(c.tagName)){if(c.style.textDecoration.indexOf(dd)>=0){e=c.style.textDecoration;break}c=c.parentNode}}if(Sys.Extended.UI.HTMLEditor.isSafari&&(g.toLowerCase()==Xc||g.toLowerCase()==Mb)){var h=g.toLowerCase();if(h==Xc)h=dd;while(b&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)){if(b.style.textDecoration.indexOf(h)>=0){d=b.style.textDecoration;break}b=b.parentNode}while(c&&Sys.Extended.UI.HTMLEditor.isStyleTag(c.tagName)){if(c.style.textDecoration.indexOf(h)>=0){e=c.style.textDecoration;break}c=c.parentNode}}var j=d.indexOf(a.value)>=0&&e.indexOf(a.value)>=0;if(f._StyleForTyping!=pb&&f._StyleForTyping.length>0)for(var k=0;k<f._StyleForTyping.length;k++){var l=f._StyleForTyping[k];if(l.name==a.name&&l.value==a.value){j=!j;break}}return j}catch(m){return qb}},_textAlignState:function(b){var a=this._rangeStartEnd();if(a==pb)return qb;try{var c=this._textAlignStateSingle(a.start),d=this._textAlignStateSingle(a.end);return c==b&&d==b}catch(e){return qb}},_textAlignStateSingle:function(a){while(a&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName))a=a.parentNode;if(a!=pb){var b=a.tagName.toUpperCase();if(b==Rb||b==ab)return a.style.textAlign.toLowerCase()}return pb},_rangeStartEnd:function(){var d=this;if(d.isControl())return pb;try{var m=d._getSelection(),a=d._createRange(m),b=pb,c=pb;if(!Sys.Extended.UI.HTMLEditor.isIE){function e(b,c){var d=pb;while(d==pb){if(b.nodeType==3)if(c&&a.startContainer!=a.endContainer&&a.startOffset==b.length&&b.nextSibling)d=e(b.nextSibling,c);else if(!c&&a.startContainer!=a.endContainer&&a.endOffset==0&&b.previousSibling)d=e(b.previousSibling,c);else d=b;else if((c?b.firstChild:b.lastChild)==pb)d=pb;else d=e(c?b.firstChild:b.lastChild,c);if(d==pb){b=c?b.nextSibling:b.previousSibling;if(b==pb)return pb}else return d}}var l=d._getParent(a);if(l.nodeType!=3&&a.startContainer==a.endContainer&&a.startOffset==a.endOffset&&a.startContainer.childNodes.item(a.startOffset).tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.startContainer.childNodes.item(a.startOffset).tagName))return {start:a.startContainer.childNodes.item(a.startOffset),end:a.startContainer.childNodes.item(a.startOffset)};b=e(a.startContainer,sb);if(b!=pb&&b.parentNode!=pb)b=b.parentNode;if(b==pb)b=a.startContainer;c=e(a.endContainer,qb);if(c!=pb&&c.parentNode!=pb)c=c.parentNode;if(c==pb)c=a.endContainer}else if(a.text.length==0)b=c=d._getParent(a);else{var k=Sys.Extended.UI.HTMLEditor.smartClassName+"_right_marker",j=Sys.Extended.UI.HTMLEditor.smartClassName+"_left_marker",i=a.duplicate(),h=a.duplicate();i.setEndPoint(Hc,a);h.setEndPoint(Ic,a);h.pasteHTML(Jc+k+Kc);i.pasteHTML(Jc+j+Kc);var f=d._doc.getElementById(j),g=d._doc.getElementById(k);b=f.parentNode;c=g.parentNode;f.parentNode.removeChild(f);g.parentNode.removeChild(g)}return {start:b,end:c}}catch(n){return pb}},rtlState:function(){if(this._doc.body.style.direction&&this._doc.body.style.direction==z)return sb;return qb},openWait:function(){this._editPanel.openWait()},closeWait:function(){this._editPanel.closeWait()}};Sys.Extended.UI.HTMLEditor.DesignPanel.ScriptRecover=function(){var a=this;a.scriptsArray=[];a.scriptsArray_index=E;a.regReplScript1=function(b,a){this.scriptsArray.push(a);return rb};a.regReplFromScript=function(b,a){return a.replace(/&gt;/g,Ec).replace(/&lt;/g,kc).replace(/&amp;/g,jb)};a.regReplFromScript1=function(e,c,f,d){var a=this;a.scriptsArray_index++;var b;if(!Sys.Extended.UI.HTMLEditor.isIE)b=a.scriptsArray[a.scriptsArray_index].replace(/&amp;/g,jb).replace(/&lt;/g,kc).replace(/&gt;/g,Ec).replace(/&quot;/g,C);else b=a.scriptsArray[a.scriptsArray_index];return c+b+d}};Sys.Extended.UI.HTMLEditor.DesignPanel.registerClass("Sys.Extended.UI.HTMLEditor.DesignPanel",Sys.Extended.UI.HTMLEditor.ModePanel);Sys.Extended.UI.HTMLEditor.DesignPanelEventHandler=function(b){var w="StyleForTyping",c=this;try{var a=c;if(a._editPanel!=Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)return sb;if(Sys.Extended.UI.HTMLEditor.isIE)try{var hb=c._doc.selection,mb=c._createRange(hb)}catch(pb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}(b.type==yb||b.type==Tb)&&c._focus(sb);if(!Sys.Extended.UI.HTMLEditor.isIE&&b.type==zb&&b.keyCode==Sys.UI.Key.tab&&c._editPanel.get_suppressTabInDesignMode()){Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel=pb;return sb}if(c.isPopup()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}var N=qb;if(a._contextElement&&a._contextElement!=pb){Function.createDelegate(c,Sys.Extended.UI.HTMLEditor.RemoveContextMenu)();if(b.type==zb||b.type==Sb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return}N=sb}if(typeof a.captureInDesign==xb)if(a.captureInDesign(b)===qb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return}if(Sys.Extended.UI.HTMLEditor.isIE&&b.type==yb&&b.ctrlKey){var i=a._getSelection(),db=b.clientX,eb=b.clientY;setTimeout(function(){var c=a._getSelection();if(c.type.toLowerCase()!=wb){var d=a._doc.body.createTextRange();d.moveToPoint(db,eb);d.select()}c=a._getSelection();var d=a._createRange(c),b=Sys.Extended.UI.HTMLEditor.getSelParent(a);while(b!=pb&&b.tagName.toUpperCase()!=Kb){if(b.tagName.toUpperCase()==Fb&&b.href!=pb&&typeof b.href!=tb&&b.href.length>0){window.open(b.href,"LinkViewWindow");break}b=b.parentNode}},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}var f=!Sys.Extended.UI.HTMLEditor.isIE?b.target:b.srcElement;if(f.tagName!=pb&&typeof f.tagName!=tb&&(f.tagName.toUpperCase()==md||f.tagName.toUpperCase()==Kb)){if(a.__kkoka!=sb){a.__kkoka=sb;setTimeout(function(){if(a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)if(!a.toEndOfProtected())try{a.focusEditor()}catch(b){}a.__kkoka=qb},0)}}else Sys.Extended.UI.HTMLEditor.contentEditable(f)!=pb&&setTimeout(function(){a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel&&a.toEndOfProtected()},0);if(N&&Sys.Extended.UI.HTMLEditor.isIE){var Y=c._getSelection(),mb;try{mb=c._createRange(Y);if(Y.type.toLowerCase()==wb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}catch(pb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}var u=Sys.Extended.UI.HTMLEditor.isIE&&b.type==zb||b.type==Sb,ob=b.type+"--"+u;if(u&&!c._editPanel.get_keyboardEnabled()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}var k=String.fromCharCode(Sys.Extended.UI.HTMLEditor.isIE?b.keyCode:b.charCode).toLowerCase();if(u&&a._editPanel.get_hotkeys()!=pb)if(a._editPanel.get_hotkeys().length>0){var gb=a._editPanel.get_hotkeys().length,T=k;if(b.keyCode==18||b.keyCode==17||b.keyCode==16)T=pb;for(var L=0;L<gb;L++){var x=a._editPanel.get_hotkeys()[L];if(x[1]==T&&x[2]==b.altKey&&x[3]==b.shiftKey&&x[4]==b.ctrlKey){typeof x[0]==xb&&setTimeout(function(){x[0](a);a.onContentChanged();a.focusEditor()},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}}if(u&&b.shiftKey&&b.keyCode==45)c._commonPaste(b);else if(u&&b.ctrlKey&&b.altKey&&b.keyCode==Sys.UI.Key.home){var E=pb,f=Sys.Extended.UI.HTMLEditor.getSelParent(a);while(f&&(f.nodeType==3||f.tagName&&f.tagName.toUpperCase()!=Kb)){if(f.nodeType==3||!f.tagName){f=f.parentNode;continue}var o=f.tagName.toUpperCase();if(!Sys.Extended.UI.HTMLEditor.canBeInsideP(f)&&o!=Rb){if(o==Ob)while(o!=Nb){f=f.parentNode;o=f.tagName.toUpperCase()}else if(o==sc)while(o!=Wc&&o!=Vc){f=f.parentNode;o=f.tagName.toUpperCase()}E=f;break}f=f.parentNode}if(E!=pb){var i=a._getSelection(),e=a._createRange(i),n=a._doc.createTextNode(rb);E.parentNode.insertBefore(n,E);if(Sys.Extended.UI.HTMLEditor.isIE){var H=a._createRange(i),Q=a._createRange(i),I=a._doc.createElement(Hb),D=a._doc.createElement(Hb);n.parentNode.insertBefore(I,n);if(n.nextSibling)n.parentNode.insertBefore(D,n.nextSibling);else n.parentNode.appendChild(D);try{H.moveToElementText(I);Q.moveToElementText(D);H.setEndPoint(Lb,Q);H.select()}catch(pb){}n.parentNode.removeChild(I);n.parentNode.removeChild(D)}else{a._removeAllRanges(i);e.setStart(n,0);e.setEnd(n,0);a._selectRange(i,e)}}}else if(Sys.Extended.UI.HTMLEditor.isIE&&b.keyCode>=33&&b.keyCode<=40&&!b.shiftKey){var cb=b.keyCode==Sys.UI.Key.pageDown||b.keyCode==Sys.UI.Key.end||b.keyCode==Sys.UI.Key.right||b.keyCode==Sys.UI.Key.down;setTimeout(function(){var e=a._getSelection(),d=a._createRange(e);if(e.type.toLowerCase()==wb){var b=d.item(0);if(!b.contentEditable||b.contentEditable==nd){d.remove(0);e.empty();d=a._createRange(e);var c=a._doc.createElement(Ac);c.appendChild(a._doc.createTextNode(rb));if(cb)if(b.nextSibling==pb)b.parentNode.appendChild(c);else b.parentNode.insertBefore(c,b.nextSibling);else b.parentNode.insertBefore(c,b);d.moveToElementText(c);d.select();setTimeout(function(){a.focusEditor();c.parentNode.removeChild(c)},0)}}},0)}else if((u&&!Sys.Extended.UI.HTMLEditor.isSafari||Sys.Extended.UI.HTMLEditor.isSafari&&b.type==zb)&&b.ctrlKey&&!b.altKey){a._a_prize=qb;var i=pb,e=pb,k=String.fromCharCode(Sys.Extended.UI.HTMLEditor.isIE||Sys.Extended.UI.HTMLEditor.isOpera||Sys.Extended.UI.HTMLEditor.isSafari?b.keyCode:b.charCode).toLowerCase(),p=pb,z=pb;if((Sys.Extended.UI.HTMLEditor.isIE||Sys.Extended.UI.HTMLEditor.isSafari)&&b.keyCode==17)return qb;else if(!Sys.Extended.UI.HTMLEditor.isIE&&b.keyCode==Sys.UI.Key.end&&!b.shiftKey)a._setToEnd();else if(b.keyCode==46&&c.isShadowed()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}else if(b.keyCode==46||b.keyCode==Sys.UI.Key.backspace)(Sys.Extended.UI.HTMLEditor.isIE&&b.type==zb||!Sys.Extended.UI.HTMLEditor.isIE&&b.type==Sb)&&c._saveContent();else switch(k){case "a":if(!Sys.Extended.UI.HTMLEditor.isIE){i=c._getSelection();c._removeAllRanges(i);e=c._createRange();e.selectNodeContents(c._doc.body);c._selectRange(i,e);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}else a._a_prize=sb;break;case "z":c.undo();Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;break;case "p":if(!Sys.Extended.UI.HTMLEditor.isIE){setTimeout(function(){a._contextMenuCallP()},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}break;case "y":c.redo();Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;break;case Cb:if(c.isShadowed()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}c._saveContent();if(Sys.Extended.UI.HTMLEditor.isIE)if(b.type==zb){a.openWait();setTimeout(function(){a._copyCut(k,qb);a.closeWait()},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}break;case "c":if(c.isShadowed()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}if(Sys.Extended.UI.HTMLEditor.isIE)if(b.type==zb){a.openWait();setTimeout(function(){a._copyCut(k,qb);a.closeWait();setTimeout(function(){a._ifShadow()},0)},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}break;case "v":if(c.isShadowed()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}if(Sys.Extended.UI.HTMLEditor.isIE){c._saveContent();return sb}c._commonPaste(b);break;case "b":c._execCommand(Bb,qb,z);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;case "i":c._execCommand(Jb,qb,z);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;case "u":c._execCommand(Mb,qb,z);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;case "s":c._execCommand(Xc,qb,z);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;case "l":p=Oc;break;case "e":p=Qc;break;case "r":p=Rc;break;case "j":p=Pc;break;case "q":alert(c._doc.body.innerHTML);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;break;case ic:var kb="Your browser:\n\n"+navigator.userAgent;alert(kb);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb;break;case "9":if(!Sys.Extended.UI.HTMLEditor.isIE){var i=a._getSelection(),e=a._createRange(i),d=e.startContainer,v=e.endContainer,r=rb;r+="startContainer: "+(d.nodeType==1?d.tagName:vb)+od;r+="endContainer  : "+(v.nodeType==1?v.tagName:vb)+od;if(d==v){r+="startOffset: "+e.startOffset+od;r+="endOffset  : "+e.endOffset+od;if(d.nodeType==1){d=d.childNodes.item(e.startOffset);if(d&&d.nodeType){r+="startOffset node: "+(d.nodeType==1?d.tagName:vb)+od;if(e.startOffset!=e.endOffset){d=d.childNodes.item(e.endOffset);if(d&&d.nodeType)r+="endOffset node: "+(d.nodeType==1?d.tagName:vb)+od}}else r+=d}}alert(r)}else{var i=a._getSelection(),e=a._createRange(i);alert("boundingLeft: "+e.boundingLeft+" boundingTop: "+e.boundingTop+od+"boundingWidth: "+e.boundingWidth+" boundingHeight: "+e.boundingHeight)}Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}if(p){c._execCommand(p,qb,z);if(p==Tc&&!Sys.Extended.UI.HTMLEditor.isIE){c._saveContent();c._undo(qb)}Sys.Extended.UI.HTMLEditor._stopEvent(b);(p=="delete"||p==Cc)&&c._clearP()}}else if(u||Sys.Extended.UI.HTMLEditor.isSafari&&b.type==zb){if(Sys.Extended.UI.HTMLEditor.isIE&&c._tryForward){var e=c._createRange(c._getSelection());e.select();c._tryForward=qb}var k=String.fromCharCode(Sys.Extended.UI.HTMLEditor.isIE?b.keyCode:b.charCode).toLowerCase();if(a._a_prize){a._a_prize=qb;function fb(){var c=a._createRange(a._getSelection()),b=c.parentElement();if(b&&b.nodeType==1&&b.tagName.toUpperCase()==Rb){while(b.firstChild)b.parentNode.insertBefore(b.firstChild,b);b.parentNode.removeChild(b)}}setTimeout(fb,0)}if(c.isShadowed()){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}switch(b.keyCode){case Sys.UI.Key.tab:if(Sys.Extended.UI.HTMLEditor.isSafari&&b.type!=zb)break;if(!c._editPanel.get_suppressTabInDesignMode()){!c.isControl()&&c.insertHTML("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");Sys.Extended.UI.HTMLEditor._stopEvent(b)}else{Sys.Extended.UI.HTMLEditor.isSafari&&Sys.Extended.UI.HTMLEditor._stopEvent(b);Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel=pb;return sb}break;case 46:case Sys.UI.Key.backspace:if(Sys.Extended.UI.HTMLEditor.isSafari&&b.type!=zb)break;((Sys.Extended.UI.HTMLEditor.isIE||Sys.Extended.UI.HTMLEditor.isSafari)&&b.type==zb||!Sys.Extended.UI.HTMLEditor.isIE&&b.type==Sb)&&c._saveContent();if(!Sys.Extended.UI.HTMLEditor.isIE){var e=c._createRange(c._getSelection()),d=e.startContainer,v=e.endContainer;if(b.type==Sb)if(Sys.Extended.UI.HTMLEditor.contentEditable(d)!=pb||Sys.Extended.UI.HTMLEditor.contentEditable(v)!=pb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}if(d==v&&d.nodeType==1&&d.tagName.toUpperCase()==Ob&&e.startOffset==e.startOffset&&d.childNodes.item(e.startOffset)&&d.childNodes.item(e.startOffset).tagName&&d.childNodes.item(e.startOffset).tagName.toUpperCase()==uc){var X=d.childNodes.item(e.startOffset),V=0,S=0,s;s=X.previousSibling;while(s){V++;s=s.previousSibling}s=X.nextSibling;while(s){S++;s=s.nextSibling}if(b.keyCode==46&&S==0||b.keyCode==Sys.UI.Key.backspace&&V==0){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}else if(b.keyCode==46&&d.firstChild==d.lastChild&&d.firstChild.nodeType==1){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}if(d==v&&d.nodeType==3&&e.startOffset==e.endOffset){var jb=d.data+rb;if(b.keyCode==46)if(e.startOffset==jb.length&&!(d.nextSibling&&d.nextSibling.nodeType==3)){if(d.nextSibling){d.parentNode.removeChild(d.nextSibling);a.onContentChanged()}Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}if(b.keyCode==Sys.UI.Key.backspace)if(e.startOffset==0&&!(d.previousSibling&&d.previousSibling.nodeType==3)){if(d.previousSibling){d.parentNode.removeChild(d.previousSibling);a.onContentChanged()}Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}if(b.keyCode==Sys.UI.Key.backspace&&d.nodeType==1&&d==v&&e.startOffset==e.endOffset){var q=d.childNodes.item(e.startOffset);if(q!=pb&&q.nodeType==1&&q.tagName.toUpperCase()==uc){q=q.previousSibling;if(q!=pb&&q.nodeType!=3){q.parentNode.removeChild(q);a.onContentChanged();Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}}setTimeout(function(){var h=a._getSelection(),b=a._createRange(h),f=b.startContainer,i=b.endContainer;if(Sys.Extended.UI.HTMLEditor.contentEditable(f)!=pb||Sys.Extended.UI.HTMLEditor.contentEditable(i)!=pb){a._undo(qb);return}if(f==i&&f.nodeType==1&&Sys.Extended.UI.HTMLEditor.isStyleTag(f.tagName)&&b.startOffset==b.endOffset&&f.childNodes.length==0){while(f.parentNode.nodeType==1&&Sys.Extended.UI.HTMLEditor.isStyleTag(f.parentNode.tagName)&&f.parentNode.childNodes.length==1)f=f.parentNode;var c=f.nextSibling,d=f.previousSibling,g=f.parentNode;g.removeChild(f);a.onContentChanged();if(c==pb&&d==pb){b.setStart(g,0);b.setEnd(g,0)}else if(c!=pb&&d!=pb)if(c.nodeType==3&&d.nodeType==3){var e=(rb+d.data+rb).length;d.appendData(c.data);g.removeChild(c);b.setStart(d,e);b.setEnd(d,e)}else if(d.nodeType==3){var e=(rb+d.data+rb).length;b.setStart(d,e);b.setEnd(d,e)}else if(c.nodeType==3){b.setStart(c,0);b.setEnd(c,0)}else if(c.childNodes.length>0){b.setStart(c,0);b.setEnd(c,0)}else{var e=Sys.Extended.UI.HTMLEditor.__getIndex(c);b.setStart(g,e);b.setEnd(g,e)}else if(d!=pb)if(d.nodeType==3){var e=(rb+d.data+rb).length;b.setStart(d,e);b.setEnd(d,e)}else{var e=d.childNodes.length;if(e>0){b.setStart(d,e);b.setEnd(d,e)}else{e=Sys.Extended.UI.HTMLEditor.__getIndex(d);b.setStart(g,e);b.setEnd(g,e)}}else if(c!=pb)if(c.nodeType==3){b.setStart(c,0);b.setEnd(c,0)}else{var e=c.childNodes.length;if(e>0){b.setStart(c,e);b.setEnd(c,e)}else{e=Sys.Extended.UI.HTMLEditor.__getIndex(c);b.setStart(g,e);b.setEnd(g,e)}}a._removeAllRanges(h);a._selectRange(h,b)}},0)}else{var i=a._getSelection();if(i.type.toLowerCase()==wb){if(b.keyCode==8){setTimeout(function(){a._ifShadow();a.onContentChanged()},0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return}var m=a._createRange(i),F=m.item(0);if(F.tagName.toUpperCase()==Gb){F.src=rb;F.parentNode.removeChild(F);while(m.length>0)m.remove(0);try{m.collapse(qb)}catch(pb){}Sys.Extended.UI.HTMLEditor._stopEvent(b);a._saveContent();setTimeout(function(){a._undo(qb);a.onContentChanged()},0);return}}var M=a._doc.body.getElementsByTagName(Gb).length;if(M>0){var R=a._body.ownerDocument.createElement(Eb);a._body.appendChild(R);var nb=b.keyCode;setTimeout(function(){a._body.removeChild(R);var b=a._doc.body.getElementsByTagName(Gb);if(M!=b.length){a._saveContent();setTimeout(function(){a._undo(qb);a.onContentChanged()},0)}},0)}setTimeout(function(){a._clearP()},0)}break;case Sys.UI.Key.enter:if(Sys.Extended.UI.HTMLEditor.isSafari&&b.type==zb)break;(!Sys.Extended.UI.HTMLEditor.isIE&&b.type==Sb||Sys.Extended.UI.HTMLEditor.isIE&&b.type==zb)&&c._saveContent();if(Sys.Extended.UI.HTMLEditor.isIE&&b.type==zb){var i=a._getSelection();if(i.type.toLowerCase()==wb)break;var m=a._createRange(i);if(!b.shiftKey){var g=m.parentElement();if(g.tagName.toUpperCase()==ub)break;while(g&&g.tagName&&g.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(g.tagName))g=g.parentNode;if(g&&g.tagName){var o=g.tagName.toUpperCase();if(o==Rb||o==sc){if(o==sc){function lb(){m=a._createRange(a._getSelection());var b=m.parentElement();while(b&&b.tagName&&b.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName))b=b.parentNode;if(b&&b.nodeType==1&&b.tagName.toUpperCase()==Rb){var d=a._doc.createElement(Hb),e=a._doc.createTextNode(Pb),c=b;while(c.firstChild!=pb&&c.firstChild.nodeType==1)c=c.firstChild;if(c.nodeType==1){c.appendChild(e);c.appendChild(d);while(b.firstChild)b.parentNode.insertBefore(b.firstChild,b)}else{b.parentNode.insertBefore(e,b);b.parentNode.insertBefore(d,b)}b.parentNode.removeChild(b);m.moveToElementText(d);m.select();d.parentNode.removeChild(d);a.onContentChanged()}}setTimeout(lb,0)}break}}try{var K=Sys.Extended.UI.HTMLEditor.smartClassName+id,h=pb,O=jd+K+kd;function ab(){var c=a._getSelection(),b=a._createRange(c);if(h!=pb){h.innerHTML=Ib;b.moveToElementText(h);b.select();h.parentNode.insertBefore(h.firstChild,h);h.parentNode.removeChild(h);a.onContentChanged()}}m.pasteHTML(O);var B=qb;h=a._doc.getElementById(K);if(h!=pb){var t=h.nextSibling,y=h.parentNode;while(t==pb&&y!=pb&&Sys.Extended.UI.HTMLEditor.isStyleTag(y.tagName)){t=y.nextSibling;y=y.parentNode}if(t!=pb&&!Sys.Extended.UI.HTMLEditor.isInlineElement(t)&&t.tagName!=pb&&typeof t.tagName!=tb){var G=t.tagName.toUpperCase();if(G!=uc&&G!=Vc&&G!=Wc&&G!=Rb)B=sb}h.parentNode.removeChild(h)}m.pasteHTML(rc+(B?O:rb));if(B)h=a._doc.getElementById(K);m.select();if(B){setTimeout(ab,0);Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}}catch(pb){}}else break;Sys.Extended.UI.HTMLEditor._stopEvent(b)}else if(!b.shiftKey&&(Sys.Extended.UI.HTMLEditor.isSafari||Sys.Extended.UI.HTMLEditor.isOpera)){var g=Sys.Extended.UI.HTMLEditor.getSelParent(c);if(g.nodeType==3)g=g.parentNode;while(g&&g.tagName&&g.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(g.tagName))g=g.parentNode;if(g&&g.tagName&&(g.tagName.toUpperCase()==Rb||g.tagName.toUpperCase()==sc))break;c.insertHTML(rc);Sys.Extended.UI.HTMLEditor._stopEvent(b);a.onContentChanged()}else if(Sys.Extended.UI.HTMLEditor.isSafari){c.insertHTML(rc);Sys.Extended.UI.HTMLEditor._stopEvent(b);a.onContentChanged()}}}else a._a_prize=qb;if(Sys.Extended.UI.HTMLEditor.isIE&&b.type==Sb&&!b.ctrlKey){var k=b.keyCode,W=a._getSelection(),C=a._createRange(W);if(C.text.length>0){var A=String.fromCharCode(k),U=Sys.Extended.UI.HTMLEditor.capLock(b),ib=b.shiftKey&&!U||U;if(!ib)A=A.toLowerCase();var l=Sys.Extended.UI.HTMLEditor.smartClassName+w,j=a._doc.getElementById(l);if(j!=pb){A=Jc+l+ld+A+Jc+l+l+ld;j.parentNode.removeChild(j)}C.pasteHTML(A);if(j!=pb){a.trickWithStyles(l);j=a._doc.getElementById(l+l);j.parentNode.removeChild(j)}Sys.Extended.UI.HTMLEditor._stopEvent(b);a.onContentChanged();return qb}}if(b.type==Qb||b.type==yb||b.type==zb){var bb=sb;if(b.type==zb&&!b.ctrlKey){var k=b.keyCode;if(k>=48&&k<=90||k==32||k==13||k>=186&&k<=222||k>=96&&k<=111)if(a._StyleForTyping!=pb){a.n_arr=[];for(var J=0;J<a._StyleForTyping.length;J++)a.n_arr.push(a._StyleForTyping[J]);var l=Sys.Extended.UI.HTMLEditor.smartClassName+w,P=sb;if(!Sys.Extended.UI.HTMLEditor.isIE)a.insertHTML(Jc+l+ld);else{a.insertHTML(Jc+l+"'>&nbsp;</span>");var j=a._doc.getElementById(l);if(j&&j.nextSibling&&j.nextSibling.nodeType==3){P=qb;var W=a._getSelection(),C=a._createRange(W);C.moveToElementText(a._doc.getElementById(l));C.select()}else j&&j.removeChild(j.firstChild)}P&&setTimeout(function(){a.trickWithStyles(l);a.onContentChanged()},0)}}if(bb||!Sys.Extended.UI.HTMLEditor.isIE)if(!a._updated_now){if(a._updateTimer){clearTimeout(a._updateTimer);a._updateTimer=pb}a._updateTimerLimit=3;function Z(){if(a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel)try{if(Sys.Extended.UI.HTMLEditor.isIE){try{var b=a._doc.selection}catch(c){return qb}if(a._getSelection().type=="None"&&a._doc.queryCommandValue(Ab)==0&&a._doc.queryCommandValue(Db)==0){a._updateTimerLimit--;if(a._updateTimerLimit>0){a._updateTimer=setTimeout(Z,100);return}}}a._updated_now=sb;a._editPanel.updateToolbar();a._updated_now=qb;a._updateTimer=pb;!Sys.Extended.UI.HTMLEditor.isIE&&a.focusEditor()}catch(c){}}a._updateTimer=setTimeout(Z,300)}}if(!(!Sys.Extended.UI.HTMLEditor.isIE&&(b.type==zb||b.type=="keyup")||Sys.Extended.UI.HTMLEditor.isIE&&(b.type==zb||b.type=="keyup")&&(b.keyCode==16||b.keyCode==20)))a._StyleForTyping=pb;Sys.Extended.UI.HTMLEditor.isSafari&&setTimeout(function(){a._createRange(a._getSelection())},0);!Sys.Extended.UI.HTMLEditor.isIE&&setTimeout(function(){if(a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel){var c=a._getSelection(),b=a._createRange(c);if(b.startContainer.nodeType!=3&&b.startContainer==b.endContainer)if(b.startOffset==b.endOffset)if(b.startContainer.childNodes.item(b.startOffset))if(b.startContainer.childNodes.item(b.startOffset).nodeType==3){var d=b.startContainer.childNodes.item(b.startOffset);c.collapseToEnd();a._removeAllRanges(c);c=a._getSelection();b=a._createRange(c);b.setStart(d,0);b.setEnd(d,0);a._selectRange(c,b)}}},0);if(!Sys.Extended.UI.HTMLEditor.isIE){var i=a._getSelection(),e=a._createRange(i);a._saved_startContainer=e.startContainer;a._saved_startOffset=e.startOffset}setTimeout(function(){try{a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel&&a._ifShadow()}catch(b){}},0);if(b.type==zb)if(a._AfterOnContentChanged==pb||typeof a._AfterOnContentChanged==tb||!a._AfterOnContentChanged){a._AfterOnContentChanged=sb;setTimeout(function(){if(a._editPanel==Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel){a.onContentChanged();a._AfterOnContentChanged=qb}},0)}return sb}catch(pb){Sys.Extended.UI.HTMLEditor._stopEvent(b);return qb}};Sys.Extended.UI.HTMLEditor.ActiveModeType=function(){};Sys.Extended.UI.HTMLEditor.ActiveModeType.prototype={Design:0,Html:1,Preview:2};Sys.Extended.UI.HTMLEditor.ActiveModeType_checkValue=function(a){if(a>=0&&a<=2)return sb;return qb};Sys.Extended.UI.HTMLEditor.ActiveModeType.registerEnum("Sys.Extended.UI.HTMLEditor.ActiveModeType",sb);Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs=function(d,c,b){var a=this;if(arguments.length!=3)throw Error.parameterCount();Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs.initializeBase(a);a._oldMode=d;a._newMode=c;a._editPanel=b};Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs.prototype={get_oldMode:function(){return this._oldMode},get_newMode:function(){return this._newMode},get_editPanel:function(){return this._editPanel}};Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs.registerClass("Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs",Sys.EventArgs);Sys.Extended.UI.HTMLEditor.MSIE_list=function(o){var j=this,h=j.get_paragraphs(),g=j.getSelectionAfterOperation(h),d=pb,b=[],e=j,a=pb,c=[],k=o.toUpperCase(),n=qb;function f(){if(a!=pb){var d;d=a.cloneNode(qb);a.parentNode.insertBefore(d,a);while(a.firstChild!=c[0])d.appendChild(a.firstChild);d.firstChild==pb&&d.parentNode.removeChild(d);if(a.tagName.toUpperCase()==k)for(var h=0;h<c.length;h++){var b=c[h];if(b.nodeType==1&&b.tagName&&b.tagName.toUpperCase()==sc){var m=qb;a.parentNode.insertBefore(b,a);if(b.style.textAlign==rb)b.style.textAlign=a.style.textAlign;if(a.childNodes.length==0&&h==c.length-1){a.parentNode.removeChild(a);a=pb}if(b.style.textAlign==rb||b.style.textAlign.toLowerCase()==K&&!e.rtlState()||b.style.textAlign.toLowerCase()==G&&e.rtlState()){m=e.tryUnWrap(b,g);if(m)n=sb}if(!m){for(var i=e._doc.createElement(e.dfltBlockElement),l=b.attributes,j=0;j<l.length;++j){var f=l.item(j);if(!f.specified)continue;if(f.name.toLowerCase()==gc)continue;i.setAttribute(f.name,f.value)}i.style.cssText=b.style.cssText;if(i.tagName.toUpperCase()==Rb)i.style.margin=W;while(b.firstChild)i.appendChild(b.firstChild);b.parentNode.insertBefore(i,b);b.parentNode.removeChild(b)}}else a.parentNode.insertBefore(b,a)}else{for(var d=e._doc.createElement(k),l=a.attributes,j=0;j<l.length;++j){var f=l.item(j);if(!f.specified)continue;if(f.name.toLowerCase()==gc)continue;d.setAttribute(f.name,f.value)}d.style.cssText=a.style.cssText;a.parentNode.insertBefore(d,a);for(var h=0;h<c.length;h++){var b=c[h];d.appendChild(b)}}if(a!=pb){d=a.cloneNode(qb);a.parentNode.insertBefore(d,a);while(a.firstChild)d.appendChild(a.firstChild);d.firstChild==pb&&d.parentNode.removeChild(d);a.parentNode.removeChild(a)}}a=pb;c=[]}function m(){var A=d.firstChild,B=d.lastChild,n=d.tagName.toUpperCase();if(!Sys.Extended.UI.HTMLEditor.isInlineElement(d)&&b[0][0]==A&&b[b.length-1][b[b.length-1].length-1]==B&&(n==Wc||n==Vc||n==pd||n==sc||(n==Rb||n==ab||Sys.Extended.UI.HTMLEditor.isHeader(d))&&n==sc)){f();c=[];if(n==sc){a=d.parentNode;c.push(d)}else if(n==Rb||n==ab||Sys.Extended.UI.HTMLEditor.isHeader(d)){a=d.parentNode.parentNode;c.push(d.parentNode)}else{a=d;for(var p=0;p<b.length;p++)for(var o=b[p],j=0;j<o.length;j++)c.push(o[j])}f()}else if(n==sc&&b.length<h.length){if(a!=d.parentNode){f();a=d.parentNode;c=[]}c.push(d)}else if(n==Wc||n==Vc||n==pd){f();a=d;c=[];for(var p=0;p<b.length;p++)for(var o=b[p],j=0;j<o.length;j++)c.push(o[j]);f()}else{var i=pb,l=pb;function r(){if(i!=pb)if(i.childNodes==1&&(i.firstChild==g[0]||i.firstChild==g[1])){i.parentNode.insertBefore(i.firstChild,i);i.parentNode.removeChild(i)}i=pb}a!=pb&&f();var u=rb;if(b.length==1&&b[0].length==1&&b[0][0].nodeType==1&&b[0][0].tagName)u=b[0][0].tagName.toUpperCase();if(u==Wc||u==Vc||u==pd){var m=b[0][0];a=m;c=[];for(var p=0;p<m.childNodes.length;p++){var D=m.childNodes.item(p);c.push(D)}f()}else for(var p=0;p<b.length;p++){for(var o=b[p],j=0;j<o.length;j++){var m=o[j],v=m.tagName?m.tagName.toUpperCase():rb;if(l==pb){l=e._doc.createElement(k);m.parentNode.insertBefore(l,m)}if(!Sys.Extended.UI.HTMLEditor.isInlineElement(m)&&v!=uc){i&&i.firstChild&&r();if(i==pb){i=e._doc.createElement(sc);l.appendChild(i)}i.appendChild(m);r()}else{if(i==pb){i=e._doc.createElement(sc);l.appendChild(i)}var y=o[o.length-1]==g[1]?o.length-1:o.length,z=o[0]==g[0]?1:0;if(v==uc&&j==y-1&&j==z)if(Sys.Extended.UI.HTMLEditor.isIE){i.appendChild(e._doc.createTextNode(String.fromCharCode(160)));m.parentNode.removeChild(m)}else i.appendChild(m);else if(v==uc&&j==y-1&&j>z)m.parentNode.removeChild(m);else i.appendChild(m);if(v==uc&&j==o.length-1){r();i=pb}if(m==g[1]&&j==o.length-1){r();i=pb}}}i&&i.firstChild&&r()}if(l!=pb){for(var q=[],j=0;j<l.childNodes.length;j++)q.push(l.childNodes.item(j).style.textAlign);for(var s=1;s<q.length;s++)if(q[s-1]!=q[s])break;if(s==q.length){for(var C=q[0]==K&&!e.rtlState()||q[0]==G&&e.rtlState()?rb:q[0],j=0;j<l.childNodes.length;j++)l.childNodes.item(j).style.textAlign=rb;l.style.textAlign=C}}if(l!=pb)if(l.parentNode.tagName.toUpperCase()==Rb&&l.parentNode.childNodes.length==1){var t=l.parentNode,w=t.cloneNode(qb);t.parentNode.insertBefore(l,t);t.parentNode.removeChild(t);if(l.childNodes.length==1){var x=l.firstChild;while(x.firstChild)w.appendChild(x.firstChild);x.appendChild(w)}else delete w}}}for(var l=0;l<h.length;l++){var i=h[l];if(i.length>0){if(i[0].parentNode!=d){b.length>0&&m();b=[];d=i[0].parentNode}b.push(i)}}b.length>0&&m();a!=pb&&f();j.setSelectionAfterOperation(g,n)};Sys.Extended.UI.HTMLEditor.MSIE_justify=function(c,q,l){var k=this,n=k.get_paragraphs(),e=k.getSelectionAfterOperation(n),a=pb,d=[],g=k,b=typeof q!=tb&&q?sb:qb,f=typeof l==Uc?sb:qb,h=typeof l==Uc?l:rb,i=qb;function m(a){if(a!=pb)if(a.childNodes==1&&(a.firstChild==e[0]||a.firstChild==e[1])){a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)}}function p(){var I=a.firstChild,J=a.lastChild,H=qb,q;if(a.tagName&&!Sys.Extended.UI.HTMLEditor.isInlineElement(a)&&d[0][0]==I&&d[d.length-1][d[d.length-1].length-1]==J){q=a.tagName.toUpperCase();if(q!=Ob&&q!="TH"&&q!=qd&&q!=rd)H=sb}if(H){var z=rb;if(a.getAttribute(jc)&&a.getAttribute(jc).length>0)z=a.getAttribute(jc);if(a.align&&a.align.length>0)z=a.align;if(a.style.textAlign&&a.style.textAlign.length>0)z=a.style.textAlign;a.align=rb;a.setAttribute(jc,rb);a.removeAttribute(jc);if((q==ab||q==Rb||Sys.Extended.UI.HTMLEditor.isHeader(a))&&c==K&&b){if(g.tryUnWrap(a,e,b))i=sb}else{if(c!=Sc)if(!(c==K&&b)||q==sc&&a.parentNode.style.textAlign.length>0)a.style.textAlign=c;else a.style.textAlign=rb;if(b)a.style.margin=q==Rb?W:rb;if(q==sc){for(var n=a.parentNode,p=[],u=0;u<n.childNodes.length;u++)n.childNodes.item(u).nodeType==1&&p.push(n.childNodes.item(u).style.textAlign);for(var r=1;r<p.length;r++)if(p[r-1]!=p[r])break;if(r==p.length){for(var z=p[0]==K&&b?rb:p[0],l=0;l<n.childNodes.length;l++)if(n.childNodes.item(l).nodeType==1){n.childNodes.item(l).style.textAlign=rb;if(b)n.childNodes.item(l).style.margin=n.childNodes.item(l).tagName.toUpperCase()==Rb?W:rb}n.style.textAlign=z}}if((q==ab||q==Rb||Sys.Extended.UI.HTMLEditor.isHeader(a))&&f&&h.toUpperCase()!=q){for(var t=g._doc.createElement(h),A=a.attributes,y=0;y<A.length;++y){var v=A.item(y);if(!v.specified)continue;if(v.name.toLowerCase()==gc)continue;t.setAttribute(v.name,v.value)}t.style.cssText=a.style.cssText;while(a.firstChild)t.appendChild(a.firstChild);a.parentNode.insertBefore(t,a);a.parentNode.removeChild(a)}}}else for(var o=pb,E=0;E<d.length;E++){if(!f)o=pb;for(var s=d[E],l=0;l<s.length;l++){var j=s[l],k=j.nodeType==1&&j.tagName?j.tagName.toUpperCase():pb;if(k!=pb&&(k==Vc||k==Wc||k==pd||k==ab||Sys.Extended.UI.HTMLEditor.isHeader(j)||k==Rb||k==sc||k==Nb)){m(o);o=pb;if(c!=Sc)if(k!=Nb&&!b)j.style.textAlign=c;if(b)j.style.margin=k==Rb?W:rb;if(k==Vc||k==Wc||k==pd){for(var C=0;C<j.childNodes.length;C++){var x=j.childNodes.item(C);if(x.nodeType==1){x.style.textAlign=rb;if(b)x.style.margin=x.tagName.toUpperCase()==Rb?W:rb;for(var D=0;D<x.childNodes.length;D++){var w=x.childNodes.item(D);if(w.nodeType==1&&w.tagName){var B=w.tagName.toUpperCase();if(b)w.style.margin=B==Rb?W:rb;if(B==ab||B==Rb||Sys.Extended.UI.HTMLEditor.isHeader(w))if(g.tryUnWrap(w,e,b))i=sb}}}}if(c==K&&b)j.style.textAlign=rb;continue}else if(k==sc){if(c!=Sc)if(!(c==K&&b)||j.parentNode.style.textAlign.length>0)j.style.textAlign=c;else j.style.textAlign=rb;if(b)j.style.margin=k==Rb?W:rb;for(var n=j.parentNode,p=[],u=0;u<n.childNodes.length;u++)n.childNodes.item(u).nodeType==1&&p.push(n.childNodes.item(u).style.textAlign);for(var r=1;r<p.length;r++)if(p[r-1]!=p[r])break;if(r==p.length){for(var z=p[0]==K&&b?rb:p[0],l=0;l<n.childNodes.length;l++)if(n.childNodes.item(l).nodeType==1){n.childNodes.item(l).style.textAlign=rb;if(b)n.childNodes.item(l).style.margin=n.childNodes.item(l).tagName.toUpperCase()==Rb?W:rb}n.style.textAlign=z}continue}else if(k==Nb)if(c!=Sc)if(!(c==K&&b))j.align=c;else{j.align=rb;j.removeAttribute(jc)}if((k==ab||k==Rb||Sys.Extended.UI.HTMLEditor.isHeader(j))&&c==K&&b)if(g.tryUnWrap(j,e,b))i=sb;if((k==ab||k==Rb||Sys.Extended.UI.HTMLEditor.isHeader(j))&&f&&h.toUpperCase()!=k){for(var t=g._doc.createElement(h),A=j.attributes,y=0;y<A.length;++y){var v=A.item(y);if(!v.specified)continue;if(v.name.toLowerCase()==gc)continue;t.setAttribute(v.name,v.value)}t.style.cssText=j.style.cssText;while(j.firstChild)t.appendChild(j.firstChild);j.parentNode.insertBefore(t,j);j.parentNode.removeChild(j)}}else if(!(c==K&&b)||f){if(o==pb){o=g._doc.createElement(f?h:g.dfltBlockElement);if(g.dfltBlockElement.toUpperCase()==Rb&&!f)o.style.margin=W;if(!f)o.style.textAlign=c;j.parentNode.insertBefore(o,j)}var F=s[s.length-1]==e[1]?s.length-1:s.length,G=s[0]==e[0]?1:0;if(k==uc&&l==F-1&&l==G)if(Sys.Extended.UI.HTMLEditor.isIE){o.appendChild(g._doc.createTextNode(String.fromCharCode(160)));j.parentNode.removeChild(j)}else o.appendChild(j);else if(k==uc&&l==F-1&&l>G&&(!f||j.nextSibling!=pb&&j.nextSibling==e[1]))j.parentNode.removeChild(j);else o.appendChild(j);if(k==uc&&l==s.length-1&&!f){m(o);o=pb}if(j==e[1]&&l==s.length-1){m(o);o=pb}}}}}for(var o=0;o<n.length;o++){var j=n[o];if(j.length>0){if(j[0].parentNode!=a){d.length>0&&p();d=[];a=j[0].parentNode}d.push(j)}}d.length>0&&p();k.setSelectionAfterOperation(e,i)};Sys.Extended.UI.HTMLEditor.MSIE_indent=function(o){var i=this,l=i.get_paragraphs(),e=i.getSelectionAfterOperation(l),a=pb,c=[],b=i,g=qb;function f(a){if(a.nodeType==1){var c=!b.rtlState()?a.style.marginLeft:a.style.marginRight;if(c.length>0)return parseInt(c)}return 0}function d(c,a){if(c.nodeType==1){if(c.tagName.toUpperCase()==Rb&&a==rb)a=W;if(!b.rtlState())c.style.marginLeft=a;else c.style.marginRight=a}}function j(a){if(o)d(a,f(a)+40+X);else if(a.tagName.toUpperCase()==Rb)if(f(a)>=40)d(a,f(a)-40+X);else d(a,W);else if(f(a)>40)d(a,f(a)-40+X);else d(a,rb)}function k(a){if(a!=pb)if(a.childNodes==1&&(a.firstChild==e[0]||a.firstChild==e[1])){a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)}}function n(){var E=a.firstChild,F=a.lastChild;if(a.tagName&&!Sys.Extended.UI.HTMLEditor.isInlineElement(a)&&c[0][0]==E&&c[c.length-1][c[c.length-1].length-1]==F){var i=rb;if(a.getAttribute(jc)&&a.getAttribute(jc).length>0)i=a.getAttribute(jc);if(a.align&&a.align.length>0)i=a.align;if(a.style.textAlign&&a.style.textAlign.length>0)i=a.style.textAlign;if(i.toLowerCase()==K&&!b.rtlState()||i.toLowerCase()==G&&b.rtlState())i=rb;a.align=rb;a.setAttribute(jc,rb);a.removeAttribute(jc);j(a);var v=a.tagName.toUpperCase();if((v==ab||v==Rb||Sys.Extended.UI.HTMLEditor.isHeader(a))&&i==rb){if(b.tryUnWrap(a,e))g=sb}else{if(i!=rb||v==sc&&a.parentNode.style.textAlign.length>0)a.style.textAlign=i;else a.style.textAlign=rb;if(v==sc){for(var q=a.parentNode,n=[],u=0;u<q.childNodes.length;u++)n.push(f(q.childNodes.item(u)));for(var r=1;r<n.length;r++)if(n[r-1]!=n[r])break;if(r==n.length){for(var D=n[0]==0?rb:n[0]+X,m=0;m<q.childNodes.length;m++)d(q.childNodes.item(m),rb);d(q,D)}}}}else for(var z=0;z<c.length;z++)for(var p=pb,s=c[z],m=0;m<s.length;m++){var h=s[m],l=h.nodeType==1&&h.tagName?h.tagName.toUpperCase():pb;if(l!=pb&&(l==Vc||l==Wc||l==pd||l==ab||Sys.Extended.UI.HTMLEditor.isHeader(h)||l==Rb||l==sc)){k(p);p=pb;j(h);if(l==Vc||l==Wc||l==pd){for(var x=0;x<h.childNodes.length;x++){var w=h.childNodes.item(x);if(w.nodeType==1){d(w,rb);for(var y=0;y<w.childNodes.length;y++){var t=w.childNodes.item(y),i=t.nodeType==1?h.style.textAlign:rb;if(i.toLowerCase()==K&&!b.rtlState()||i.toLowerCase()==G&&b.rtlState())i=rb;if(t.nodeType==1){d(t,rb);if(i==rb&&t.tagName){var B=t.tagName.toUpperCase();if(B==ab||B==Rb)if(b.tryUnWrap(t,e))g=sb}}}}}continue}else if(l==sc){for(var q=h.parentNode,n=[],u=0;u<q.childNodes.length;u++)n.push(f(q.childNodes.item(u)));for(var r=1;r<n.length;r++)if(n[r-1]!=n[r])break;if(r==n.length){for(var D=n[0]==0?rb:n[0]+X,m=0;m<q.childNodes.length;m++)d(q.childNodes.item(m),rb);d(q,D)}continue}var i=h.style.textAlign;if(i.toLowerCase()==K&&!b.rtlState()||i.toLowerCase()==G&&b.rtlState())i=rb;if((l==ab||l==Rb||Sys.Extended.UI.HTMLEditor.isHeader(h))&&i==rb)if(b.tryUnWrap(h,e))g=sb}else if(o){if(p==pb){p=b._doc.createElement(b.dfltBlockElement);if(b.dfltBlockElement.toUpperCase()==Rb)p.style.margin=W;j(p);h.parentNode.insertBefore(p,h)}var A=s[s.length-1]==e[1]?s.length-1:s.length,C=s[0]==e[0]?1:0;if(l==uc&&m==A-1&&m==C)if(Sys.Extended.UI.HTMLEditor.isIE){p.appendChild(b._doc.createTextNode(String.fromCharCode(160)));h.parentNode.removeChild(h)}else p.appendChild(h);else if(l==uc&&m==A-1&&m>C)h.parentNode.removeChild(h);else p.appendChild(h);if(l==uc&&m==s.length-1){k(p);p=pb}if(h==e[1]&&m==s.length-1){k(p);p=pb}}}}for(var m=0;m<l.length;m++){var h=l[m];if(h.length>0){if(h[0].parentNode!=a){c.length>0&&n();c=[];a=h[0].parentNode}c.push(h)}}c.length>0&&n();i.setSelectionAfterOperation(e,g)};Sys.Extended.UI.HTMLEditor.getSelectionAfterOperation=function(a){if(a.length==0)return [];var e=this._doc.createElement(Ac),d=this._doc.createElement(Ac),f=a[0][0],b=a[a.length-1][a[a.length-1].length-1];if(f==b&&b.nodeType==1&&b.childNodes.length==0&&Sys.Extended.UI.HTMLEditor.canHaveChildren(b)){b.appendChild(e);b.appendChild(d)}else{var g=Sys.Extended.UI.HTMLEditor._getReallyFirst(f);g.parentNode.insertBefore(e,g);if(g==f){var h=[];h.push(e);for(var i=0;i<a[0].length;i++)h.push(a[0][i]);a[0]=h}var c=Sys.Extended.UI.HTMLEditor._getReallyLast(b);if(c.nextSibling)c.parentNode.insertBefore(d,c.nextSibling);else c.parentNode.appendChild(d);c==b&&a[a.length-1].push(d)}return [e,d]};Sys.Extended.UI.HTMLEditor.setSelectionAfterOperation=function(l,o){var b=this;if(l.length==0)return;var c=l[0],a=l[1],f=b._getSelection(),e=pb,i=pb;if(Sys.Extended.UI.HTMLEditor.isIE){f.empty();f=b._getSelection();var g=b._createRange(f),k=b._createRange(f);try{if(c!=pb&&a!=pb&&c.nextSibling==a){e=b._doc.createTextNode(Pb);a.parentNode.insertBefore(e,a)}b._TcurrentFormat=pb;c!=pb&&g.moveToElementText(c);a!=pb&&k.moveToElementText(a);if(c!=pb&&a!=pb){g.setEndPoint(Hc,k);g.select();if(e!=pb){g.collapse(qb);g.select();e.parentNode.removeChild(e)}}else if(c!=pb)g.select();else a!=pb&&k.select()}catch(q){}}else try{var d,h=c.nextSibling,p=a.previousSibling;b._TcurrentFormat=pb;if(h==p&&h.nodeType==1&&h.tagName.toUpperCase()==uc){var n=Sys.Extended.UI.HTMLEditor.__getIndex(h);d=b._doc.createRange();d.setStart(h.parentNode,n);d.setEnd(h.parentNode,n)}else{e=b._doc.createTextNode(rb);i=b._doc.createTextNode(rb);c.parentNode.insertBefore(e,c);a.parentNode.insertBefore(i,a);d=b._doc.createRange();d.setStart(e,0);d.setEnd(i,0)}b._removeAllRanges(f);b._selectRange(f,d)}catch(q){}var m=Sys.Extended.UI.HTMLEditor._commonTotalParent(c==pb?a:c,a==pb?c:a),j=pb;if(m!=pb)j=m.parent;c!=pb&&c.parentNode.removeChild(c);a!=pb&&a.parentNode.removeChild(a);if(o&&j!=pb){Sys.Extended.UI.HTMLEditor.spanJoiner(j,b._doc);if(!Sys.Extended.UI.HTMLEditor.isIE&&e!=pb&&i!=pb){var d=b._doc.createRange();d.setStart(e,0);d.setEnd(i,0);b._removeAllRanges(f);b._selectRange(f,d)}}};Sys.Extended.UI.HTMLEditor.get_paragraphs=function(){var a=this;a._TcurrentFormat=pb;var b=a.getPseudoP();if(b.length==0)try{var e=Jc+Sys.Extended.UI.HTMLEditor.smartClassName+"_ll'></span><span id='"+Sys.Extended.UI.HTMLEditor.smartClassName+"_rr'></span><br>";a.insertHTML(e);var c=a._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName+"_ll"),d=a._doc.getElementById(Sys.Extended.UI.HTMLEditor.smartClassName+"_rr"),f=a._TcurrentFormat;a._TcurrentFormat=pb;a.setSelectionAfterOperation([c,d],qb);a._TcurrentFormat=f;b=a.getPseudoP()}catch(g){}return b};Sys.Extended.UI.HTMLEditor.getPseudoP=function(){var c=this,q=[];try{var k=c._getSelection(),i=c._createRange(k),o=Sys.Extended.UI.HTMLEditor.smartClassName+Fc,t=Sys.Extended.UI.HTMLEditor.smartClassName+Gc,g=pb,f=pb;if(Sys.Extended.UI.HTMLEditor.isIE){if(k.type.toLowerCase()!=wb){g=i.duplicate();f=i.duplicate();g.setEndPoint(Hc,i);f.setEndPoint(Ic,i)}}else{g=i.cloneRange();f=i.cloneRange();g.setEnd(g.startContainer,g.startOffset);f.setStart(f.endContainer,f.endOffset)}var a=pb,b=pb;if(Sys.Extended.UI.HTMLEditor.isIE&&k.type.toLowerCase()==wb){var m=i.item(0),h;h=c._doc.createElement(Ac);h.id=t;m.parentNode.insertBefore(h,m);h=c._doc.createElement(Ac);h.id=o;if(m.nextSibling==pb)m.parentNode.appendChild(h);else m.parentNode.insertBefore(h,m.nextSibling)}else{if(!c.insertHTML(Jc+o+Kc,f))return [];if(!c.insertHTML(Jc+t+Kc,g)){var v=c._doc.getElementById(o);if(v!=pb){n=v.parentNode;n.removeChild(v)}return []}}a=c._doc.getElementById(t);b=c._doc.getElementById(o);if(a!=pb&&b!=pb)while(a.nextSibling==pb)if(a.parentNode.nextSibling)a.parentNode.parentNode.insertBefore(a,a.parentNode.nextSibling);else a.parentNode.parentNode.appendChild(a);if(a!=pb&&b!=pb){while(b.previousSibling==pb)b.parentNode.parentNode.insertBefore(b,b.parentNode);if(b.previousSibling.nodeType==1){var x=b.previousSibling.tagName.toUpperCase();if(x!=uc&&x!=B){var r=Sys.Extended.UI.HTMLEditor._getReallyLast(b.previousSibling);if(r.nodeType==1&&Sys.Extended.UI.HTMLEditor.canHaveChildren(r))r.appendChild(b);else r.parentNode.appendChild(b)}}b.previousSibling&&b.previousSibling.nodeType==1&&b.previousSibling.tagName.toUpperCase()==uc&&b.parentNode.insertBefore(b,b.previousSibling)}if(a==pb){var e=c._doc.createElement(Ac);e.id=t;b.parentNode.insertBefore(e,b);a=e}if(b==pb){var e=c._doc.createElement(Ac);e.id=o;if(a.nextSibling)a.parentNode.insertBefore(e,a.nextSibling);else a.parentNode.appendChild(e);b=e}if(a!=pb&&b!=pb)if(a.parentNode==b)b.parentNode.insertBefore(a,b);else if(b.parentNode==a)if(a.nextSibling!=pb)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);while(a.nextSibling!=pb&&a.nextSibling.nodeType==3&&(rb+a.nextSibling.data+rb).length==0)a.parentNode.removeChild(a.nextSibling);if(c._TcurrentFormat==pb&&a!=pb&&b!=pb&&a.nextSibling==b){var j=b.parentNode;c._TcurrentFormat=pb;while(j&&j.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(j.tagName)){if(j.tagName.toUpperCase()!=Fb){var n=j.cloneNode(qb);if(c._TcurrentFormat==pb)c._TcurrentFormat=n;else{n.appendChild(c._TcurrentFormat);c._TcurrentFormat=n}}j=j.parentNode}if(c._TcurrentFormat){var z=c._doc.createElement(Hb);z.appendChild(c._TcurrentFormat);c._TcurrentFormat=z.innerHTML}}var d=a;while(d&&d.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(d.tagName)&&d.tagName.toUpperCase()!=Fb)d=d.parentNode;if(d!=pb&&d.tagName.toUpperCase()==Rb)if(d.firstChild!=pb)d.insertBefore(a,d.firstChild);else d.appendChild(a);else Sys.Extended.UI.HTMLEditor.positionInParagraph(a,a.previousSibling,sb,a.parentNode);d=b;while(d&&d.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(d.tagName)&&d.tagName.toUpperCase()!=Fb)d=d.parentNode;if(d!=pb&&d.tagName.toUpperCase()==Rb)d.appendChild(b);else Sys.Extended.UI.HTMLEditor.positionInParagraph(b,b.nextSibling,qb,b.parentNode);q=c.getPseudoP_Recur(a,b,0);var w=a.parentNode.tagName.toUpperCase();if(q.length==0&&a.previousSibling==pb&&b.nextSibling==pb&&a.nextSibling==b&&(w==Rb||llpTagName==ab||w==sc))q=[[a.parentNode]];if(Sys.Extended.UI.HTMLEditor.isIE){k.empty();k=c._getSelection();var p=c._createRange(k),u=c._createRange(k);try{a!=pb&&p.moveToElementText(a);b!=pb&&u.moveToElementText(b);if(a!=pb&&b!=pb){p.setEndPoint(Lb,u);p.select()}else if(a!=pb)p.select();else b!=pb&&u.select()}catch(B){}}a!=pb&&a.parentNode.removeChild(a);b!=pb&&b.parentNode.removeChild(b)}catch(B){for(var y=c._doc.getElementsByTagName(Ac),s=[],l=0;l<y.length;l++){var e=y[l];if(e.id&&e.id.length>0){var A=new RegExp(Sys.Extended.UI.HTMLEditor.smartClassName,Yb);A.test(e.id)&&s.push(e)}}for(var l=0;l<s.length;l++)s[l].parentNode.removeChild(s[l])}return q};Sys.Extended.UI.HTMLEditor.getPseudoP_Recur=function(t,o,s){var q=this,m=[],b=t,h=o.nextSibling!=pb&&o.nextSibling.tagName&&o.nextSibling.tagName.toUpperCase()==uc?o.nextSibling:o,j=pb;if(b==pb||h==pb){if(b!=pb)j=Sys.Extended.UI.HTMLEditor._commonTotalParent(b,b);if(h!=pb)j=Sys.Extended.UI.HTMLEditor._commonTotalParent(h,h)}else j=Sys.Extended.UI.HTMLEditor._commonTotalParent(b,h);if(j!=pb){b=Sys.Extended.UI.HTMLEditor.getContainer(j.parent.childNodes.item(j.indexFirst),b);h=Sys.Extended.UI.HTMLEditor.getContainer(j.parent.childNodes.item(j.indexLast),h);Sys.Extended.UI.HTMLEditor.unStyle(b);Sys.Extended.UI.HTMLEditor.unStyle(h);while(b.parentNode!=j.parent)b=b.parentNode;while(h.parentNode!=j.parent)h=h.parentNode;Sys.Extended.UI.HTMLEditor._moveTagsUp(b.nextSibling,h);j=pb;if(t==pb||o==pb){if(t!=pb)j=Sys.Extended.UI.HTMLEditor._commonTotalParent(t,t);if(o!=pb)j=Sys.Extended.UI.HTMLEditor._commonTotalParent(o,o)}else j=Sys.Extended.UI.HTMLEditor._commonTotalParent(t,o);j!=pb&&Sys.Extended.UI.HTMLEditor.spanJoiner(j.parent,q._doc,j.indexFirst,j.indexLast+1,sb);function P(a){if(!Sys.Extended.UI.HTMLEditor.isInlineElement(a))return sb;else if(a.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){var b=a.firstChild;while(b!=pb){nnnNext=b.nextSibling;var c=P(b);if(c)return sb;b=nnnNext}}return qb}var d=0,c=[],f=0;if(b.tagName&&h.tagName){var w=b.tagName.toUpperCase(),C=h.tagName.toUpperCase();if((w==Ob||w==Z)&&(C==Ob||C==Z)){while(b.tagName.toUpperCase()!=Nb)b=b.parentNode;h=b}else if((w=="DD"||w=="DT")&&(C=="DD"||C=="DT")){while(b.tagName&&b.tagName.toUpperCase()!=pd)b=b.parentNode;h=b}else if(w==sc&&C==sc){while(w!=Vc&&w!=Wc){b=b.parentNode;w=b.tagName?b.tagName.toUpperCase():pb}h=b}}var k=t?t:o,l=o?o:t,a=b;while(sb){if(!Sys.Extended.UI.HTMLEditor.isTempElement(a)){var T=P(a);if(!T){if(a.nodeType&&a.nodeType==3){var R=rb+a.data+rb;if(R.length==0||/^[\n\r]+$/.test(R)){var S=a.nextSibling;a.parentNode.removeChild(a);if(a==h)break;a=S;continue}}c[f]=a;f++}else if(a.tagName&&a.tagName.toUpperCase()==uc){c[f]=a;m[d]=c;d++;c=[];f=0}else if((a==h||a==b)&&!(a==h&&a==b?Sys.Extended.UI.HTMLEditor._reallyFirst(a,k)&&Sys.Extended.UI.HTMLEditor._reallyLast(a,l):Sys.Extended.UI.HTMLEditor._reallyFirst(a,k)||Sys.Extended.UI.HTMLEditor._reallyLast(a,l))){var D=a.tagName?a.tagName.toUpperCase():pb;if(D==Nb||D==sd){var r=a;while(r.tagName.toUpperCase()!=Nb)r=r.parentNode;for(var L=0,F=0,M=r.rows.item(r.rows.length-1).cells.length-1,G=r.rows.length-1,i=0;i<r.rows.length;i++)for(var Q=r.rows.item(i),x=0;x<Q.cells.length;x++){var p=Q.cells.item(x);if(Sys.Extended.UI.HTMLEditor._lookChild(p,k)>=0){L=x;F=i}if(Sys.Extended.UI.HTMLEditor._lookChild(p,l)>=0){M=x;G=i}}for(var i=F;i<=G;i++)for(var x=i==F?L:0;x<=(i==G?M:r.rows.item(i).cells.length-1);x++){var p=r.rows.item(i).cells.item(x);if(f>0){m[d]=c;d++;c=[];f=0}var y=Sys.Extended.UI.HTMLEditor._lookChild(p,k)>=0,z=Sys.Extended.UI.HTMLEditor._lookChild(p,l)>=0;if(y||z){var e=k,g=l,K=Sys.Extended.UI.HTMLEditor.smartClassName+V+s,J=Sys.Extended.UI.HTMLEditor.smartClassName+U+s;if(y){g=q._doc.createElement(Hb);g.id=K;p.appendChild(g)}if(z){e=q._doc.createElement(Hb);e.id=J;if(p.firstChild)p.insertBefore(e,p.firstChild);else p.appendChild(e)}for(var A=q.getPseudoP_Recur(e,g,s+1),u=0;u<A.length;u++){m[d]=A[u];d++}e!=k&&e.parentNode.removeChild(e);g!=l&&g.parentNode.removeChild(g)}else{for(var H=0,I=p.childNodes.length,v=H;v<I;v++){var B=p.childNodes.item(v);if(!Sys.Extended.UI.HTMLEditor.isTempElement(B)){c[f]=B;f++}}if(c.length>0){m[d]=c;d++;c=[];f=0}}}}else if(D==Vc||D==Wc||D==pd){for(var E=a,N=0,O=E.childNodes.length-1,i=0;i<E.childNodes.length;i++){var n=E.childNodes.item(i);if(n.nodeType==1){if(n==k||Sys.Extended.UI.HTMLEditor._lookChild(n,k)>=0)N=i;if(n==l||Sys.Extended.UI.HTMLEditor._lookChild(n,l)>=0)O=i}}for(var i=N;i<=O;i++){var n=E.childNodes.item(i);if(f>0){m[d]=c;d++;c=[];f=0}var y=Sys.Extended.UI.HTMLEditor._lookChild(n,k)>=0,z=Sys.Extended.UI.HTMLEditor._lookChild(n,l)>=0;if(y||z){var e=k,g=l,K=Sys.Extended.UI.HTMLEditor.smartClassName+V+s,J=Sys.Extended.UI.HTMLEditor.smartClassName+U+s;if(y){g=q._doc.createElement(Hb);g.id=K;n.appendChild(g)}if(z){e=q._doc.createElement(Hb);e.id=J;if(n.firstChild)n.insertBefore(e,n.firstChild);else n.appendChild(e)}for(var A=q.getPseudoP_Recur(e,g,s+1),u=0;u<A.length;u++){m[d]=A[u];d++}e!=k&&e.parentNode.removeChild(e);g!=l&&g.parentNode.removeChild(g)}else{for(var H=0,I=n.childNodes.length,v=H;v<I;v++){var B=n.childNodes.item(v);if(!Sys.Extended.UI.HTMLEditor.isTempElement(B)){c[f]=B;f++}}if(c.length>0){m[d]=c;d++;c=[];f=0}}}}else{var y=Sys.Extended.UI.HTMLEditor._lookChild(a,k)>=0,z=Sys.Extended.UI.HTMLEditor._lookChild(a,l)>=0;if(f>0){m[d]=c;d++;c=[];f=0}if(y||z){var e=k,g=l,K=Sys.Extended.UI.HTMLEditor.smartClassName+V+s,J=Sys.Extended.UI.HTMLEditor.smartClassName+U+s;if(y){g=q._doc.createElement(Hb);g.id=K;a.appendChild(g)}if(z){e=q._doc.createElement(Hb);e.id=J;if(a.firstChild)a.insertBefore(e,a.firstChild);else a.appendChild(e)}for(var A=q.getPseudoP_Recur(e,g,s+1),u=0;u<A.length;u++){m[d]=A[u];d++}e!=k&&e.parentNode.removeChild(e);g!=l&&g.parentNode.removeChild(g)}else{for(var H=0,I=a.childNodes.length,v=H;v<I;v++){var B=a.childNodes.item(v);if(!Sys.Extended.UI.HTMLEditor.isTempElement(B)){c[f]=B;f++}}if(c.length>0){m[d]=c;d++;c=[];f=0}}}}else{if(f>0){m[d]=c;d++;c=[];f=0}c[f]=a;m[d]=c;d++;c=[];f=0}}if(a==h)break;a=a.nextSibling}if(f>0)m[d]=c}return m};Sys.Extended.UI.HTMLEditor.unWrap=function(a,e){var d=this;if(a.firstChild){while(a.firstChild&&a.firstChild.nodeType==3&&rb+a.firstChild.data+rb==rb)a.removeChild(a.firstChild);var b=[];while(a.firstChild){a.firstChild!=e[0]&&a.firstChild!=e[1]&&b.push(a.firstChild);a.parentNode.insertBefore(a.firstChild,a)}if(b.length==0){var f=d._doc.createElement(uc);a.parentNode.insertBefore(f,a)}if(Sys.Extended.UI.HTMLEditor.isIE&&b.length==1&&b[0].nodeType==3){var g=rb+b[0].data+rb;if(g.length==1&&g.charCodeAt(0)==160){var f=d._doc.createElement(uc);b[0].parentNode.insertBefore(f,b[0]);b[0].parentNode.removeChild(b[0])}}while(a.nextSibling&&a.nextSibling.nodeType==3&&rb+a.nextSibling.data+rb==rb)a.parentNode.removeChild(a.nextSibling);var c=a.previousSibling&&e[1]==a.previousSibling?e[1].previousSibling:a.previousSibling;if(c&&Sys.Extended.UI.HTMLEditor.isInlineElement(c))if(c.nodeType==1&&c.childNodes.length>0)c=Sys.Extended.UI.HTMLEditor._getReallyLast(c);if(Sys.Extended.UI.HTMLEditor.isInlineElement(c)&&a.nextSibling!=pb){var f=d._doc.createElement(uc);a.parentNode.insertBefore(f,a)}}else{var f=d._doc.createElement(uc);a.parentNode.insertBefore(f,a)}a.parentNode.removeChild(a)};Sys.Extended.UI.HTMLEditor.tryUnWrap=function(b,l,e){var k=this;b.style.textAlign=rb;for(var g=0,h=b.attributes,f=0;f<h.length;++f){var i=h.item(f);if(!i.specified)continue;if(i.name.toLowerCase()==gc)continue;g++}var j=b.style.cssText,d=0,a,c=b.tagName.toUpperCase();if(!(typeof e!=tb&&e))if(c!=sc)try{a=parseInt(Sys.Extended.UI.HTMLEditor.getStyle(b,"margin-top"));if(isNaN(a))a=c==Rb?1:0;d+=a;a=parseInt(Sys.Extended.UI.HTMLEditor.getStyle(b,"margin-bottom"));if(isNaN(a))a=c==Rb?1:0;d+=a;a=parseInt(Sys.Extended.UI.HTMLEditor.getStyle(b,"margin-right"));if(isNaN(a))a=c==Rb?1:0;d+=a;a=parseInt(Sys.Extended.UI.HTMLEditor.getStyle(b,"margin-left"));if(isNaN(a))a=c==Rb?1:0;d+=a}catch(m){d=1}b.style.margin=rb;if(g==0&&b.style.cssText.length==0&&d==0||typeof e!=tb&&e&&c!=sc){k.unWrap(b,l);return sb}else{b.style.cssText=j;return qb}};Sys.Extended.UI.HTMLEditor._queryCommandValue=function(k,l){var d=this,e=d._rangeStartEnd();if(e==pb)return rb;try{if(k.toLowerCase()==Ab){var g=e.start;while(g){var h=Sys.Extended.UI.HTMLEditor.getStyle(g,gd).toLowerCase();if(h.length>0&&h!="transparent")return h;g=g.parentNode}return "#FFFFFF"}var c=u;switch(k.toLowerCase()){case Db:c=N;break;case p:c=q;break;case s:c=t}var b;if((c==t||c==q)&&d._FontNotSet){b=rb;var a=e.start;while(a!=pb){if(c==t){if(a.style&&a.style.fontSize&&a.style.fontSize.length>0){b=a.style.fontSize;break}else if(a.tagName&&a.tagName.toUpperCase()==td&&a.size&&a.size.length>0){b=Sys.Extended.UI.HTMLEditor.fontSizeSeek(a.size);break}}else if(a.style&&a.style.fontFamily&&a.style.fontFamily.length>0){b=a.style.fontFamily;break}else if(a.tagName&&a.tagName.toUpperCase()==td&&a.face&&a.face.length>0){b=a.face;break}if(a.className&&a.className.length>0){b=Sys.Extended.UI.HTMLEditor.getStyle(a,c).toLowerCase();if(c==t)if(!Sys.Extended.UI.HTMLEditor.isIE)b=Sys.Extended.UI.HTMLEditor._TryTransformFromPxToPt(b,d,l);break}var f=a.tagName.toUpperCase();if(f==Kb||f==Ob)break;a=a.parentNode}}else{b=Sys.Extended.UI.HTMLEditor.getStyle(e.start,c).toLowerCase();if(c==t)if(!Sys.Extended.UI.HTMLEditor.isIE){b=Sys.Extended.UI.HTMLEditor._TryTransformFromPxToPt(b,d,l);var a=e.start;while(a!=pb){if(a.style&&a.style.fontSize&&a.style.fontSize.length>0){b=a.style.fontSize;break}if(a.className&&a.className.length>0)break;var f=a.tagName.toUpperCase();if(f==Kb||f==Ob)break;a=a.parentNode}}}if(d._StyleForTyping!=pb&&d._StyleForTyping.length>0)for(var i=0;i<d._StyleForTyping.length;i++){var j=d._StyleForTyping[i];if(j.name==c){b=j.value;break}}return b}catch(m){return rb}};Sys.Extended.UI.HTMLEditor.Trim=function(a){return a.replace(/[\x00-\x1F]+/g,rb)};Sys.Extended.UI.HTMLEditor.TrimAll=function(a){return a.replace(/[\x00-\x1F]/g,rb).replace(/^[\x20]+/g,rb).replace(/[\x20]+$/g,rb)};Sys.Extended.UI.HTMLEditor.isIE=Sys.Browser.agent==Sys.Browser.InternetExplorer;Sys.Extended.UI.HTMLEditor.isSafari=Sys.Browser.agent==Sys.Browser.Safari;Sys.Extended.UI.HTMLEditor.isOpera=Sys.Browser.agent==Sys.Browser.Opera;Sys.Extended.UI.HTMLEditor.tryReplaceRgb=function(c){var a=c,e=/(rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\))/ig;function b(a){return a<16?ic+a.toString(16):a.toString(16)}function d(h,i,a,c,d){var g=parseInt(a),f=parseInt(c),e=parseInt(d);return "#"+b(g)+b(f)+b(e)}try{a=a.replace(e,d)}catch(f){}return a};Sys.Extended.UI.HTMLEditor.addFormOnSubmit=function(b){var a=window.theForm;if(window.theForm!=pb&&typeof window.theForm!=tb){if(a.HTMLEditor_editPanels==pb||typeof a.HTMLEditor_editPanels==tb){a.originalOnSubmit_HTMLEditor=window.theForm.onsubmit;a.HTMLEditor_editPanels=[];window.theForm.onsubmit=Sys.Extended.UI.HTMLEditor.EditPanelsOnSubmit;if(window.__doPostBack!=pb&&typeof window.__doPostBack!=tb)if(window.__doPostBack_HTMLEditor_original==pb||typeof window.__doPostBack_HTMLEditor_original==tb){window.__doPostBack_HTMLEditor_original=window.__doPostBack;window.__doPostBack=Sys.Extended.UI.HTMLEditor.EditPanelsOnPostBack}}a.HTMLEditor_editPanels.push(b)}};Sys.Extended.UI.HTMLEditor.removeFormOnSubmit=function(f){var a=window.theForm;if(window.theForm!=pb&&typeof window.theForm!=tb){var e=a.originalOnSubmit_HTMLEditor;if(a.HTMLEditor_editPanels!=pb&&typeof a.HTMLEditor_editPanels!=tb){for(var c=[],b=0;b<a.HTMLEditor_editPanels.length;b++){var d=a.HTMLEditor_editPanels[b];d!=f&&c.push(d)}a.HTMLEditor_editPanels=c;if(a.HTMLEditor_editPanels.length==0){window.theForm.onsubmit=e;a.originalOnSubmit_HTMLEditor=pb;a.HTMLEditor_editPanels=pb;if(window.__doPostBack_HTMLEditor_original!=pb&&typeof window.__doPostBack_HTMLEditor_original!=tb){window.__doPostBack=window.__doPostBack_HTMLEditor_original;window.__doPostBack_HTMLEditor_original=pb}}}}};Sys.Extended.UI.HTMLEditor.EditPanelsOnSubmit=function(c){for(var a=window.theForm,b=0;b<a.HTMLEditor_editPanels.length;b++){var d=a.HTMLEditor_editPanels[b](c);if(!d)return qb}if(a.originalOnSubmit_HTMLEditor!=pb&&typeof a.originalOnSubmit_HTMLEditor!=tb)return a.originalOnSubmit_HTMLEditor(c);return sb};Sys.Extended.UI.HTMLEditor.EditPanelsOnPostBack=function(d,c){for(var b=window.theForm,a=0;a<b.HTMLEditor_editPanels.length;a++){var e=b.HTMLEditor_editPanels[a](pb);if(!e)return qb}if(window.__doPostBack_HTMLEditor_original!=pb&&typeof window.__doPostBack_HTMLEditor_original!=tb)return window.__doPostBack_HTMLEditor_original(d,c);return sb};Sys.Extended.UI.HTMLEditor.getRealAttributeIE=function(e,f,g){var a="^(?:<[^>]*?",c=g,b=rb;function d(c,a){b=a}e.outerHTML.replace(new RegExp(a+f+'=")([^"]*?)"',Yb),d);b==rb&&e.outerHTML.replace(new RegExp(a+f+"=')([^']*?)'",Yb),d);b==rb&&e.outerHTML.replace(new RegExp(a+f+"=)([^s>]*?)",Yb),d);if(c!=b&&b!=rb){c=b;c=c.replace(/&amp;/g,jb)}return c};Sys.Extended.UI.HTMLEditor.getRealAttribute=function(d,b){var f=b.toLowerCase(),e=d.attributes,a=rb;for(i=0;i<e.length;++i){var c=e.item(i);if(!c.specified)continue;var b=c.name.toLowerCase();if(b==f){a=c.value;if(Sys.Extended.UI.HTMLEditor.isIE)a=Sys.Extended.UI.HTMLEditor.getRealAttributeIE(d,b,a);if(b==hc||b==A)a=a.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,rb);break}}return a};Sys.Extended.UI.HTMLEditor.enabledWordTags=["img",ud,"p","b","i","u","a","h1","h2","h3","h4","h5","h6","table","tbody","tr","td","ul","ol","li",Hb,Eb,vd,"xml","del","ins","em",fd,"sup","hr","br"];Sys.Extended.UI.HTMLEditor.cleanUp=function(e){var b,a=Sys.Extended.UI.HTMLEditor.Trim(e.replace(/[\x00-\x1F]+/g,Pb)).replace(/^[^\u0000]+?<html(?:[^>]*?)>/gi,rb).replace(/<\/html(?:[^>]*?)>[^\u0000]*$/gi,rb).replace(/<head(?:[^>]*?)>[^\u0000]*?<\/head(?:[^>]*?)>/gi,rb).replace(/<body[^>]*?>([^\u0000]*?)<\/body(?:[^>]*?)>/gi,w).replace(/<\/?html(?:[^>]*?)>/gi,rb).replace(/<\/?head(?:[^>]*?)>/gi,rb).replace(/<\/?body(?:[^>]*?)>/gi,rb).replace(/<!--(\w|\W)+?-->/ig,rb).replace(/(<[\/]?)(?:o|v|x|p|w|\?xml):(\w+)([^>]*?>)/ig,"$1$2$3").replace(/<(IMAGEDATA)([^>]*?)>/ig,"<img$2>").replace(/<p[^>]*><p>&nbsp;<\/p><\/p>/ig,"<br>").replace(/<p[^>]*?\/>/ig,rb).replace(/<(p|div)[^>]*?>&nbsp;<\/(\1)[^>]*?>/ig,rb).replace(/<(p|div)[^>]*?><\/(\1)[^>]*?>/ig,rb);do{b=a;a=a.replace(/<([^>]*)(?:class|size|lang|face|start|type|border|[ovwxp]:\w+)=(?:\'[^\']*\'|\"[^\"]*\"|[^> ]+)([^>]*)>/ig,"<$1$2>")}while(a!=b);var c=document.createElement(Eb);c.innerHTML=a;function d(j){var e="solid",c="black",b="1px";for(var o=j.childNodes.length,f=0;f<j.childNodes.length;f++){var a=j.childNodes.item(f);if(a.nodeType==1)if(a.tagName.indexOf(wd)>=0){f--;a.parentNode.removeChild(a)}else{for(var g=a.tagName.toLowerCase(),n=qb,p=Sys.Extended.UI.HTMLEditor.enabledWordTags.length,k=0;k<p;k++)if(Sys.Extended.UI.HTMLEditor.enabledWordTags[k]==g){n=sb;break}d(a);if(!n){f+=a.childNodes.length;while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);f--}else{var h=a.style.backgroundColor,i=a.style.color;a.style.cssText=rb;a.removeAttribute(gc);if(a.getAttribute(xd)&&a.getAttribute(xd).length>0)a.style.width=a.getAttribute(xd);if(a.width&&a.width.length>0)a.style.width=a.width;a.width=rb;try{a.removeAttribute(xd)}catch(r){}if(a.getAttribute(yd)&&a.getAttribute(yd).length>0)a.style.height=a.getAttribute(yd);if(a.height&&a.height.length>0)a.style.height=a.height;a.height=rb;try{a.removeAttribute(yd)}catch(r){}if(g=="table"){a.style.borderLeftWidth=b;a.style.borderLeftColor=c;a.style.borderLeftStyle=e;a.style.borderTopWidth=b;a.style.borderTopColor=c;a.style.borderTopStyle=e;a.style.backgroundColor=h;a.style.color=i}if(g=="td"){a.style.borderRightWidth=b;a.style.borderRightColor=c;a.style.borderRightStyle=e;a.style.borderBottomWidth=b;a.style.borderBottomColor=c;a.style.borderBottomStyle=e;a.style.backgroundColor=h;a.style.color=i}if(g==vd||g==Hb){a.style.backgroundColor=h;a.style.color=i;for(var m=a.attributes,o=0,l=0;l<m.length;++l){var q=m.item(l);if(!q.specified)continue;o++}if(o==0&&a.style.cssText==rb){f+=a.childNodes.length;while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);f--}}}}}}d(c);a=Sys.Extended.UI.HTMLEditor.Trim(c.innerHTML);delete c;a=a.replace(/<[\/]?(xml|del|ins)[^>]*?>/ig,rb).replace(/<(p|div)[^>]*?>/ig,rb).replace(/<\/(p|div)[^>]*?>/ig,"<br>");do{b=a;a=a.replace(/<b><\/b>/ig,rb).replace(/<i><\/i>/ig,rb).replace(/<u><\/u>/ig,rb).replace(/<strong><\/strong>/ig,rb).replace(/<em><\/em>/ig,rb).replace(/<sub><\/sub>/ig,rb).replace(/<sup><\/sup>/ig,rb);a=a.replace(/<span[^>]*?><\/span>/ig,rb).replace(/<span>([^<]+?)<\/span>/ig,w);a=a.replace(/<font[^>]*?><\/font>/ig,rb).replace(/<font>([^<]+?)<\/font>/ig,w)}while(a!=b);a=a.replace(/&rsquo;/g,"'").replace(/&lsquo;/g,"'").replace(/&ndash;/g,"-").replace(/&mdash;/g,"-").replace(/&hellip;/g,"...").replace(/&quot;/g,C).replace(/&ldquo;/g,C).replace(/&rdquo;/g,C).replace(//g,rb).replace(/&bull;/g,rb).replace(/[ \s]+/g,Pb).replace(/((&nbsp;)+)/g,Ib);if(document.all)a=a.replace(/^[\x00-\x1F]*&nbsp;/,rb);return a};Sys.Extended.UI.HTMLEditor.spanJoiner=function(i,o,k,l,n){var m=0,e=i.childNodes.length;if(typeof k!=tb&&k!=pb)m=k;if(typeof l!=tb&&l!=pb)e=l;for(var f=m;f<e;f++){var a=i.childNodes.item(f);switch(a.nodeType){case 1:if(a.childNodes.length==0&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!(a.className.length>0||a.getAttribute(M)&&a.getAttribute(M).length>0)&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){i.removeChild(a);f--;e--;continue}if(a.tagName.toUpperCase()==Ac){while(a.childNodes.length==1&&a.firstChild.nodeType==1){if(a.firstChild.tagName.toUpperCase()==Ac&&!Sys.Extended.UI.HTMLEditor.isTempElement(a.firstChild)){var g=Sys.Extended.UI.HTMLEditor.differAttr(a.firstChild,[]),d=Sys.Extended.UI.HTMLEditor.differStyle(a.firstChild),h=a.firstChild,s=h.childNodes;while(h.firstChild!=pb)a.insertBefore(h.firstChild,h);for(var b=0;b<d.length;b++)if(d[b][1])try{if(a.style[d[b][0]])if(d[b][0].toLowerCase().indexOf(N)>=0)a.style[d[b][0]]=d[b][1];else try{var q=a.style[d[b][0]];a.style[d[b][0]]=a.style[d[b][0]]+Pb+d[b][1];if(q==a.style[d[b][0]])a.style[d[b][0]]=d[b][1]}catch(t){a.style[d[b][0]]=d[b][1]}else a.style[d[b][0]]=d[b][1]}catch(t){}for(var b=0;b<g.length;b++)g[b][1]&&a.setAttribute(g[b][0],g[b][1]);a.removeChild(h);continue}else if(a.firstChild.tagName.toUpperCase()==Ac&&Sys.Extended.UI.HTMLEditor.isTempElement(a.firstChild)){var p=a.firstChild;a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);a=p}break}var j=[],c=a.nextSibling;while(!Sys.Extended.UI.HTMLEditor.isTempElement(a)&&c&&f+1<e&&(c.nodeType==3||c.nodeType==1&&(c.tagName.toUpperCase()==Ac||c.tagName.toUpperCase()==uc&&typeof n==tb)&&!Sys.Extended.UI.HTMLEditor.isTempElement(c)))if(c.nodeType==3)if((rb+c.data+rb).length==0){c.parentNode.removeChild(c);c=a.nextSibling;e--}else break;else if(c.tagName.toUpperCase()==uc){j.push(c);c=c.nextSibling}else{var g=Sys.Extended.UI.HTMLEditor.differAttr(a,[],c),d=Sys.Extended.UI.HTMLEditor.differStyle(a,c);if(g.length==0&&d.length==0&&a.className==c.className){for(var r=j.length,b=0;b<r;b++){a.appendChild(j[b]);e--}j=[];while(c.firstChild)a.appendChild(c.firstChild);c.parentNode.removeChild(c);c=a.nextSibling;e--}else break}if(!Sys.Extended.UI.HTMLEditor.isTempElement(a)&&a.className.length==0){var g=Sys.Extended.UI.HTMLEditor.differAttr(a,[]),d=Sys.Extended.UI.HTMLEditor.differStyle(a);if(g.length==0&&d.length==0){f--;e--;while(a.firstChild){a.parentNode.insertBefore(a.firstChild,a);e++}a.parentNode.removeChild(a);continue}}}if(a.parentNode!=pb)if(a.childNodes.length==0&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!(a.className.length>0||a.getAttribute(M)&&a.getAttribute(M).length>0)&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){i.removeChild(a);f--;e--;continue}else Sys.Extended.UI.HTMLEditor.spanJoiner(a,o)}}};Sys.Extended.UI.HTMLEditor._styleTags=[ud,"em","u","strike","s",Hb,vd,"b",fd,"sup","a","i"];Sys.Extended.UI.HTMLEditor.isStyleTag=function(b){if(!b)return qb;for(var a=0;a<Sys.Extended.UI.HTMLEditor._styleTags.length;a++)if(Sys.Extended.UI.HTMLEditor._styleTags[a].toLowerCase()==b.toLowerCase())return sb;return qb};Sys.Extended.UI.HTMLEditor.smartClassName="MSIEparagraph";Sys.Extended.UI.HTMLEditor.noContextMenuAttribute="obout-no-contextmenu";Sys.Extended.UI.HTMLEditor.isTempElement=function(a){if(a.id&&a.id.length>0&&a.id.indexOf(Sys.Extended.UI.HTMLEditor.smartClassName)>=0)return sb;return qb};Sys.Extended.UI.HTMLEditor.differAttr=function(c,j,h){var d=[],b=c.parentNode;if(typeof h!=tb)b=h;if(!b||!b.tagName||!Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName))b=pb;if(c.attributes)for(var f=0;f<c.attributes.length;f++){for(var a=c.attributes[f],i=qb,g=0;g<j.length;g++)if(a.name.toUpperCase()==j[g].toUpperCase()){i=sb;break}if(i)continue;if(a.name.toUpperCase()=="STYLE")continue;if(a.name.toUpperCase().substr(0,4)=="_MOZ")continue;if(a.specified)if(b&&b.attributes&&b.attributes[a.name]){var e=b.attributes[a.name];if(e)(a.name!=e.name||a.value!=e.value)&&d.push([a.name,a.value])}else{if(a.name.toUpperCase()=="CLASS"&&a.value==rb)continue;d.push([a.name,a.value])}}return d};Sys.Extended.UI.HTMLEditor.differStyle=function(h,k){var g="length",f="csstext",c="accelerator",j=[],e=h.parentNode;if(typeof k!=tb)e=k;if(!e||!e.tagName||!Sys.Extended.UI.HTMLEditor.isStyleTag(e.tagName))e=pb;function i(b,a){a=rb+a;if(b.toLowerCase()=="textdecoration")for(var d=a.split(Pb),c=0;c<d.length;c++)j.push([b,Sys.Extended.UI.HTMLEditor.Trim(d[c])]);else j.push([b,a])}for(var b in h.style)if(b&&typeof b==Uc&&b!=c){var a=b;if(!isNaN(parseInt(b))){if(!Sys.Extended.UI.HTMLEditor.isSafari)continue;a=h.style[b]}var d=h.style[a];if(d&&typeof d==Uc&&d!=c)if(e&&e.style){var l=e.style[a];if(a.toLowerCase()!=f&&a.toLowerCase()!=g)d!=l&&i(a,d)}else a.toLowerCase()!=f&&a.toLowerCase()!=g&&i(a,d)}if(typeof k!=tb)for(var b in e.style)if(b&&typeof b==Uc&&b!=c){var a=b;if(!isNaN(parseInt(b))){if(!Sys.Extended.UI.HTMLEditor.isSafari)continue;a=h.style[b]}var d=e.style[a];if(d&&typeof d==Uc&&d!=c){var l=h.style[a];if(b.toLowerCase()!=f&&a.toLowerCase()!=g)d!=l&&i(a,d)}}return j};Sys.Extended.UI.HTMLEditor.brXHTML=function(a){return a.replace(/<br>/ig,rc)};Sys.Extended.UI.HTMLEditor._needsClosingTag=function(b){var a=" script style div span a del strong em u strike font b sub sup p iframe li ul ol placeholder textarea td tr ";return a.indexOf(Pb+b.tagName.toLowerCase()+Pb)!=E};Sys.Extended.UI.HTMLEditor._encodeText_=function(a){return a.replace(/&/ig,Dc).replace(/</ig,wc).replace(/>/ig,xc).replace(/\"/ig,zd).replace(/\xA0/ig,Ib)};Sys.Extended.UI.HTMLEditor._noNeedsClosingTag=function(b){var a=" hr br ";return a.indexOf(Pb+b.tagName.toLowerCase()+Pb)!=E};Sys.Extended.UI.HTMLEditor.canBeInsideP=function(b,d){if(b&&b.style&&b.style.display&&b.style.display.toLowerCase()==vc)return sb;var c=b.tagName.toUpperCase();if(c.length==2)if(c.substr(0,1)==L&&parseInt(c.substr(1,1))>0)return qb;switch(c){case sd:case Z:case Ob:if(typeof d!=tb){var a=b.parentNode;while(a&&a.tagName&&a.tagName.toUpperCase()!=Nb)a=a.parentNode;if(a.tagName.toUpperCase()==Nb&&a.style&&a.style.display&&a.style.display.toLowerCase()==vc)return sb}case Rb:case "PRE":case Nb:case Wc:case Vc:case sc:case "HR":case ab:case Ad:case Bd:case qd:case rd:return qb;default:return sb}};Sys.Extended.UI.HTMLEditor.convertAlign=function(b){var a,c;try{c=parseInt(b)-1}catch(d){return b}switch(c){case 1:a=K;break;case 2:a=G;break;case 3:a="texttop";break;case 4:a="absmiddle";break;case 5:a="baseline";break;case 6:a="absbottom";break;case 7:a="bottom";break;case 8:a="middle";break;case 9:a="top";break;default:a=b.replace(/\"/g,zd)}return a};Sys.Extended.UI.HTMLEditor.getHTML=function(a,b,d){try{if(typeof d==tb)if(!b&&a.nodeType==1)return a.innerHTML;else if(b&&a.nodeType==1&&Sys.Extended.UI.HTMLEditor.isIE)return a.outerHTML}catch(e){}var c=new Sys.Extended.UI.HTMLEditor.jsDocument(sb);Sys.Extended.UI.HTMLEditor._getHTML_(c,a,b);return c.toString()};Sys.Extended.UI.HTMLEditor._getHTML_=function(c,a,q){switch(a.nodeType){case 1:case 11:if(a.tagName&&a.tagName.indexOf(wd)>=0){if(Sys.Extended.UI.HTMLEditor.isIE){var e=a.tagName.toLowerCase().substr(a.tagName.indexOf(wd)+1),k=a.previousSibling;if(e==ac)return;while(k!=pb){if(k.nodeType==a.nodeType&&k.tagName&&k.tagName.toLowerCase()==e){c.append("</teo"+Sys.Extended.UI.HTMLEditor.smartClassName+":"+a.tagName.toLowerCase().substr(a.tagName.indexOf(wd)+1)+Ec);return}k=k.previousSibling}}return}var h,n,f;if(q&&a.tagName.length>0){var e=a.tagName.toLowerCase();h=!(a.hasChildNodes()||Sys.Extended.UI.HTMLEditor._needsClosingTag(a));n=sb;var p=rb;if(Sys.Extended.UI.HTMLEditor.isIE&&a.scopeName&&typeof a.scopeName!=tb)p=a.scopeName.toUpperCase()==md?rb:a.scopeName+":";if(Sys.Extended.UI.HTMLEditor.isIE&&(h||e==Cd)&&!Sys.Extended.UI.HTMLEditor._noNeedsClosingTag(a)&&e!=ac){var j=a.nextSibling;while(j!=pb){if(j.nodeType==a.nodeType&&j.tagName){var o=j.tagName;if(o.indexOf(wd)>=0)if(o.toLowerCase().substr(o.indexOf(wd)+1)==e){h=qb;n=qb;break}}j=j.nextSibling}}!Sys.Extended.UI.HTMLEditor.canBeInsideP(a)&&c.append(od);c.append(kc+(!h&&!n?"teo"+Sys.Extended.UI.HTMLEditor.smartClassName+":":p)+e);Sys.Extended.UI.HTMLEditor.isIE&&a.name&&a.name.length>0&&c.append(' name="'+a.name.replace(/\"/g,zd)+C);Sys.Extended.UI.HTMLEditor.isIE&&a.value&&a.value.length>0&&e!=Nc&&c.append(' value="'+a.value.replace(/\"/g,zd)+C);Sys.Extended.UI.HTMLEditor.isIE&&a.className&&a.className.length>0&&c.append(' class="'+a.className.replace(/\"/g,zd)+C);Sys.Extended.UI.HTMLEditor.isIE&&a.align&&a.align.length>0&&c.append(' align="'+a.align.replace(/\"/g,zd)+C);Sys.Extended.UI.HTMLEditor.isIE&&a.color&&a.color.length>0&&c.append(' color="'+a.color.replace(/\"/g,zd)+C);Sys.Extended.UI.HTMLEditor.isIE&&a.size&&a.size.length>0&&c.append(' size="'+a.size.replace(/\"/g,zd)+C);var r=a.attributes,m=pb;for(f=0;f<r.length;++f){var l=r.item(f);if(!l.specified)continue;var d=l.name.toLowerCase();if(d.substr(0,4)=="_moz")continue;if(d=="teoalign")continue;var b;if(d!=gc)if(d==xd){b=a.width;if(Sys.Extended.UI.HTMLEditor.isIE&&b==0){var g=0;a.outerHTML.replace(new RegExp("^(?:<[^>]*?width=)([\\d]+)",Yb),function(b,a){g=a});if(b!=g)b=g}}else if(d==yd){b=a.height;if(Sys.Extended.UI.HTMLEditor.isIE&&b==0){var g=0;a.outerHTML.replace(new RegExp("^(?:<[^>]*?height=)([\\d]+)",Yb),function(b,a){g=a});if(b!=g)b=g}}else if(Sys.Extended.UI.HTMLEditor.isIE&&d==Dd&&a.name&&a.name.length>0)continue;else if(Sys.Extended.UI.HTMLEditor.isIE&&d=="value"&&a.value&&a.value.length>0)continue;else if(Sys.Extended.UI.HTMLEditor.isIE&&d==jc&&a.align&&a.align.length>0)continue;else if(Sys.Extended.UI.HTMLEditor.isIE&&d==M&&a.className&&a.className.length>0)continue;else if(Sys.Extended.UI.HTMLEditor.isIE&&d==N&&a.color&&a.color.length>0)continue;else if(Sys.Extended.UI.HTMLEditor.isIE&&d==P&&a.size&&a.size.length>0)continue;else if(e==ac&&d==jc&&Sys.Extended.UI.HTMLEditor.isIE)b=Sys.Extended.UI.HTMLEditor.convertAlign(l.value);else{b=l.value;if(Sys.Extended.UI.HTMLEditor.isSafari&&d==M)if(/apple-style/ig.test(b))continue;if(d==hc||d==A){if(Sys.Extended.UI.HTMLEditor.isIE)b=Sys.Extended.UI.HTMLEditor.getRealAttributeIE(a,d,b);b=b.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,rb)}b=b.replace(/\"/g,zd)}else{if(Sys.Extended.UI.HTMLEditor.isSafari)m=l.value;continue}var i=C;if((rb+b+rb).indexOf(C)>=0)i="'";d!=pb&&c.append(Pb+d+"="+i+b+i)}if(a.style.cssText.length>0||m!=pb){var d=gc,u=/(url\((?:[^\)]*)\))/ig,t=[];function x(b,a){t.push(a)}var b=(m!=pb?m:a.style.cssText).toLowerCase();b.replace(u,x);var s=0;function y(){var a=t[s];s++;return a}b=Sys.Extended.UI.HTMLEditor.tryReplaceRgb(b.replace(u,y)).replace(/(font-weight\s*:\s*)(700)/ig,"$1bold").replace(/([\s]*-moz-[^;]*[;][\s]*)/ig,rb).replace(/(-moz-.*)$/i,rb).replace(/(background-position: 0% 0%[;]*[\s]*)/ig,rb);if(Sys.Extended.UI.HTMLEditor.isSafari){function w(d,a,b,c){return a+b.replace(/(,)/g,rb)+c}b=b.replace(/(text-decoration:)([^;$]+)([;$])/ig,w)}if(Sys.Extended.UI.HTMLEditor.isSafari||Sys.Extended.UI.HTMLEditor.isOpera){function v(d,a,b,c){return a+b.replace(/(['"])/g,rb)+c}b=b.replace(/(font-family:)([^;]+)([;]*)/ig,v)}if(b.length>0){var i=C;if((rb+b+rb).indexOf(C)>=0)i="'";c.append(Pb+d+"="+i+b+i)}}c.append(h?" />":Ec);e=="br"&&c.append(od)}a.tagName&&a.tagName.toUpperCase()==tc&&c.append(a.text);if(a.tagName&&a.tagName.toUpperCase()=="STYLE")c.append(a.innerHTML);else for(f=a.firstChild;f;f=f.nextSibling)Sys.Extended.UI.HTMLEditor._getHTML_(c,f,sb);q&&a.tagName.length>0&&!h&&n&&c.append("</"+p+a.tagName.toLowerCase()+Ec);break;case 3:c.append(Sys.Extended.UI.HTMLEditor._encodeText_(rb+a.data+rb));break;case 8:if(a.length>0)c.append("<!--"+a.data+"-->");else c.append("<!---->")}};Sys.Extended.UI.HTMLEditor.RemoveContextMenu=function(){var a=this,b=a._contextElement.parentNode.removeChild(a._contextElement);if(b)delete b;a._contextElement=pb;a._contextTable=pb;if(a.__saved_range__){a.__saved_range__.select();a.__saved_range__=pb}};Sys.Extended.UI.HTMLEditor.contentEditable=function(a,d){while(a!=pb){try{var b=pb;if(a.contentEditable!=pb&&typeof a.contentEditable!=tb&&!(Sys.Extended.UI.HTMLEditor.isSafari||Sys.Extended.UI.HTMLEditor.isOpera))if(!a.contentEditable||a.contentEditable==nd)b=qb;else b=sb;else{var c=a.getAttribute("contenteditable");if(typeof c=="boolean")b=c;else if(typeof c==Uc&&c.toLowerCase()==nd)b=qb}if(b!=pb&&typeof b=="boolean")if(!b)return a}catch(e){}if(typeof d!=tb&&d)return pb;if(a.tagName!=pb&&typeof a.tagName!=tb&&(a.tagName.toUpperCase()==Kb||a.tagName.toUpperCase()==md))break;a=a.parentNode}return pb};Sys.Extended.UI.HTMLEditor.getSelParent=function(c){var d=c._getSelection(),b=c._createRange(d),a=pb;if(Sys.Extended.UI.HTMLEditor.isIE)if(d.type.toLowerCase()==wb)a=b.item(0);else a=c._getParent(b);else{a=c._getParent(b);if(a.nodeType!=3&&b.startContainer==b.endContainer){var e=a;a=a.childNodes.item(b.startOffset);if(a==pb)a=e}}return a};Sys.Extended.UI.HTMLEditor.__getIndex=function(b){var a=0;if(b.parentNode)for(;a<b.parentNode.childNodes.length;a++)if(b.parentNode.childNodes.item(a)==b)break;return a};Sys.Extended.UI.HTMLEditor.isInlineElement=function(a){if(a.nodeType==3)return sb;if(a.nodeType!=1)return qb;if(!a.tagName||a.tagName.length==0)return qb;if(a&&a.style&&a.style.display&&a.style.display.toLowerCase()==vc)return sb;var b=a.tagName.toUpperCase();if(b.length==2)if(b.substr(0,1)==L&&parseInt(b.substr(1,1))>0)return qb;switch(b){case uc:case sd:case Z:case Ob:case Rb:case "PRE":case Nb:case Wc:case Vc:case sc:case "HR":case ab:case Ad:case Bd:case qd:case rd:return qb;default:return sb}};Sys.Extended.UI.HTMLEditor.capLock=function(b){var a=b.charCode,c=b.shiftKey?b.shiftKey:a==16?sb:qb;if(a>=65&&a<=90&&!c||a>=97&&a<=122&&c)return sb;else return qb};Sys.Extended.UI.HTMLEditor.operateAnchors=function(e,i,k){for(var h=i.getElementsByTagName(Fb),j=qb,f=0;f<h.length;f++){var a=h[f];if(a.name&&a.name.length>0){for(var d=[],g=0;g<a.childNodes.length;g++){var b=a.childNodes.item(g);if(b.nodeType==1&&b.tagName&&b.tagName.toUpperCase()==B&&b.src==e._editPanel.get_imagePath_anchor()){d.push(b);j=sb}}while(d.length>0)a.removeChild(d.pop());if(!k){var c=i.createElement(B);c.title=a.name;c.src=e._editPanel.get_imagePath_anchor();c.setAttribute(e.noContextMenuAttributeName(),"yes");a.appendChild(c)}}}return j};Sys.Extended.UI.HTMLEditor.operatePlaceHolders=function(n,i,o){var c="PLACEHOLDER",l=qb;if(o){for(var h=i.getElementsByTagName(B),d=[],b=0;b<h.length;b++)d.push(h[b]);for(var b=0;b<d.length;b++){var a=d[b],j=a.getAttribute(Zb);if(j&&j.length>0&&j.toLowerCase()==Cd){var k=i.createElement(c),e=a.title;if(e==pb||typeof e==tb)e=a.getAttribute(y);k.name=e;k.setAttribute(Dd,e);a.parentNode.insertBefore(k,a);a.parentNode.removeChild(a);l=sb}}}else{for(var h=i.getElementsByTagName(c),d=[],b=0;b<h.length;b++)d.push(h[b]);for(var b=0;b<d.length;b++){var a=d[b],m=sb;try{if(a.childNodes.length>0)m=qb}catch(p){}if(m){var f=a.name;if(f==pb||typeof f==tb)f=a.getAttribute(Dd);var g=i.createElement(B);g.title=f;g.src=n._editPanel.get_imagePath_placeHolder();g.setAttribute(Zb,Cd);g.setAttribute(y,f);a.parentNode.insertBefore(g,a);a.parentNode.removeChild(a)}}}return l};Sys.Extended.UI.HTMLEditor.inspectForShadows=function(c){for(var b=c.getElementsByTagName(B),a=0;a<b.length;a++)if(b[a].getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute)&&b[a].getAttribute(Sys.Extended.UI.HTMLEditor.attachedIdAttribute).length>0){try{if(Sys.Extended.UI.HTMLEditor.isIE)$removeHandler(b[a],mb,Sys.Extended.UI.HTMLEditor.stopDrag);else $removeHandler(b[a],nb,Sys.Extended.UI.HTMLEditor.stopDrag)}catch(d){}if(Sys.Extended.UI.HTMLEditor.isIE)$addHandler(b[a],mb,Sys.Extended.UI.HTMLEditor.stopDrag);else $addHandler(b[a],nb,Sys.Extended.UI.HTMLEditor.stopDrag)}};Sys.Extended.UI.HTMLEditor.attachedIdAttribute="obout-attached-id";Sys.Extended.UI.HTMLEditor.stopDrag=function(a){a&&a.stopPropagation();a.preventDefault();return qb};Sys.Extended.UI.HTMLEditor.replacingRules=[[ud,ad,Bb],["b",ad,Bb],[ud,ad,hd],["em",bd,Jb],["i",bd,Jb],["u",cd,Mb],["strike",cd,dd]];Sys.Extended.UI.HTMLEditor.replaceOldTags=function(d,h){var c="cssText";for(var k=d.innerHTML,l=qb,e=0;e<Sys.Extended.UI.HTMLEditor.replacingRules.length;e++){var n=new RegExp(kc+Sys.Extended.UI.HTMLEditor.replacingRules[e][0]+"[s>]",Yb);if(n.test(k)){l=sb;break}}if(!l)if(!/<font[\s>]/ig.test(k))return;for(var i=0;i<d.childNodes.length;i++){var a=d.childNodes.item(i);if(a.nodeType==1){for(var f=pb,j=a.tagName.toLowerCase(),e=0;e<Sys.Extended.UI.HTMLEditor.replacingRules.length;e++)if(Sys.Extended.UI.HTMLEditor.replacingRules[e][0].toLowerCase()==j){f=Sys.Extended.UI.HTMLEditor.replacingRules[e];break}if(f){var b=h._doc.createElement(Ac);b.style[c]=a.style[c];if(Sys.Extended.UI.HTMLEditor.isIE)b.style[f[1]]=f[2];else b.style[f[1].replace(/\-(\w)/g,function(b,a){return a.toUpperCase()})]=f[2];while(a.firstChild)b.appendChild(a.firstChild);d.insertBefore(b,a);d.removeChild(a);a=b}else if(j==vd){var b=h._doc.createElement(Ac),m=a.size;b.style[c]=a.style[c];if(a.color)b.style.color=a.color;if(a.face)b.style.fontFamily=a.face;while(a.firstChild)b.appendChild(a.firstChild);d.insertBefore(b,a);d.removeChild(a);if(m){var g=h._doc.createElement(td);g.size=m;d.insertBefore(g,b);if(b.style[c].length>0){g.appendChild(b);a=b}else{while(b.firstChild)g.appendChild(b.firstChild);d.removeChild(b);a=g}}else a=b}Sys.Extended.UI.HTMLEditor.replaceOldTags(a,h)}}};Sys.Extended.UI.HTMLEditor.getStyle=function(a,b){var c=rb;if(a.nodeType==1)if(a.ownerDocument&&a.ownerDocument.defaultView&&a.ownerDocument.defaultView.getComputedStyle)c=a.ownerDocument.defaultView.getComputedStyle(a,rb).getPropertyValue(b);else if(a.currentStyle)try{b=b.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()});c=a.currentStyle[b]}catch(d){c=a.style[b]}else c=a.style[b];return c};Sys.Extended.UI.HTMLEditor._Marker=function(c,d,f){var b=this;if(Sys.Extended.UI.HTMLEditor.isIE){b._nArr=Sys.Extended.UI.HTMLEditor.getNames(c._doc.body);b._save=c._doc.body.innerHTML;b._tree=pb;if(f.type.toLowerCase()==wb)try{var a=d.item(0);b._tree=[];while(a&&(a.nodeType==3||!a.tagName||a.tagName.toUpperCase()!=Kb)){var e=0;while(a.previousSibling){e++;a=a.previousSibling}b._tree.push(e);a=a.parentNode}}catch(g){}else{b._offsetLeft=d.offsetLeft;b._offsetTop=d.offsetTop}}else{if(Sys.Extended.UI.HTMLEditor.isOpera)b._save=Sys.Extended.UI.HTMLEditor.Trim(c._doc.body.innerHTML);else b._save=c._doc.body.cloneNode(sb);b._tree=[];b._offset=0;try{var a=d.startContainer;b._offset=d.startOffset;if(a&&a.nodeType==1&&a.tagName.toUpperCase()==md){a=c._doc.body;setTimeout(function(){try{f=c._getSelection();d=c._createRange();c._removeAllRanges(f);d.setStart(a,0);d.setEnd(a,0);c._selectRange(f,d)}catch(b){}},0)}while(a&&a.nodeType&&(a.nodeType==3||!a.tagName||a.tagName.toUpperCase()!=Kb)){var e=0;while(a.previousSibling){e++;if(Sys.Extended.UI.HTMLEditor.isOpera)if(a.nodeType==3&&a.previousSibling!=pb&&a.previousSibling.nodeType==3)e--;a=a.previousSibling}b._tree.push(e);a=a.parentNode}}catch(g){}}};Sys.Extended.UI.HTMLEditor.__stackMaxSize=30;Sys.Extended.UI.HTMLEditor.getNames=function(i){for(var e=i.all,g=[],h=[],d=0;d<e.length;d++){var a=e[d];if(a.name&&a.name.length>0){for(var b=a.tagName,f=i.getElementsByTagName(b),j=0,c=0;c<f.length;c++)if(f[c]==a){j=c;break}h[b]=j;g.push([b,h[b],a.name])}}return g};Sys.Extended.UI.HTMLEditor.setNames=function(c,b){for(var a=0;a<b.length;a++)if(c.getElementsByTagName(b[a][0]).length>b[a][1])c.getElementsByTagName(b[a][0])[b[a][1]].name=b[a][2]};Sys.Extended.UI.HTMLEditor._lookChild=function(c,d){for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes.item(a);if(b==d)return a;if(b.nodeType==1)if(Sys.Extended.UI.HTMLEditor._lookChild(b,d)>=0)return a}return E};Sys.Extended.UI.HTMLEditor.getHrefsText=function(d){var a=[];function b(g,e,h,i,j,f){for(var d=e.replace(/^<([^\s>]+)/,w),c=sb,b=0;b<a.length;b++)if(a[b][0]==d){c=qb;break}if(c)a[b]=[d];a[b].push(f)}var c=new RegExp("(<[^\\s><]+)([^><]*?)(href=)(\"|')([^\\4]*?)(\\4)((?:[^><]*?)>)",Yb);d.replace(c,b);return a};Sys.Extended.UI.HTMLEditor.setHrefsText=function(f,b){for(var a=0;a<b.length;a++)for(var e=f.getElementsByTagName(b[a][0]),d=1,c=0;c<e.length;c++){if(!e[c].href)continue;if(b[a][d]&&b[a][d].length>0)e[c].href=b[a][d].replace(/&amp;/ig,jb);d++}};Sys.Extended.UI.HTMLEditor.getImagesText=function(c){var a=[];function b(b,d,e,c){a.push(c);return b}c.replace(/(<img(?:.*?))(src=")(.*?)(")((?:.*?)>)/ig,b);return a};Sys.Extended.UI.HTMLEditor.setImagesText=function(e,d){for(var c=e.getElementsByTagName(B),b=0,a=0;a<c.length;a++){if(!c[a].src)continue;if(d[b]&&d[b].length>0)c[a].src=d[b].replace(/&amp;/ig,jb);b++}};Sys.Extended.UI.HTMLEditor.canHaveChildren=function(a){if(Sys.Extended.UI.HTMLEditor.isIE)return a.canHaveChildren;else return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(a.tagName.toLowerCase())};Sys.Extended.UI.HTMLEditor._setCursor=function(j,a){var c=j;if(Sys.Extended.UI.HTMLEditor.isIE){var e=a._getSelection(),b=a._createRange(e);if(e.type.toLowerCase()==wb){b.remove(0);e.empty();b=a._createRange()}var g=c.nodeType==3,d;if(g){d=a._doc.createElement(Ac);d.innerHTML=Ib;c.parentNode.insertBefore(d,c);c=d}var f=$common.getLocation(c),h=f.x,i=f.y;g&&d.parentNode.removeChild(d);try{b.moveToPoint(h,i)}catch(k){}b.select()}else{var e=a._getSelection(),b=a._createRange();b.setStart(c,0);b.setEnd(c,0);a._removeAllRanges(e);a._selectRange(e,b);a.focusEditor()}};Sys.Extended.UI.HTMLEditor.myClone=function(a,e,d){var b;if(Sys.Extended.UI.HTMLEditor.isIE&&a.tagName&&(a.tagName.toUpperCase()==Gb||a.tagName.toUpperCase()=="OBJECT")){var c=e.createElement(ab);try{c.innerHTML=a.outerHTML;b=c.firstChild}catch(f){b=a}delete c}else b=a.cloneNode(d);return b};Sys.Extended.UI.HTMLEditor.unStyle=function(a){var b=a.parentNode!=pb&&typeof a.parentNode!=tb?a.parentNode:pb;if(b){var c=pb;while(b&&b.tagName&&b.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)&&b.tagName.toUpperCase()!=Fb){c=b;b=b.parentNode}if(c){function h(e,b,f,g,i){var a=f.cloneNode(qb);if(e)if(e.push&&typeof e.push==xb)for(var k=0;k<e.length;k++)a.appendChild(e[k]);else a.appendChild(e);if(i)a.appendChild(b);else while(b){var n=g?b.previousSibling:b.nextSibling;if(b.nodeType==1||b.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(rb+b.data+rb).length>0){if(b.nodeType==1)if(b.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)&&b.childNodes.length==0&&!Sys.Extended.UI.HTMLEditor.isTempElement(b))b=pb;if(b)if(a.childNodes.length==0||!g)a.appendChild(b);else a.insertBefore(b,a.firstChild)}b=n}if(a.childNodes.length==0){delete a;a=pb}else if(a.childNodes.length==1&&a.firstChild.nodeType==3&&(rb+a.firstChild.data+rb).length==0){delete a;a=pb}else if(!i&&a.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){for(var l=a.childNodes.length,j=0;j<a.childNodes.length;j++){var d=a.childNodes.item(j);if(d.nodeType==1&&d.tagName&&!Sys.Extended.UI.HTMLEditor.isStyleTag(d.tagName)&&(d.tagName.toUpperCase()==uc||d.tagName.toUpperCase()==Nb||Sys.Extended.UI.HTMLEditor.isTempElement(d)))l--}if(l==0){var m=[];while(a.firstChild){var d=a.removeChild(a.firstChild);m.push(d)}a=m}}if(f==c)return a;else if(!i)return h(a,g?f.previousSibling:f.nextSibling,f.parentNode,g,i);else return h(pb,a,f.parentNode,g,i)}b=a.parentNode;if(a.previousSibling==pb&&a.nextSibling==pb&&b&&b.tagName&&b.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(b.tagName)&&Sys.Extended.UI.HTMLEditor.differAttr(b,[M,N,O,P]).length>0)a=b;var f=h(pb,a.previousSibling,a.parentNode,sb,qb),g=h(pb,a.nextSibling,a.parentNode,qb,qb),d=c.parentNode;if(f)if(f.push&&typeof f.push==xb)for(var e=0;e<f.length;e++)d.insertBefore(f[e],c);else d.insertBefore(f,c);if(a.nodeType==1&&a.tagName&&(a.tagName.toUpperCase()==uc||a.tagName.toUpperCase()==Nb||Sys.Extended.UI.HTMLEditor.isTempElement(a)))d.insertBefore(a,c);else{var i=h(pb,a,a.parentNode,qb,sb);d.insertBefore(i,c)}if(g)if(g.push&&typeof g.push==xb)for(var e=0;e<g.length;e++)d.insertBefore(g[e],c);else d.insertBefore(g,c);d.removeChild(c)}}};Sys.Extended.UI.HTMLEditor.isTempElement=function(a){if(a.id&&a.id.length>0&&a.id.indexOf(Sys.Extended.UI.HTMLEditor.smartClassName)>=0)return sb;return qb};Sys.Extended.UI.HTMLEditor._moveTagsUp=function(d,e){function b(a){if(!Sys.Extended.UI.HTMLEditor.isInlineElement(a))Sys.Extended.UI.HTMLEditor.unStyle(a);else if(a.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){var c=a.firstChild;while(c!=pb){var d=c.nextSibling;b(c);c=d}}}var a=d;while(a!=pb&&a!=e){var c=a.nextSibling;b(a);a=c}};Sys.Extended.UI.HTMLEditor._commonTotalParent=function(e,g){var h=pb,a=e.parentNode,f=e;while(a){if(a.tagName&&!Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)){var d=Sys.Extended.UI.HTMLEditor._lookChild(a,g);if(d>=0){for(var c=0,b=0;b<a.childNodes.length;b++)if(a.childNodes.item(b)==f){c=b;break}return {parent:a,indexFirst:c,indexLast:d}}}f=a;a=a.parentNode}return h};Sys.Extended.UI.HTMLEditor._commonParent=function(e,g){var h=pb,a=e.parentNode,f=e;while(a&&a.tagName.toUpperCase()!=Kb&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)){var d=Sys.Extended.UI.HTMLEditor._lookChild(a,g);if(d>=0){for(var c=0,b=0;b<a.childNodes.length;b++)if(a.childNodes.item(b)==f){c=b;break}return {parent:a,indexFirst:c,indexLast:d}}f=a;a=a.parentNode}return h};Sys.Extended.UI.HTMLEditor.positionInParagraph=function(b,e,c,a,f){while(sb){var d=Sys.Extended.UI.HTMLEditor.positionInParagraphLevel(b,e,c,f);if(d!=pb)return d;if(a.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!Sys.Extended.UI.HTMLEditor.isTempElement(a)){e=c?a.previousSibling:a.nextSibling;a=a.parentNode}else{if(!c||a.firstChild==pb)a.appendChild(b);else a.insertBefore(b,a.firstChild);return b}}};Sys.Extended.UI.HTMLEditor.positionInParagraphLevel=function(c,a,d,g){while(a){var j=d?a.previousSibling:a.nextSibling;if(!Sys.Extended.UI.HTMLEditor.isInlineElement(a)){var e=a.parentNode;if(!d)e.insertBefore(c,a);else if(a.nextSibling)e.insertBefore(c,a.nextSibling);else e.appendChild(c);return c}else if(typeof g==xb&&a.nodeType==3){var b,f=rb+a.data+rb;if(d){for(b=f.length-1;b>=0;b--)if(g(f.substr(b,1)))break}else for(b=0;b<f.length;b++)if(g(f.substr(b,1)))break;if(b>=0&&b<f.length){var e=a.parentNode,h;if((b>0||d&&b==0)&&(b<f.length-1||!d&&b==f.length-1)){if(d)h=a.splitText(b+1);else h=a.splitText(b);e.insertBefore(c,h)}else if(!d)e.insertBefore(c,a);else if(a.nextSibling)e.insertBefore(c,a.nextSibling);else e.appendChild(c);return c}}a=d?a.lastChild:a.firstChild;if(a){var i=Sys.Extended.UI.HTMLEditor.positionInParagraphLevel(c,a,d,g);if(i!=pb)return i}a=j}return pb};Sys.Extended.UI.HTMLEditor._addEvent=function(a,b,c){if(a.attachEvent)a.attachEvent(e+b,c);else a.addEventListener&&a.addEventListener(b,c,sb)};Sys.Extended.UI.HTMLEditor._addEvents=function(d,b,c){for(var a=0;a<b.length;a++)Sys.Extended.UI.HTMLEditor._addEvent(d,b[a],c)};Sys.Extended.UI.HTMLEditor._removeEvent=function(a,b,c){if(a.detachEvent)a.detachEvent(e+b,c);else a.removeEventListener&&a.removeEventListener(b,c,sb)};Sys.Extended.UI.HTMLEditor._removeEvents=function(d,b,c){for(var a=0;a<b.length;a++)Sys.Extended.UI.HTMLEditor._removeEvent(d,b[a],c)};Sys.Extended.UI.HTMLEditor._stopEvent=function(a){if(a)if(Sys.Extended.UI.HTMLEditor.isIE){a.cancelBubble=sb;a.returnValue=qb}else{a.preventDefault();a.stopPropagation()}};Sys.Extended.UI.HTMLEditor.restrictedTags=[ab,Rb,Ob,Z,Nb,sd,sc,Wc,Vc,Bd,f];Sys.Extended.UI.HTMLEditor.isRestricted=function(b){for(var c=b.tagName.toUpperCase(),a=0;a<Sys.Extended.UI.HTMLEditor.restrictedTags.length;a++)if(Sys.Extended.UI.HTMLEditor.restrictedTags[a].toUpperCase()==c)return sb;if(Sys.Extended.UI.HTMLEditor.isIE&&b.scopeName.toUpperCase()!=md)return sb;return qb};Sys.Extended.UI.HTMLEditor.jsDocument=function(b){var a=this;a.noExtraLf=typeof b!=tb&&b;a.text=[];a.write=function(b){var a=this;if(!a.noExtraLf||a.text.length==0&&b!=od||a.text.length>0&&(a.text[a.text.length-1]!=od||b!=od))a.text[a.text.length]=b};a.append=a.write;a.writeln=function(a){this.text[this.text.length]=a+od};a.toString=function(){return this.text.join(rb)};a.clear=function(){delete this.text;this.text=pb;this.text=[]}};Sys.Extended.UI.HTMLEditor.isHeader=function(b){var a=b.tagName.toUpperCase();if(a.length==2)if(a.substr(0,1)==L&&parseInt(a.substr(1,1))>0)return sb;return qb};Sys.Extended.UI.HTMLEditor._getReallyFirst=function(a){if(typeof a.firstChild!=tb&&a.firstChild!=pb)if(typeof a.firstChild.childNodes!=tb&&a.firstChild.childNodes!=pb)return Sys.Extended.UI.HTMLEditor._getReallyFirst(a.firstChild);return a};Sys.Extended.UI.HTMLEditor._getReallyLast=function(a){if(typeof a.lastChild!=tb&&a.lastChild!=pb)if(typeof a.lastChild.childNodes!=tb&&a.lastChild.childNodes!=pb)return Sys.Extended.UI.HTMLEditor._getReallyLast(a.lastChild);return a};Sys.Extended.UI.HTMLEditor._reallyFirst=function(a,b){if(a.firstChild){if(a.firstChild==b)return sb;if(a.firstChild.childNodes)if(Sys.Extended.UI.HTMLEditor._lookChild(a.firstChild,b)==0)return Sys.Extended.UI.HTMLEditor._reallyFirst(a.firstChild,b)}return qb};Sys.Extended.UI.HTMLEditor._reallyLast=function(a,b){if(a.lastChild){if(a.lastChild==b)return sb;if(a.lastChild.childNodes)if(Sys.Extended.UI.HTMLEditor._lookChild(a.lastChild,b)==a.lastChild.childNodes.length-1)return Sys.Extended.UI.HTMLEditor._reallyLast(a.lastChild,b)}return qb};Sys.Extended.UI.HTMLEditor.getContainer=function(b,c){if(c==b)return b;if(b.nodeType==1)for(var d=0;d<b.childNodes.length;d++){var a=b.childNodes.item(d);if(c==a)return a;if(a.nodeType==1){var e=Sys.Extended.UI.HTMLEditor._lookChild(a,c);if(e>=0)if(a.tagName&&Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!=Fb&&!Sys.Extended.UI.HTMLEditor.isTempElement(a))return Sys.Extended.UI.HTMLEditor.getContainer(a,c);else return a}}return pb};Sys.Extended.UI.HTMLEditor._TryTransformFromPxToPt=function(h,f,g){var c=h.replace(/^(\d+)\.(\d+)px/i,"$1px");if(!Sys.Extended.UI.HTMLEditor.isIE)if(c&&c.length>0){var d=c.toLowerCase().split(r)[0];if(typeof g!=tb){var e=document.getElementById(g);if(e!=pb){for(var a=0;a<e.options.length;a++){var i=Sys.Extended.UI.HTMLEditor.fontSizeSeek(e.options.item(a).value.toLowerCase().split(r)[0]);if(i==d)break}if(a==e.options.length){var b=f._doc.createElement(Ac);f._doc.body.appendChild(b);for(a=1;a<100;a++){b.style.fontSize=a+"pt";if(Sys.Extended.UI.HTMLEditor.getStyle(b,t).replace(/^(\d+)\.(\d+)px/i,"$1px")==d){d=a+"pt";break}}b.parentNode.removeChild(b)}}}c=d}return c};Sys.Extended.UI.HTMLEditor.fontSizeSeek=function(b){var a=b.toString();switch(a){case "1":a="8pt";break;case "2":a="10pt";break;case "3":a="12pt";break;case "4":a="14pt";break;case "5":a="18pt";break;case "6":a="24pt";break;case "7":a="36pt"}return a};Sys.Extended.UI.HTMLEditor.getOwnerDocument=function(a){return a.nodeType==9?a:a.ownerDocument||a.document};Sys.Extended.UI.HTMLEditor.getClientViewportElement=function(b){var a;if(b.nodeType==9)a=b;else a=Sys.Extended.UI.HTMLEditor.getOwnerDocument(b);if(Sys.Extended.UI.HTMLEditor.isIE&&a.compatMode!="CSS1Compat")return a.body;return a.documentElement};Sys.Extended.UI.HTMLEditor.isReallyVisible=function(c){var a=c,b=sb;while(a){if(a.style&&Sys.Extended.UI.HTMLEditor.getStyle(a,Lc)==u){b=qb;break}a=a.parentNode}return b};Sys.Extended.UI.HTMLEditor.setSelectionRange=function(a,c,d){a.focus();if(a.setSelectionRange)a.setSelectionRange(c,d);else if(a.createTextRange){var b=a.createTextRange();b.collapse(sb);b.moveEnd(yc,d);b.moveStart(yc,c);b.select()}};if(!Sys.Extended.UI.HTMLEditor.isIE)try{Sys.Extended.UI.HTMLEditor.__MozillaGetInnerText=function(g,b){for(var d=g.childNodes,c=0;c<d.length;c++){var a=d[c];a.nodeType==3&&b.write(a.nodeValue.replace(od,rb));if(a.nodeType==1){var f=Sys.Extended.UI.HTMLEditor.getStyle(a,Lc),e=Sys.Extended.UI.HTMLEditor.getStyle(a,Mc);Sys.Extended.UI.HTMLEditor.__needLineBreakBefore(a)&&b.write(od);Sys.Extended.UI.HTMLEditor.__needTabBefore(a)&&b.write("\t");f!=u&&e!=v&&Sys.Extended.UI.HTMLEditor.__MozillaGetInnerText(a,b);Sys.Extended.UI.HTMLEditor.__needLineBreakAfter(a)&&b.write(od)}}};Sys.Extended.UI.HTMLEditor.__needLineBreakBefore=function(b){var a=" div table p pre ol ul blockquote form fieldset ";return a.indexOf(Pb+b.tagName.toLowerCase()+Pb)!=E};Sys.Extended.UI.HTMLEditor.__needLineBreakAfter=function(b){var a=" br div table tr p pre ol ul li hr blockquote form fieldset legend ";return a.indexOf(Pb+b.tagName.toLowerCase()+Pb)!=E};Sys.Extended.UI.HTMLEditor.__needTabBefore=function(b){var a=" td li ";return a.indexOf(Pb+b.tagName.toLowerCase()+Pb)!=E};HTMLElement.prototype.__defineGetter__("innerText",function(){var a=new Sys.Extended.UI.HTMLEditor.jsDocument(sb);Sys.Extended.UI.HTMLEditor.__MozillaGetInnerText(this,a);return a.toString()})}catch(a){}Sys.Extended.UI.HTMLEditor.Toolbar=function(b){var a=this;Sys.Extended.UI.HTMLEditor.Toolbar.initializeBase(a,[b]);a._loaded=qb;a._cachedButtonIds=pb;a._cachedEditPanel=pb;a._buttons=pb;a._alwaysVisible=qb;a._app_onload$delegate=Function.createDelegate(a,a._app_onload)};Sys.Extended.UI.HTMLEditor.Toolbar.prototype={get_alwaysVisible:function(){return this._alwaysVisible},set_alwaysVisible:function(a){this._alwaysVisible=a;this.get_isInitialized()&&this.raisePropertyChanged("alwaysVisible")},set_activeEditPanel:function(c){var a=this;if(!a._loaded){a._cachedEditPanel=c;return}for(var b=0;b<a.get_buttons().length;b++)a.get_buttons()[b].set_activeEditPanel(c)},disable:function(){var a=this;if(a.get_isInitialized()){if(a._alwaysVisible)return;for(var b=0;b<a.get_buttons().length;b++)a.get_buttons()[b].set_activeEditPanel(pb)}},get_buttons:function(){if(this._buttons==pb)this._buttons=[];return this._buttons},set_buttons:function(a){this.get_buttons().push(a)},get_buttonIds:function(){},set_buttonIds:function(c){if(!this.get_isInitialized()){this._cachedButtonIds=c;return}for(var b=c.split(";"),a=0;a<b.length;a++)b[a].length>0&&this.set_buttons($find(b[a]))},initialize:function(){Sys.Extended.UI.HTMLEditor.Toolbar.callBaseMethod(this,H);Sys.Application.add_load(this._app_onload$delegate)},dispose:function(){this._loaded=qb;Sys.Application.remove_load(this._app_onload$delegate);Sys.Extended.UI.HTMLEditor.Toolbar.callBaseMethod(this,d)},_app_onload:function(){var a=this;if(a._cachedButtonIds!=pb){a.set_buttonIds(a._cachedButtonIds);a._cachedButtonIds=pb}a._loaded=sb;if(a._cachedEditPanel!=pb){a.set_activeEditPanel(a._cachedEditPanel);a._cachedEditPanel=pb}}};Sys.Extended.UI.HTMLEditor.Toolbar.registerClass("Sys.Extended.UI.HTMLEditor.Toolbar",Sys.UI.Control);Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel=pb;Sys.Extended.UI.HTMLEditor.EditPanel=function(b){var a=this;Sys.Extended.UI.HTMLEditor.EditPanel.initializeBase(a,[b]);a._loaded=qb;a._eAfter=pb;a._toolbars=pb;a._modePanels=pb;a._contentChangedElement=pb;a._contentElement=pb;a._contentForceElement=pb;a._activeModeElement=pb;a._suppressTabInDesignMode=qb;a._keyboardEnabled=sb;a._noPaste=qb;a._hotkeys=pb;a._showAnchors=qb;a._showPlaceHolders=qb;a._startEnd=sb;a._relativeImages=sb;a._documentCssPath=pb;a._designPanelCssPath=pb;a._imagePath_1x1=pb;a._imagePath_flash=pb;a._imagePath_media=pb;a._imagePath_anchor=pb;a._imagePath_placeHolder=pb;a._autofocus=sb;a._initialCleanUp=qb;a._noScript=qb;a._noUnicode=qb;a._cachedToolbarIds=pb;a._contentPrepared=qb;a._activeMode=pb;a._pageRequestManager=pb;a._formOnSubmitSaved=pb;a._app_onload$delegate=Function.createDelegate(a,a._app_onload);a._onsubmit$delegate=Function.createDelegate(a,a._onsubmit);a._disposed=sb};Sys.Extended.UI.HTMLEditor.EditPanel.prototype={get_relativeImages:function(){return this._relativeImages},set_relativeImages:function(a){this._relativeImages=a;this._loaded&&this.raisePropertyChanged("relativeImages")},get_startEnd:function(){return this._startEnd},set_startEnd:function(a){this._startEnd=a;this._loaded&&this.raisePropertyChanged("startEnd")},get_showPlaceHolders:function(){return this._showPlaceHolders},set_showPlaceHolders:function(a){this._showPlaceHolders=a;this._loaded&&this.raisePropertyChanged("showPlaceHolders")},get_showAnchors:function(){return this._showAnchors},set_showAnchors:function(a){this._showAnchors=a;this._loaded&&this.raisePropertyChanged("showAnchors")},get_hotkeys:function(){return this._hotkeys},set_hotkeys:function(a){this._hotkeys=a;this._loaded&&this.raisePropertyChanged("noPaste")},get_noPaste:function(){return this._noPaste},set_noPaste:function(a){this._noPaste=a;this._loaded&&this.raisePropertyChanged("noPaste")},get_suppressTabInDesignMode:function(){return this._suppressTabInDesignMode},set_suppressTabInDesignMode:function(a){this._suppressTabInDesignMode=a;this._loaded&&this.raisePropertyChanged("suppressTabInDesignMode")},get_keyboardEnabled:function(){return this._keyboardEnabled},set_keyboardEnabled:function(a){this._keyboardEnabled=a;this._loaded&&this.raisePropertyChanged("keyboardEnabled")},get_noUnicode:function(){return this._noUnicode},set_noUnicode:function(a){this._noUnicode=a;this._loaded&&this.raisePropertyChanged("noUnicode")},get_noScript:function(){return this._noScript},set_noScript:function(a){this._noScript=a;this._loaded&&this.raisePropertyChanged("noScript")},get_initialCleanUp:function(){return this._initialCleanUp},set_initialCleanUp:function(a){this._initialCleanUp=a;this._loaded&&this.raisePropertyChanged("initialCleanUp")},"get_imagePath_1x1":function(){return this._imagePath_1x1},"set_imagePath_1x1":function(a){this._imagePath_1x1=a},get_imagePath_flash:function(){return this._imagePath_flash},set_imagePath_flash:function(a){this._imagePath_flash=a},get_imagePath_media:function(){return this._imagePath_media},set_imagePath_media:function(a){this._imagePath_media=a},get_imagePath_anchor:function(){return this._imagePath_anchor},set_imagePath_anchor:function(a){this._imagePath_anchor=a},get_imagePath_placeHolder:function(){return this._imagePath_placeHolder},set_imagePath_placeHolder:function(a){this._imagePath_placeHolder=a},get_documentCssPath:function(){return this._documentCssPath},set_documentCssPath:function(a){this._documentCssPath=a;this._loaded&&this.raisePropertyChanged("documentCssPath")},get_designPanelCssPath:function(){return this._designPanelCssPath},set_designPanelCssPath:function(a){this._designPanelCssPath=a;this._loaded&&this.raisePropertyChanged("designPanelCssPath")},get_autofocus:function(){return this._autofocus},set_autofocus:function(a){this._autofocus=a;this._loaded&&this.raisePropertyChanged("autofocus")},get_content:function(){if(this._activeMode==pb)return rb;return this.getContent()},set_content:function(b){var a=this;if(!a.get_isInitialized()||!a._loaded){if(a.get_contentElement()!=pb)a.get_contentElement().value=b.replace(/\"/g,zd);return}a.setContent(b);a._loaded&&a.raisePropertyChanged("content")},get_activeMode:function(){if(this._activeMode==pb)return Sys.Extended.UI.HTMLEditor.ActiveModeType.Design;return this._activeMode},set_activeMode:function(b){var a=this;if(!Sys.Extended.UI.HTMLEditor.ActiveModeType_checkValue(b))throw Error.argumentOutOfRange("value, function: Sys.Extended.UI.HTMLEditor.EditPanel.set_activeMode");var c=a._activeMode,d=sb;if(a._loaded&&c!=pb&&c!=b){var e=new Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs(c,b,a);a.raiseBeforeActiveModeChanged(e);a._eAfter=new Sys.Extended.UI.HTMLEditor.ActiveModeChangedArgs(c,b,a);d=a._setMode(b)}else a._activeMode=b;a.get_activeModeElement().value=b;return d},get_contentChangedElement:function(){return this._contentChangedElement},set_contentChangedElement:function(a){this._contentChangedElement=a},get_contentElement:function(){return this._contentElement},set_contentElement:function(a){this._contentElement=a},get_contentForceElement:function(){return this._contentForceElement},set_contentForceElement:function(a){this._contentForceElement=a},get_activeModeElement:function(){return this._activeModeElement},set_activeModeElement:function(a){this._activeModeElement=a},setCancelOnPostback:function(){if(this._loaded)this.get_contentForceElement().value=rb},setAcceptOnPostback:function(){if(this._loaded)this.get_contentForceElement().value="1"},get_toolbars:function(){if(this._toolbars==pb)this._toolbars=[];return this._toolbars},set_toolbars:function(a){this.get_toolbars().push(a)},get_toolbarIds:function(){},set_toolbarIds:function(c){if(!this.get_isInitialized()){this._cachedToolbarIds=c;return}for(var b=c.split(";"),a=0;a<b.length;a++)b[a].length>0&&this.set_toolbars($find(b[a]))},get_modePanels:function(){if(this._modePanels==pb)this._modePanels=[];return this._modePanels},set_modePanel:function(a){this.get_modePanels().push(a)},get_modePanelIds:function(){},set_modePanelIds:function(c){for(var b=c.split(";"),a=0;a<b.length;a++)this.set_modePanel($find(b[a]))},add_focused:function(a){this.get_events().addHandler(Ed,a)},remove_focused:function(a){this.get_events().removeHandler(Ed,a)},raiseFocused:function(b){var a=this.get_events().getHandler(Ed);a&&a(this,b)},add_activeModeChanged:function(a){this.get_events().addHandler(Fd,a)},remove_activeModeChanged:function(a){this.get_events().removeHandler(Fd,a)},raiseActiveModeChanged:function(b){var a=this.get_events().getHandler(Fd);a&&a(this,b)},add_beforeActiveModeChanged:function(a){this.get_events().addHandler(Gd,a)},remove_beforeActiveModeChanged:function(a){this.get_events().removeHandler(Gd,a)},raiseBeforeActiveModeChanged:function(b){var a=this.get_events().getHandler(Gd);a&&a(this,b)},get_activePanel:function(){var a=this.get_modePanels()[this.get_activeMode()];if(a==pb||typeof a==tb)throw Error.argumentOutOfRange("activeMode, function: Sys.Extended.UI.HTMLEditor.EditPanel.get_activePanel");return a},initialize:function(){var a=this;a.__appLoaded__=qb;Sys.Extended.UI.HTMLEditor.EditPanel.callBaseMethod(a,H);a._disposed=qb;Sys.Application.add_load(a._app_onload$delegate);if(Sys&&Sys.WebForms&&Sys.WebForms.PageRequestManager){a._pageRequestManager=Sys.WebForms.PageRequestManager.getInstance();if(a._pageRequestManager){a._partialUpdateEndRequestHandler=Function.createDelegate(a,a._partialUpdateEndRequest);a._pageRequestManager.add_endRequest(a._partialUpdateEndRequestHandler);a._invokingRequestHandler=Function.createDelegate(a,a._invokingRequest);Sys.Net.WebRequestManager.add_invokingRequest(a._invokingRequestHandler)}}Sys.Extended.UI.HTMLEditor.addFormOnSubmit(a._onsubmit$delegate)},dispose:function(){var a=this;a._loaded=qb;a._disposed=sb;if(a._pageRequestManager){if(a._invokingRequestHandler){a._pageRequestManager.remove_endRequest(a._partialUpdateEndRequestHandler);a._partialUpdateEndRequestHandler=pb;Sys.Net.WebRequestManager.remove_invokingRequest(a._invokingRequestHandler);a._invokingRequestHandler=pb}a._pageRequestManager=pb}Sys.Extended.UI.HTMLEditor.removeFormOnSubmit(a._onsubmit$delegate);Sys.Application.remove_load(a._app_onload$delegate);a.disableToolbars();Sys.Extended.UI.HTMLEditor.EditPanel.callBaseMethod(a,d)},_onsubmit:function(){var a=this;if(!a._contentPrepared){a._prepareContentForPostback(a.get_content());a._contentPrepared=sb}return sb},_invokingRequest:function(f,d){var a=this;if(a._contentPrepared)return;var c=d.get_webRequest(),b=c.get_body(),e=new RegExp("([\\?&])("+a.get_contentElement().name+"=)([^&$]*)([&$])","g");b=b.replace(e,"$1$2"+escape(a.get_content().replace(/&/g,Dc).replace(/</g,wc).replace(/>/g,xc).replace(/\"/g,zd))+"$4");a._contentPrepared=sb;c.set_body(b)},_partialUpdateEndRequest:function(){var a=this;a._contentPrepared=qb;if(Sys.Extended.UI.HTMLEditor.isIE&&a.__blured){a.__blured=qb;a.get_activePanel()._focus()}},_app_onload:function(){var a=this;if(a.__appLoaded__)return;a.__appLoaded__=sb;if(a._disposed)return;var g=a;if(!Sys.Extended.UI.HTMLEditor.isReallyVisible(a.get_element().parentNode)){setTimeout(a._app_onload$delegate,100);return}a._loaded=sb;a.set_activeMode(parseInt(a.get_activeModeElement().value));if(a._cachedToolbarIds!=pb){a.set_toolbarIds(a._cachedToolbarIds);a._cachedToolbarIds=pb}a._shouldResize=qb;if(Sys.Extended.UI.HTMLEditor.isIE&&document.compatMode!=db)if(a.get_element().clientHeight==0||Sys.Browser.version<7)a._shouldResize=sb;if(a._shouldResize){var d=a.get_modePanels(),b=d[Sys.Extended.UI.HTMLEditor.ActiveModeType.Design];if(b==pb)b=d[Sys.Extended.UI.HTMLEditor.ActiveModeType.Preview];var e=d[Sys.Extended.UI.HTMLEditor.ActiveModeType.Html];if(b!=pb&&e!=pb){var c=b.get_element();c.style.display=rb;e.get_element().style.height=c.offsetHeight+X;c.style.display=u}}var f=a.get_contentElement().value.replace(/&lt;/g,kc).replace(/&gt;/g,Ec).replace(/&quot;/g,C).replace(/&amp;/g,jb);a.setContent(a._initialCleanUp?Sys.Extended.UI.HTMLEditor.cleanUp(f.replace(/[\n\r]+/g,Pb)):f);a.setAcceptOnPostback()},_setActive:function(){var a=this;for(var b=0;b<a.get_toolbars().length;b++)a.get_toolbars()[b].set_activeEditPanel(a,sb);if(a._eAfter!=pb){a.raisePropertyChanged("activeMode");a.raiseActiveModeChanged(a._eAfter);a._eAfter=pb}},_focused:function(c){var a=this;if(!(typeof c!=tb&&c))for(var b=0;b<a.get_toolbars().length;b++)a.get_toolbars()[b].set_activeEditPanel(a);Sys.Extended.UI.HTMLEditor.LastFocusedEditPanel=a},_really_focused:function(){this._focused();this.raiseFocused(new Sys.EventArgs)},updateToolbar:function(){this._focused()},getContent:function(){return this.get_activePanel().get_content().replace(/<\/?html(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/<\/?head(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/<\/?body(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/^([\n\r]+)/,rb).replace(/([\n\r]+)$/,rb)},setContent:function(b){var a=b;if(this.get_noScript())a=a.replace(/(<script(?:[^>]*?)>(?:[^<]*?)<\/script(?:[^>]*?)>)/ig,rb);a=a.replace(/<\/?html(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/<\/?head(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/<\/?body(?=\s|>)(?:[^>]*?)>/gi,rb).replace(/^([\n\r]+)/,rb).replace(/([\n\r]+)$/,rb);this._prepareContentForPostback(a);this.get_activePanel().set_content(a)},_prepareContentForPostback:function(a){this.get_contentElement().value=a.replace(/&/g,Dc).replace(/</g,wc).replace(/>/g,xc).replace(/\"/g,zd)},_setMode:function(b){var a=this,c=a.get_activePanel();if(!c._activated){var f=a;setTimeout(function(){f._setMode(b)},10);return qb}var g=a.get_content();if(a._shouldResize&&b==Sys.Extended.UI.HTMLEditor.ActiveModeType.Html){var d=a.get_activePanel(),e=a.get_modePanels()[Sys.Extended.UI.HTMLEditor.ActiveModeType.Html];if(d!=pb&&e!=pb)e.get_element().style.height=d.get_element().offsetHeight+X}a.disableToolbars(b);c._deactivate();a._activeMode=b;a.setContent(g);return sb},disableToolbars:function(c){for(var a=0;a<this.get_toolbars().length;a++){var b=this.get_toolbars()[a];b._loaded&&b.disable(c)}},openWait:function(){},closeWait:function(){}};Sys.Extended.UI.HTMLEditor.EditPanel.registerClass("Sys.Extended.UI.HTMLEditor.EditPanel",Sys.UI.Control);Sys.Extended.UI.HTMLEditor.Editor=function(b){var a=this;Sys.Extended.UI.HTMLEditor.Editor.initializeBase(a,[b]);a._editPanel=pb;a._changingToolbar=pb;if(Sys.Extended.UI.HTMLEditor.isIE&&Sys.Browser.version==8&&document.compatMode!=db)a._onresize$delegate=Function.createDelegate(a,a._onresize)};Sys.Extended.UI.HTMLEditor.Editor.prototype={get_autofocus:function(){return this._editPanel.get_autofocus()},set_autofocus:function(a){this._editPanel.set_autofocus(a)},get_content:function(){return this._editPanel.get_content()},set_content:function(a){this._editPanel.set_content(a)},get_activeMode:function(){return this._editPanel.get_activeMode()},set_activeMode:function(a){this._editPanel.set_activeMode(a)},get_editPanel:function(){return this._editPanel},set_editPanel:function(a){this._editPanel=a},get_changingToolbar:function(){return this._changingToolbar},set_changingToolbar:function(a){this._changingToolbar=a},add_propertyChanged:function(a){this._editPanel.add_propertyChanged(a)},remove_propertyChanged:function(a){this._editPanel.remove_propertyChanged(a)},initialize:function(){var a=this;Sys.Extended.UI.HTMLEditor.Editor.callBaseMethod(a,H);var b=a.get_element(),c=b.className;Sys.UI.DomElement.removeCssClass(b,c);Sys.UI.DomElement.addCssClass(b,"ajax__htmleditor_editor_base");Sys.UI.DomElement.addCssClass(b,c);if(!Sys.Extended.UI.HTMLEditor.isIE&&document.compatMode!=db)a.get_element().style.height="100%";if(Sys.Extended.UI.HTMLEditor.isIE&&Sys.Browser.version==8&&document.compatMode!=db)if(a.get_changingToolbar()!=pb){a._saved_set_activeEditPanel=a.get_changingToolbar().set_activeEditPanel;a._saved_disable=a.get_changingToolbar().disable;a.get_changingToolbar().set_activeEditPanel=Function.createDelegate(a,a._set_activeEditPanel);a.get_changingToolbar().disable=Function.createDelegate(a,a._disable)}},_set_activeEditPanel:function(g){var a=this,b=a.get_changingToolbar().get_element(),d=a.get_editPanel().get_element(),e=b.parentNode.clientHeight;Function.createDelegate(a.get_changingToolbar(),a._saved_set_activeEditPanel)(g);var f=b.parentNode.clientHeight,c=d.parentNode.clientHeight;if(c>0)d.style.height=c-(f-e)+X},_disable:function(g){var a=this,b=a.get_changingToolbar().get_element(),d=a.get_editPanel().get_element(),e=b.clientHeight;Function.createDelegate(a.get_changingToolbar(),a._saved_disable)(g);var f=b.clientHeight,c=d.parentNode.clientHeight;if(c>0)d.style.height=c-(f-e)+X},dispose:function(){var a=this;if(Sys.Extended.UI.HTMLEditor.isIE&&Sys.Browser.version==8&&document.compatMode!=db){a.get_changingToolbar().set_activeEditPanel=a._saved_set_activeEditPanel;a.get_changingToolbar().disable=a._saved_disable}Sys.Extended.UI.HTMLEditor.Editor.callBaseMethod(a,d)},_onresize:function(){var a=this,b=a.get_changingToolbar().get_element(),d=a.get_editPanel().get_element(),c=d.parentNode.clientHeight;if(c>0)d.style.height=c-(b.clientHeight-a._changingToolbarHeight)+X;a._changingToolbarHeight=b.clientHeight}};Sys.Extended.UI.HTMLEditor.Editor.registerClass("Sys.Extended.UI.HTMLEditor.Editor",Sys.UI.Control);Sys.Extended.UI.HTMLEditor.Editor.MidleCellHeightForIE=function(a,e){var c="100%";if(Sys.Extended.UI.HTMLEditor.isIE&&document.compatMode!=db)try{for(var d=2,b=0;b<a.rows.length;b++)if(a.rows[b]!=e)d+=a.rows[b].offsetHeight+1;c=(a.clientHeight-d)/a.clientHeight*100+"%"}catch(f){c=rb}return c};Sys.Extended.UI.HTMLEditor.ClientSideEditor=function(d){var g="_ctl02_ctl02",b="_ctl02",c=this;Sys.Extended.UI.HTMLEditor.ClientSideEditor.initializeBase(c,[d]);var a=c.__id__=d.id+"_RichTextEditor",f=document.createElement(ab);f.className="ajax__htmleditor_editor_default";f.id=a;f.innerHTML='<table cellspacing="0" cellpadding="0" border="0" class="ajax__htmleditor_editor_container" style="border-collapse: separate;"><tbody><tr><td class="ajax__htmleditor_editor_toptoolbar"><div id="'+a+'_ctl01"><img src="none" alt="" id="'+a+'_ctl01_ctl00" title="Undo" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl01" title="Redo" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl02" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl03" title="Bold" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl04" title="Italic" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl05" title="Underline" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl06" title="Strike through" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl07" title="Sub script" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl08" title="Super script" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl09" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl10" title="Left to right direction" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl11" title="Right to left direction" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl12" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><div id="'+a+'_ctl01_FixedForeColor" title="Foreground color" class="ajax__htmleditor_toolbar_button" style="display: none;"><table cellspacing="0" cellpadding="0" border="0" style="margin: 1px; padding: 0px;"><tbody><tr><td><img src="none" alt="" id="'+a+'_ctl01_FixedForeColor_ctl01" title="Foreground color" /></td></tr><tr><td><div id="'+a+'_ctl01_FixedForeColor_ctl02" title="Foreground color" style="margin: 0px; padding: 0px; height: 5px; width: 21px; background-color: #ff0000; font-size: 1px;"></div></td></tr></tbody></table></div><img src="none" alt="" id="'+a+'_ctl01_ctl13" title="Foreground color" class="ajax__htmleditor_toolbar_button" style="display: none;" /><div id="'+a+'_ctl01_ctl14" style="position: absolute; top: -2000px; left: -2000px;"><iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0" tabindex="-1" id="'+a+'_ctl01_ctl14_ctl00"></iframe><div id="'+a+'_ctl01_ctl14_ctl01" style="display: none;"><div class="ajax__htmleditor_attachedpopup_default"><table cellspacing="1" cellpadding="0" border="0" style="background-color: #000000;"><tbody><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#003300&quot;)" style="background-color: #003300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#006600&quot;)" style="background-color: #006600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#009900&quot;)" style="background-color: #009900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CC00&quot;)" style="background-color: #00cc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FF00&quot;)" style="background-color: #00ff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#330000&quot;)" style="background-color: #330000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#333300&quot;)" style="background-color: #333300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#336600&quot;)" style="background-color: #336600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#339900&quot;)" style="background-color: #339900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CC00&quot;)" style="background-color: #33cc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FF00&quot;)" style="background-color: #33ff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#660000&quot;)" style="background-color: #660000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#663300&quot;)" style="background-color: #663300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#666600&quot;)" style="background-color: #666600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#669900&quot;)" style="background-color: #669900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CC00&quot;)" style="background-color: #66cc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FF00&quot;)" style="background-color: #66ff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#333333&quot;)" style="background-color: #333333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000033&quot;)" style="background-color: #000033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#003333&quot;)" style="background-color: #003333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#006633&quot;)" style="background-color: #006633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#009933&quot;)" style="background-color: #009933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CC33&quot;)" style="background-color: #00cc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FF33&quot;)" style="background-color: #00ff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#330033&quot;)" style="background-color: #330033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#333333&quot;)" style="background-color: #333333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#336633&quot;)" style="background-color: #336633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#339933&quot;)" style="background-color: #339933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CC33&quot;)" style="background-color: #33cc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FF33&quot;)" style="background-color: #33ff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#660033&quot;)" style="background-color: #660033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#663333&quot;)" style="background-color: #663333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#666633&quot;)" style="background-color: #666633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#669933&quot;)" style="background-color: #669933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CC33&quot;)" style="background-color: #66cc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FF33&quot;)" style="background-color: #66ff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#666666&quot;)" style="background-color: #666666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000066&quot;)" style="background-color: #000066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#003366&quot;)" style="background-color: #003366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#006666&quot;)" style="background-color: #006666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#009966&quot;)" style="background-color: #009966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CC66&quot;)" style="background-color: #00cc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FF66&quot;)" style="background-color: #00ff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#330066&quot;)" style="background-color: #330066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#333366&quot;)" style="background-color: #333366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#336666&quot;)" style="background-color: #336666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#339966&quot;)" style="background-color: #339966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CC66&quot;)" style="background-color: #33cc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FF66&quot;)" style="background-color: #33ff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#660066&quot;)" style="background-color: #660066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#663366&quot;)" style="background-color: #663366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#666666&quot;)" style="background-color: #666666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#669966&quot;)" style="background-color: #669966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CC66&quot;)" style="background-color: #66cc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FF66&quot;)" style="background-color: #66ff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#999999&quot;)" style="background-color: #999999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000099&quot;)" style="background-color: #000099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#003399&quot;)" style="background-color: #003399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#006699&quot;)" style="background-color: #006699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#009999&quot;)" style="background-color: #009999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CC99&quot;)" style="background-color: #00cc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FF99&quot;)" style="background-color: #00ff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#330099&quot;)" style="background-color: #330099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#333399&quot;)" style="background-color: #333399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#336699&quot;)" style="background-color: #336699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#339999&quot;)" style="background-color: #339999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CC99&quot;)" style="background-color: #33cc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FF99&quot;)" style="background-color: #33ff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#660099&quot;)" style="background-color: #660099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#663399&quot;)" style="background-color: #663399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#666699&quot;)" style="background-color: #666699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#669999&quot;)" style="background-color: #669999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CC99&quot;)" style="background-color: #66cc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FF99&quot;)" style="background-color: #66ff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCCCC&quot;)" style="background-color: #cccccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0000CC&quot;)" style="background-color: #0000cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0033CC&quot;)" style="background-color: #0033cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0066CC&quot;)" style="background-color: #0066cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0099CC&quot;)" style="background-color: #0099cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CCCC&quot;)" style="background-color: #00cccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FFCC&quot;)" style="background-color: #00ffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3300CC&quot;)" style="background-color: #3300cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3333CC&quot;)" style="background-color: #3333cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3366CC&quot;)" style="background-color: #3366cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3399CC&quot;)" style="background-color: #3399cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CCCC&quot;)" style="background-color: #33cccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FFCC&quot;)" style="background-color: #33ffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6600CC&quot;)" style="background-color: #6600cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6633CC&quot;)" style="background-color: #6633cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6666CC&quot;)" style="background-color: #6666cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6699CC&quot;)" style="background-color: #6699cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CCCC&quot;)" style="background-color: #66cccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FFCC&quot;)" style="background-color: #66ffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFFFF&quot;)" style="background-color: #ffffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0000FF&quot;)" style="background-color: #0000ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0033FF&quot;)" style="background-color: #0033ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0066FF&quot;)" style="background-color: #0066ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0099FF&quot;)" style="background-color: #0099ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00CCFF&quot;)" style="background-color: #00ccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FFFF&quot;)" style="background-color: #00ffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3300FF&quot;)" style="background-color: #3300ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3333FF&quot;)" style="background-color: #3333ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3366FF&quot;)" style="background-color: #3366ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#3399FF&quot;)" style="background-color: #3399ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33CCFF&quot;)" style="background-color: #33ccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#33FFFF&quot;)" style="background-color: #33ffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6600FF&quot;)" style="background-color: #6600ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6633FF&quot;)" style="background-color: #6633ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6666FF&quot;)" style="background-color: #6666ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#6699FF&quot;)" style="background-color: #6699ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66CCFF&quot;)" style="background-color: #66ccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#66FFFF&quot;)" style="background-color: #66ffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF0000&quot;)" style="background-color: #ff0000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#990000&quot;)" style="background-color: #990000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#993300&quot;)" style="background-color: #993300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#996600&quot;)" style="background-color: #996600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#999900&quot;)" style="background-color: #999900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CC00&quot;)" style="background-color: #99cc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FF00&quot;)" style="background-color: #99ff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC0000&quot;)" style="background-color: #cc0000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC3300&quot;)" style="background-color: #cc3300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC6600&quot;)" style="background-color: #cc6600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC9900&quot;)" style="background-color: #cc9900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCC00&quot;)" style="background-color: #cccc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFF00&quot;)" style="background-color: #ccff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF0000&quot;)" style="background-color: #ff0000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF3300&quot;)" style="background-color: #ff3300; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF6600&quot;)" style="background-color: #ff6600; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF9900&quot;)" style="background-color: #ff9900; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCC00&quot;)" style="background-color: #ffcc00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFF00&quot;)" style="background-color: #ffff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FF00&quot;)" style="background-color: #00ff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#990033&quot;)" style="background-color: #990033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#993333&quot;)" style="background-color: #993333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#996633&quot;)" style="background-color: #996633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#999933&quot;)" style="background-color: #999933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CC33&quot;)" style="background-color: #99cc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FF33&quot;)" style="background-color: #99ff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC0033&quot;)" style="background-color: #cc0033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC3333&quot;)" style="background-color: #cc3333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC6633&quot;)" style="background-color: #cc6633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC9933&quot;)" style="background-color: #cc9933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCC33&quot;)" style="background-color: #cccc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFF33&quot;)" style="background-color: #ccff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF0033&quot;)" style="background-color: #ff0033; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF3333&quot;)" style="background-color: #ff3333; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF6633&quot;)" style="background-color: #ff6633; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF9933&quot;)" style="background-color: #ff9933; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCC33&quot;)" style="background-color: #ffcc33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFF33&quot;)" style="background-color: #ffff33; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#0000FF&quot;)" style="background-color: #0000ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#990066&quot;)" style="background-color: #990066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#993366&quot;)" style="background-color: #993366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#996666&quot;)" style="background-color: #996666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#999966&quot;)" style="background-color: #999966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CC66&quot;)" style="background-color: #99cc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FF66&quot;)" style="background-color: #99ff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC0066&quot;)" style="background-color: #cc0066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC3366&quot;)" style="background-color: #cc3366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC6666&quot;)" style="background-color: #cc6666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC9966&quot;)" style="background-color: #cc9966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCC66&quot;)" style="background-color: #cccc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFF66&quot;)" style="background-color: #ccff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF0066&quot;)" style="background-color: #ff0066; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF3366&quot;)" style="background-color: #ff3366; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF6666&quot;)" style="background-color: #ff6666; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF9966&quot;)" style="background-color: #ff9966; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCC66&quot;)" style="background-color: #ffcc66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFF66&quot;)" style="background-color: #ffff66; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFF00&quot;)" style="background-color: #ffff00; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#990099&quot;)" style="background-color: #990099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#993399&quot;)" style="background-color: #993399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#996699&quot;)" style="background-color: #996699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#999999&quot;)" style="background-color: #999999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CC99&quot;)" style="background-color: #99cc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FF99&quot;)" style="background-color: #99ff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC0099&quot;)" style="background-color: #cc0099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC3399&quot;)" style="background-color: #cc3399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC6699&quot;)" style="background-color: #cc6699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC9999&quot;)" style="background-color: #cc9999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCC99&quot;)" style="background-color: #cccc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFF99&quot;)" style="background-color: #ccff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF0099&quot;)" style="background-color: #ff0099; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF3399&quot;)" style="background-color: #ff3399; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF6699&quot;)" style="background-color: #ff6699; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF9999&quot;)" style="background-color: #ff9999; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCC99&quot;)" style="background-color: #ffcc99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFF99&quot;)" style="background-color: #ffff99; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#00FFFF&quot;)" style="background-color: #00ffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9900CC&quot;)" style="background-color: #9900cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9933CC&quot;)" style="background-color: #9933cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9966CC&quot;)" style="background-color: #9966cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9999CC&quot;)" style="background-color: #9999cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CCCC&quot;)" style="background-color: #99cccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FFCC&quot;)" style="background-color: #99ffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC00CC&quot;)" style="background-color: #cc00cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC33CC&quot;)" style="background-color: #cc33cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC66CC&quot;)" style="background-color: #cc66cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC99CC&quot;)" style="background-color: #cc99cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCCCC&quot;)" style="background-color: #cccccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFFCC&quot;)" style="background-color: #ccffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF00CC&quot;)" style="background-color: #ff00cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF33CC&quot;)" style="background-color: #ff33cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF66CC&quot;)" style="background-color: #ff66cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF99CC&quot;)" style="background-color: #ff99cc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCCCC&quot;)" style="background-color: #ffcccc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFFCC&quot;)" style="background-color: #ffffcc; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr><tr><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF00FF&quot;)" style="background-color: #ff00ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#000000&quot;)" style="background-color: #000000; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9900FF&quot;)" style="background-color: #9900ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9933FF&quot;)" style="background-color: #9933ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9966FF&quot;)" style="background-color: #9966ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#9999FF&quot;)" style="background-color: #9999ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99CCFF&quot;)" style="background-color: #99ccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#99FFFF&quot;)" style="background-color: #99ffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC00FF&quot;)" style="background-color: #cc00ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC33FF&quot;)" style="background-color: #cc33ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC66FF&quot;)" style="background-color: #cc66ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CC99FF&quot;)" style="background-color: #cc99ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCCCFF&quot;)" style="background-color: #ccccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#CCFFFF&quot;)" style="background-color: #ccffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF00FF&quot;)" style="background-color: #ff00ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF33FF&quot;)" style="background-color: #ff33ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF66FF&quot;)" style="background-color: #ff66ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FF99FF&quot;)" style="background-color: #ff99ff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFCCFF&quot;)" style="background-color: #ffccff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td><td onclick="setColor(&quot;#FFFFFF&quot;)" style="background-color: #ffffff; width: 10px; height: 10px; cursor: pointer;"><div style="font-size: 1px; height: 100%; width: 100%;"></div></td></tr></tbody></table></div></div></div><img src="none" alt="" id="'+a+'_ctl01_ctl15" title="Clear foreground color" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl16" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><div id="'+a+'_ctl01_FixedBackColor" title="Background color" class="ajax__htmleditor_toolbar_button" style="display: none;"><table cellspacing="0" cellpadding="0" border="0" style="margin: 1px; padding: 0px;"><tbody><tr><td><img src="none" alt="" id="'+a+'_ctl01_FixedBackColor_ctl01" title="Background color" /></td></tr><tr><td><div id="'+a+'_ctl01_FixedBackColor_ctl02" title="Background color" style="margin: 0px; padding: 0px; height: 5px; width: 21px; background-color: #ffff00; font-size: 1px;"></div></td></tr></tbody></table></div><img src="none" alt="" id="'+a+'_ctl01_ctl17" title="Background color" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl18" title="Clear background color" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl19" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl20" title="Remove styles" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl21" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><div id="'+a+'_ctl01_ctl22" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;"><nobr><span id="'+a+'_ctl01_ctl22_label" class="ajax__htmleditor_toolbar_selectlable">Font&nbsp;</span><select id="'+a+'_ctl01_ctl22_select" class="ajax__htmleditor_toolbar_selectbutton"><option value="">default</option><option value="arial,helvetica,sans-serif">Arial</option><option value="courier new,courier,monospace">Courier New</option><option value="georgia,times new roman,times,serif">Georgia</option><option value="tahoma,arial,helvetica,sans-serif">Tahoma</option><option value="times new roman,times,serif">Times New Roman</option><option value="verdana,arial,helvetica,sans-serif">Verdana</option><option value="impact">Impact</option><option value="wingdings">WingDings</option></select></nobr></div><img src="none" alt="" id="'+a+'_ctl01_ctl23" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><div id="'+a+'_ctl01_ctl24" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;"><nobr><span id="'+a+'_ctl01_ctl24_label" class="ajax__htmleditor_toolbar_selectlable">Size&nbsp;</span><select id="'+a+'_ctl01_ctl24_select" class="ajax__htmleditor_toolbar_selectbutton" style="width: 70px;"><option value="">default</option><option value="8pt">1 ( 8 pt)</option><option value="10pt">2 (10 pt)</option><option value="12pt">3 (12 pt)</option><option value="14pt">4 (14 pt)</option><option value="18pt">5 (18 pt)</option><option value="24pt">6 (24 pt)</option><option value="36pt">7 (36 pt)</option></select></nobr></div><img src="none" alt="" id="'+a+'_ctl01_ctl25" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl26" title="Cut" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl27" title="Copy" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl28" title="Paste" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl29" title="Paste Plain Text" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl30" title="Paste from MS Word (with cleanup)" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl31" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl32" title="Decrease Indent" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl33" title="Increase Indent" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl34" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl35" title="Make Paragraph" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl36" title="Justify Left" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl37" title="Justify Center" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl38" title="Justify Right" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl39" title="Justify" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl40" title="Remove Alignment" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl41" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl42" title="Ordered List" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl43" title="Bulleted List" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl44" class="ajax__htmleditor_toolbar_button" style="background-color: transparent; cursor: text; display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl45" title="Insert horizontal rule" class="ajax__htmleditor_toolbar_button" style="display: none;" /><img src="none" alt="" id="'+a+'_ctl01_ctl46" title="Insert/Edit URL link" class="ajax__htmleditor_toolbar_button" style="display: none;" /><div id="'+a+'_ctl01_ctl47" style="position: absolute; top: -2000px; left: -2000px;"><iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0" tabindex="-1" id="'+a+'_ctl01_ctl47_ctl00"></iframe><div id="'+a+'_ctl01_ctl47_ctl01" style="display: none;"><div class="ajax__htmleditor_attachedpopup_default"><table cellspacing="0" cellpadding="2" border="0"><tbody><tr><td align="left">URL:</td><td align="left"><input type="text" name="'+a+'$ctl01$ctl47$ctl05" maxlength="255" id="'+a+'_ctl01_ctl47_ctl05" style="width: 200px;" /></td></tr><tr><td align="left">Target:</td><td align="left"><select name="'+a+'$ctl01$ctl47$ctl07" id="'+a+'_ctl01_ctl47_ctl07" style="width: 105px;"><option value="_blank">New window</option><option value="_self">Current window</option><option value="_parent">Parent window</option><option value="_top">Top window</option></select></td></tr></tbody></table><table cellspacing="0" cellpadding="0" border="0" style="width: 100%;"><tbody><tr><td align="right"><div id="'+a+'_ctl01_ctl47_ctl09" class="ajax__htmleditor_popup_boxbutton ajax__htmleditor_popup_confirmbutton"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td align="center" valign="middle" class="ajax__htmleditor_popup_bgibutton">OK</td></tr></tbody></table></div><div id="'+a+'_ctl01_ctl47_ctl10" class="ajax__htmleditor_popup_boxbutton ajax__htmleditor_popup_confirmbutton"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td align="center" valign="middle" class="ajax__htmleditor_popup_bgibutton">Cancel</td></tr></tbody></table></div></td></tr></tbody></table></div></div></div><img src="none" alt="" id="'+a+'_ctl01_ctl48" title="Remove Link" class="ajax__htmleditor_toolbar_button" style="display: none;" /></div></td></tr><tr><td class="ajax__htmleditor_editor_editpanel"'+(Sys.Extended.UI.HTMLEditor.isIE?'style="height: expression(Sys.Extended.UI.HTMLEditor.Editor.MidleCellHeightForIE(this.parentNode.parentNode.parentNode,this.parentNode));"':rb)+'><div id="'+a+'_ctl02" style="width: 100%; height:100%;"><iframe frameborder="0" id="'+a+'_ctl02_ctl00" name="'+a+'_ctl02_ctl00" marginheight="0" marginwidth="0" style="border-width: 0px; height: 100%; width: 100%; display: none;"></iframe><textarea id="'+a+'_ctl02_ctl01" class="ajax__htmleditor_htmlpanel_default" style="height: 100%; width: 100%; display: none;"></textarea><iframe frameborder="0" id="'+a+'_ctl02_ctl02" name="'+a+'_ctl02_ctl02" marginheight="0" marginwidth="0" style="border-width: 0px; height: 100%; width: 100%; display: none;"></iframe></div></td></tr><tr><td class="ajax__htmleditor_editor_bottomtoolbar"><div id="'+a+'_ctl03"><img src="none" alt="" id="'+a+'_ctl03_ctl00" title="Design mode" class="ajax__htmleditor_toolbar_button" /><img src="none" alt="" id="'+a+'_ctl03_ctl01" title="HTML text" class="ajax__htmleditor_toolbar_button" /><img src="none" alt="" id="'+a+'_ctl03_ctl02" title="Preview" class="ajax__htmleditor_toolbar_button" /></div></td></tr></tbody></table>';if(d.style.height.length>0)f.firstChild.style.height=d.style.height;if(d.style.width.length>0)f.firstChild.style.width=d.style.width;d.style.display=u;var h=document.createElement(ab);h.innerHTML='<input name="_contentChanged_'+a+'_ctl02" id="_contentChanged_'+a+'_ctl02" type="hidden" /><input name="_contentForce_'+a+'_ctl02" value="1" id="_contentForce_'+a+'_ctl02" type="hidden" /><input name="_content_'+a+'_ctl02" id="_content_'+a+'_ctl02" type="hidden" value="'+(d.value!=pb&&typeof d.value!=tb?d.value.replace(/\"/g,zd):rb)+'" /><input name="_activeMode_'+a+'_ctl02" value="0" id="_activeMode_'+a+'_ctl02" type="hidden" />';while(h.firstChild)d.parentNode.insertBefore(h.firstChild,d);delete h;d.parentNode.insertBefore(f,d);c._editor=pb;c._editorElement=f;if(Sys.loader){var e=Sys.loader.basePath||rb;if(e)if(e.charAt(e.length-1)!==wd)e+=wd;c._imagesPath=e+"extended/htmleditor/images/";c._popupCss=e+"extended/htmleditor/AttachedTemplatePopup.css";c._designPanelCss=e+"extended/htmleditor/DesignPane.css";c._documentCss=e+"extended/htmleditor/Document.css"}else{c._imagesPath=rb;c._popupCss=rb;c._designPanelCss=rb;c._documentCss=rb}$create(Sys.Extended.UI.HTMLEditor.EditPanel,{activeModeElement:$get("_activeMode_"+a+b),contentChangedElement:$get("_contentChanged_"+a+b),contentElement:$get("_content_"+a+b),contentForceElement:$get("_contentForce_"+a+b),designPanelCssPath:c.get_designPanelCss(),documentCssPath:c.get_documentCss(),"imagePath_1x1":c.get_imagesPath()+"ed_1x1.gif",imagePath_anchor:c.get_imagesPath()+"ed_anchor.gif",imagePath_flash:c.get_imagesPath()+"ed_flash.gif",imagePath_media:c.get_imagesPath()+"ed_media.gif",imagePath_placeHolder:c.get_imagesPath()+"ed_placeHolder.gif",modePanelIds:a+"_ctl02_ctl00;"+a+"_ctl02_ctl01;"+a+g,toolbarIds:a+"_ctl03;"+a+Hd},pb,pb,$get(a+b));$create(Sys.Extended.UI.HTMLEditor.DesignPanel,pb,pb,{editPanel:a+b},$get(a+"_ctl02_ctl00"));$create(Sys.Extended.UI.HTMLEditor.HtmlPanel,pb,pb,{editPanel:a+b},$get(a+"_ctl02_ctl01"));$create(Sys.Extended.UI.HTMLEditor.PreviewPanel,pb,pb,{editPanel:a+b},$get(a+g));$create(Sys.Extended.UI.HTMLEditor.Editor,pb,pb,pb,$get(a));c._editor=$find(a);c.get_editor().set_editPanel($find(a+b))};Sys.Extended.UI.HTMLEditor.ClientSideEditor.prototype={get_height:function(){return Sys.Extended.UI.HTMLEditor.getStyle(this._editorElement.firstChild,yd)},set_height:function(a){this._editorElement.firstChild.style.height=a},get_width:function(){return Sys.Extended.UI.HTMLEditor.getStyle(this._editorElement.firstChild,xd)},set_width:function(a){this._editorElement.firstChild.style.width=a},get_autofocus:function(){return this.get_editor().get_autofocus()},set_autofocus:function(a){this.get_editor().set_autofocus(a)},get_content:function(){return this.get_editor().get_content()},set_content:function(a){this.get_editor().set_content(a)},get_activeMode:function(){return this.get_editor().get_activeMode()},set_activeMode:function(a){this.get_editor().set_activeMode(a)},get_imagesPath:function(){return this._imagesPath},set_imagesPath:function(a){this._imagesPath=a.length&&a.length>0?a.lastIndexOf(wd)==a.length-1?a:a+wd:rb},get_popupCss:function(){return this._popupCss},set_popupCss:function(a){this._popupCss=a},get_designPanelCss:function(){return this._designPanelCss},set_designPanelCss:function(a){this._designPanelCss=a},get_documentCss:function(){return this._documentCss},set_documentCss:function(a){this._documentCss=a},get_editor:function(){return this._editor},initialize:function(){var G="_ctl03_ctl02",F="ed_preview_a.gif",E="ed_html_a.gif",D="ed_design_a.gif",e="0;1;2",C="_ctl01_ctl48",B="_ctl01_ctl47",A="ed_removealign_a.gif",z="ed_align_justify_a.gif",y="ed_align_right_a.gif",x="ed_align_center_a.gif",w="ed_align_left_a.gif",v="ed_format_paragraph_a.gif",u="_ctl01_FixedBackColor",t="_ctl01_FixedBackColor_ctl02",s="_ctl01_FixedBackColor_ctl01",d="_ctl01_ctl14",r="ed_selector_n.gif",q="ed_selector_a.gif",p="_ctl01_FixedForeColor",o="_ctl01_FixedForeColor_ctl02",n="_ctl01_FixedForeColor_ctl01",m="ed_format_rtl_a.gif",l="ed_format_ltr_a.gif",k="ed_format_sup_a.gif",j="ed_format_sub_a.gif",i="ed_format_strike_a.gif",h="ed_format_underline_a.gif",g="ed_format_italic_a.gif",f="ed_format_bold_a.gif",c="ed_sep.gif",b=this,a=b.__id__;$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Undo,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_undo_a.gif",normalSrc:b.get_imagesPath()+"ed_undo_n.gif"},pb,pb,$get(a+"_ctl01_ctl00"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Redo,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_redo_a.gif",normalSrc:b.get_imagesPath()+"ed_redo_n.gif"},pb,pb,$get(a+"_ctl01_ctl01"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl02"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Bold,{activeModesIds:ic,activeSrc:b.get_imagesPath()+f,downSrc:b.get_imagesPath()+f,normalSrc:b.get_imagesPath()+"ed_format_bold_n.gif"},pb,pb,$get(a+"_ctl01_ctl03"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Italic,{activeModesIds:ic,activeSrc:b.get_imagesPath()+g,downSrc:b.get_imagesPath()+g,normalSrc:b.get_imagesPath()+"ed_format_italic_n.gif"},pb,pb,$get(a+"_ctl01_ctl04"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Underline,{activeModesIds:ic,activeSrc:b.get_imagesPath()+h,downSrc:b.get_imagesPath()+h,normalSrc:b.get_imagesPath()+"ed_format_underline_n.gif"},pb,pb,$get(a+"_ctl01_ctl05"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.StrikeThrough,{activeModesIds:ic,activeSrc:b.get_imagesPath()+i,downSrc:b.get_imagesPath()+i,normalSrc:b.get_imagesPath()+"ed_format_strike_n.gif"},pb,pb,$get(a+"_ctl01_ctl06"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.SubScript,{activeModesIds:ic,activeSrc:b.get_imagesPath()+j,downSrc:b.get_imagesPath()+j,normalSrc:b.get_imagesPath()+"ed_format_sub_n.gif"},pb,pb,$get(a+"_ctl01_ctl07"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.SuperScript,{activeModesIds:ic,activeSrc:b.get_imagesPath()+k,downSrc:b.get_imagesPath()+k,normalSrc:b.get_imagesPath()+"ed_format_sup_n.gif"},pb,pb,$get(a+"_ctl01_ctl08"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl09"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Ltr,{activeModesIds:ic,activeSrc:b.get_imagesPath()+l,downSrc:b.get_imagesPath()+l,normalSrc:b.get_imagesPath()+"ed_format_ltr_n.gif"},pb,pb,$get(a+"_ctl01_ctl10"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Rtl,{activeModesIds:ic,activeSrc:b.get_imagesPath()+m,downSrc:b.get_imagesPath()+m,normalSrc:b.get_imagesPath()+"ed_format_rtl_n.gif"},pb,pb,$get(a+"_ctl01_ctl11"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl12"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_forecolor_a.gif",normalSrc:b.get_imagesPath()+"ed_forecolor_n.gif"},pb,pb,$get(a+n));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton,{activeModesIds:ic},pb,pb,$get(a+o));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedForeColor,{activeModesIds:ic,defaultColor:"#FF0000"},pb,{colorDiv:a+o,methodButton:a+n},$get(a+p));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorSelector,{activeModesIds:ic,autoClose:sb,downSrc:b.get_imagesPath()+q,normalSrc:b.get_imagesPath()+r},pb,{fixedColorButton:a+p,relatedPopup:a+d},$get(a+"_ctl01_ctl13"));$create(Sys.Extended.UI.HTMLEditor.Popups.BaseColorsPopup,{contentDiv:$get(a+"_ctl01_ctl14_ctl01"),cssPath:b.get_popupCss(),iframe:$get(a+"_ctl01_ctl14_ctl00"),registeredFields:"[]",registeredHandlers:"[]"},pb,pb,$get(a+d));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.ForeColorClear,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_color_fg_clear_a.gif",normalSrc:b.get_imagesPath()+"ed_color_fg_clear_n.gif"},pb,pb,$get(a+"_ctl01_ctl15"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl16"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_backcolor_a.gif",normalSrc:b.get_imagesPath()+"ed_backcolor_n.gif"},pb,pb,$get(a+s));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignModeBoxButton,{activeModesIds:ic},pb,pb,$get(a+t));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.FixedBackColor,{activeModesIds:ic,defaultColor:"#FFFF00"},pb,{colorDiv:a+t,methodButton:a+s},$get(a+u));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorSelector,{activeModesIds:ic,autoClose:sb,downSrc:b.get_imagesPath()+q,normalSrc:b.get_imagesPath()+r},pb,{fixedColorButton:a+u,relatedPopup:a+d},$get(a+"_ctl01_ctl17"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.BackColorClear,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_color_bg_clear_a.gif",normalSrc:b.get_imagesPath()+"ed_color_bg_clear_n.gif"},pb,pb,$get(a+"_ctl01_ctl18"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl19"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_unformat_a.gif",normalSrc:b.get_imagesPath()+"ed_unformat_n.gif"},pb,pb,$get(a+"_ctl01_ctl20"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl21"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.FontName,{activeModesIds:ic},pb,pb,$get(a+"_ctl01_ctl22"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl23"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.FontSize,{activeModesIds:ic},pb,pb,$get(a+"_ctl01_ctl24"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl25"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Cut,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_cut_a.gif",normalSrc:b.get_imagesPath()+"ed_cut_n.gif"},pb,pb,$get(a+"_ctl01_ctl26"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Copy,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_copy_a.gif",normalSrc:b.get_imagesPath()+"ed_copy_n.gif"},pb,pb,$get(a+"_ctl01_ctl27"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Paste,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_paste_a.gif",normalSrc:b.get_imagesPath()+"ed_paste_n.gif"},pb,pb,$get(a+"_ctl01_ctl28"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteText,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_pasteText_a.gif",normalSrc:b.get_imagesPath()+"ed_pasteText_n.gif"},pb,pb,$get(a+"_ctl01_ctl29"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.PasteWord,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_pasteWord_a.gif",normalSrc:b.get_imagesPath()+"ed_pasteWord_n.gif"},pb,pb,$get(a+"_ctl01_ctl30"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl31"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.DecreaseIndent,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_indent_less_a.gif",normalSrc:b.get_imagesPath()+"ed_indent_less_n.gif"},pb,pb,$get(a+"_ctl01_ctl32"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.IncreaseIndent,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_indent_more_a.gif",normalSrc:b.get_imagesPath()+"ed_indent_more_n.gif"},pb,pb,$get(a+"_ctl01_ctl33"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl34"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.Paragraph,{activeModesIds:ic,activeSrc:b.get_imagesPath()+v,downSrc:b.get_imagesPath()+v,normalSrc:b.get_imagesPath()+"ed_format_paragraph_n.gif"},pb,pb,$get(a+"_ctl01_ctl35"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyLeft,{activeModesIds:ic,activeSrc:b.get_imagesPath()+w,downSrc:b.get_imagesPath()+w,normalSrc:b.get_imagesPath()+"ed_align_left_n.gif"},pb,pb,$get(a+"_ctl01_ctl36"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyCenter,{activeModesIds:ic,activeSrc:b.get_imagesPath()+x,downSrc:b.get_imagesPath()+x,normalSrc:b.get_imagesPath()+"ed_align_center_n.gif"},pb,pb,$get(a+"_ctl01_ctl37"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyRight,{activeModesIds:ic,activeSrc:b.get_imagesPath()+y,downSrc:b.get_imagesPath()+y,normalSrc:b.get_imagesPath()+"ed_align_right_n.gif"},pb,pb,$get(a+"_ctl01_ctl38"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.JustifyFull,{activeModesIds:ic,activeSrc:b.get_imagesPath()+z,downSrc:b.get_imagesPath()+z,normalSrc:b.get_imagesPath()+"ed_align_justify_n.gif"},pb,pb,$get(a+"_ctl01_ctl39"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveAlignment,{activeModesIds:ic,activeSrc:b.get_imagesPath()+A,downSrc:b.get_imagesPath()+A,normalSrc:b.get_imagesPath()+"ed_removealign_n.gif"},pb,pb,$get(a+"_ctl01_ctl40"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl41"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.OrderedList,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_list_num_a.gif",normalSrc:b.get_imagesPath()+"ed_list_num_n.gif"},pb,pb,$get(a+"_ctl01_ctl42"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.BulletedList,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_list_bullet_a.gif",normalSrc:b.get_imagesPath()+"ed_list_bullet_n.gif"},pb,pb,$get(a+"_ctl01_ctl43"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HorizontalSeparator,{activeModesIds:ic,normalSrc:b.get_imagesPath()+c},pb,pb,$get(a+"_ctl01_ctl44"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertHR,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_rule_a.gif",normalSrc:b.get_imagesPath()+"ed_rule_n.gif"},pb,pb,$get(a+"_ctl01_ctl45"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.InsertLink,{activeModesIds:ic,autoClose:qb,downSrc:b.get_imagesPath()+"ed_link_a.gif",normalSrc:b.get_imagesPath()+"ed_link_n.gif"},pb,{relatedPopup:a+B},$get(a+"_ctl01_ctl46"));$create(Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton,{name:"OK"},pb,pb,$get(a+"_ctl01_ctl47_ctl09"));$create(Sys.Extended.UI.HTMLEditor.Popups.PopupBGIButton,{name:"Cancel"},pb,pb,$get(a+"_ctl01_ctl47_ctl10"));$create(Sys.Extended.UI.HTMLEditor.Popups.LinkProperties,{contentDiv:$get(a+"_ctl01_ctl47_ctl01"),cssPath:b.get_popupCss(),defaultTarget:I,iframe:$get(a+"_ctl01_ctl47_ctl00"),registeredFields:"[{name: 'url', clientID: '"+a+"_ctl01_ctl47_ctl05'},{name: 'target', clientID: '"+a+"_ctl01_ctl47_ctl07'}]",registeredHandlers:"[{name: 'OK', clientID: '"+a+"_ctl01_ctl47_ctl09', callMethod: null},{name: 'Cancel', clientID: '"+a+"_ctl01_ctl47_ctl10', callMethod: null}]"},pb,pb,$get(a+B));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveLink,{activeModesIds:ic,downSrc:b.get_imagesPath()+"ed_unlink_a.gif",normalSrc:b.get_imagesPath()+"ed_unlink_n.gif"},pb,pb,$get(a+C));$create(Sys.Extended.UI.HTMLEditor.Toolbar,{buttonIds:a+"_ctl01_ctl00;"+a+"_ctl01_ctl01;"+a+"_ctl01_ctl02;"+a+"_ctl01_ctl03;"+a+"_ctl01_ctl04;"+a+"_ctl01_ctl05;"+a+"_ctl01_ctl06;"+a+"_ctl01_ctl07;"+a+"_ctl01_ctl08;"+a+"_ctl01_ctl09;"+a+"_ctl01_ctl10;"+a+"_ctl01_ctl11;"+a+"_ctl01_ctl12;"+a+"_ctl01_FixedForeColor;"+a+"_ctl01_ctl13;"+a+"_ctl01_ctl15;"+a+"_ctl01_ctl16;"+a+"_ctl01_FixedBackColor;"+a+"_ctl01_ctl17;"+a+"_ctl01_ctl18;"+a+"_ctl01_ctl19;"+a+"_ctl01_ctl20;"+a+"_ctl01_ctl21;"+a+"_ctl01_ctl22;"+a+"_ctl01_ctl23;"+a+"_ctl01_ctl24;"+a+"_ctl01_ctl25;"+a+"_ctl01_ctl26;"+a+"_ctl01_ctl27;"+a+"_ctl01_ctl28;"+a+"_ctl01_ctl29;"+a+"_ctl01_ctl30;"+a+"_ctl01_ctl31;"+a+"_ctl01_ctl32;"+a+"_ctl01_ctl33;"+a+"_ctl01_ctl34;"+a+"_ctl01_ctl35;"+a+"_ctl01_ctl36;"+a+"_ctl01_ctl37;"+a+"_ctl01_ctl38;"+a+"_ctl01_ctl39;"+a+"_ctl01_ctl40;"+a+"_ctl01_ctl41;"+a+"_ctl01_ctl42;"+a+"_ctl01_ctl43;"+a+"_ctl01_ctl44;"+a+"_ctl01_ctl45;"+a+"_ctl01_ctl46;"+a+C},pb,pb,$get(a+Hd));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.DesignMode,{activeModesIds:e,activeSrc:b.get_imagesPath()+D,downSrc:b.get_imagesPath()+D,normalSrc:b.get_imagesPath()+"ed_design_n.gif"},pb,pb,$get(a+"_ctl03_ctl00"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.HtmlMode,{activeMode:1,activeModesIds:e,activeSrc:b.get_imagesPath()+E,downSrc:b.get_imagesPath()+E,normalSrc:b.get_imagesPath()+"ed_html_n.gif"},pb,pb,$get(a+"_ctl03_ctl01"));$create(Sys.Extended.UI.HTMLEditor.ToolbarButton.PreviewMode,{activeMode:2,activeModesIds:e,activeSrc:b.get_imagesPath()+F,downSrc:b.get_imagesPath()+F,normalSrc:b.get_imagesPath()+"ed_preview_n.gif"},pb,pb,$get(a+G));$create(Sys.Extended.UI.HTMLEditor.Toolbar,{alwaysVisible:sb,buttonIds:a+"_ctl03_ctl00;"+a+"_ctl03_ctl01;"+a+G},pb,pb,$get(a+"_ctl03"));b.get_editor().set_changingToolbar($find(a+Hd));if(Sys.Extended.UI.HTMLEditor.isIE&&Sys.Browser.version==8&&document.compatMode!=db){b.get_editor()._saved_set_activeEditPanel=b.get_editor().get_changingToolbar().set_activeEditPanel;b.get_editor()._saved_disable=b.get_editor().get_changingToolbar().disable;b.get_editor().get_changingToolbar().set_activeEditPanel=Function.createDelegate(b.get_editor(),b.get_editor()._set_activeEditPanel);b.get_editor().get_changingToolbar().disable=Function.createDelegate(b.get_editor(),b.get_editor()._disable)}Sys.Extended.UI.HTMLEditor.ClientSideEditor.callBaseMethod(b,H)},dispose:function(){Sys.Extended.UI.HTMLEditor.ClientSideEditor.callBaseMethod(this,d)}};Sys.Extended.UI.HTMLEditor.ClientSideEditor.registerClass("Sys.Extended.UI.HTMLEditor.ClientSideEditor",Sys.UI.Control)}if(window.Sys&&Sys.loader)Sys.loader.registerScript(scriptName,["ExtendedDynamicPopulate"],execute);else execute()})();