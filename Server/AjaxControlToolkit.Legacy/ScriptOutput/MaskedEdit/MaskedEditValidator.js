// (c) 2010 CodePlex Foundation
function MaskedEditSetMessage(a,b,c){a.errormessage=b;if(c=="")a.text=b;else a.text=c;a.innerHTML=a.text}function MaskedEditMessageShow(a,b){if(typeof a.display=="string"){if(a.display=="None")return;if(a.display=="Dynamic"){a.style.display=b?"none":"inline";return}}a.style.visibility=b?"hidden":"visible"}function MaskedEditSetCssClass(b,c){var a=$get(b.TargetValidator);Sys.UI.DomElement.removeCssClass(a,b.InvalidValueCssClass);Sys.UI.DomElement.removeCssClass(a,b.CssBlurNegative);Sys.UI.DomElement.removeCssClass(a,b.CssFocus);Sys.UI.DomElement.removeCssClass(a,b.CssFocusNegative);c!=""&&Sys.UI.DomElement.addCssClass(a,c)}function MaskedEditValidatorDateTime(a){var f=false,d=true,b="";MaskedEditSetMessage(a,b,b);MaskedEditSetCssClass(a,b);MaskedEditMessageShow(a,d);if(a.IsMaskedEdit=="false")return d;var e=$get(a.TargetValidator);if(a.ValidEmpty=="false")if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(e).get_Value()==a.InitialValue){MaskedEditSetMessage(a,a.EmptyValueMessage,a.EmptyValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,f);return f}if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(e).get_Value()==b)return d;var c=d,g=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(e).get_Value();if(a.ValidationExpression!=b){var p=new RegExp(a.ValidationExpression),h=p.exec(g);c=h!=null&&g==h[0];if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,f);return f}}var m=e.MaskedEditBehavior.AutoFormatDate(),n=e.MaskedEditBehavior.AutoFormatTime(),k=b,l=b;if(a.MinimumValue!=b){k=a.MinimumValue.split(" ")[0];l=a.MinimumValue.split(" ")[1]}var i=b,j=b;if(a.MaximumValue!=b){i=a.MaximumValue.split(" ")[0];j=a.MaximumValue.split(" ")[1]}c=MaskedEditValidatorPartDate(a,m,k,i);if(c)c=MaskedEditValidatorPartTime(a,n,l,j);if(c&&a.ClientValidationFunction!=b){var o={Value:g,IsValid:d};eval(a.ClientValidationFunction+"(value, args);");c=o.IsValid;if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}!c&&MaskedEditMessageShow(a,c);return c}function MaskedEditValidatorPartTime(b,n,h,g){var a=10,e=-1,x="([0-5][0-9])\\s(",w="([0-5][0-9])",k=true,j=b.TimeSeparator,y=b.AmPmSymbol,v=y.split(";"),z=y.replace(";","|"),A="^(^([0][0-9]|[1][0-2])"+j+w+j+x+z+")$)|(^([0][0-9]|[1][0-2])"+j+x+z+")$)$",B="^(^([0-1][0-9]|[2][0-3])"+j+w+j+"([0-5][0-9])$)|(^([0-1][0-9]|[2][0-3])"+j+"([0-5][0-9])$)$",f=e,p=e,s=e,r="",q=n.split(j),t=new RegExp(A),l=t.exec(n),u=new RegExp(B),m=u.exec(n);if(l&&l[0]==n){r=n.substring(n.length-2).substring(0,1);f=parseInt(q[0],a);if(r.toUpperCase()==v[1].substring(0,1).toUpperCase()){f+=12;if(f==24)f=12}p=parseInt(q[1],a);s=b.length>9?parseInt(q[2].substring(0,2),a):0}else if(m&&m[0]==n){f=parseInt(q[0],a);p=parseInt(q[1],a);s=n.length>5?parseInt(q[2],a):0}if(f==e||p==e||s==e)k=false;if(!k){MaskedEditSetMessage(b,b.InvalidValueMessage,b.InvalidValueText);MaskedEditSetCssClass(b,b.InvalidValueCssClass)}if(k&&(g!=""||h!="")){var c,i,o,d;if(h!=""){c=e;i=e;o=e;d=h.split(j);l=t.exec(h);m=u.exec(h);if(l&&l[0]==h){r=h.substring(h.length-2).substring(0,1);c=parseInt(d[0],a);if(r.toUpperCase()==v[1].substring(0,1).toUpperCase()){c+=12;if(c==24)c=0}i=parseInt(d[1],a);o=h.length>9?parseInt(d[2].substring(0,2),a):0}else if(m&&m[0]==h){c=parseInt(d[0],a);i=parseInt(d[1],a);o=h.length>5?parseInt(d[2],a):0}k=f>c||f==c&&p>i||f==c&&p==i&&s>=o;if(!k){MaskedEditSetMessage(b,b.MinimumValueMessage,b.MinimumValueText);MaskedEditSetCssClass(b,b.InvalidValueCssClass)}}if(g!=""&&k){c=e;i=e;o=e;d=g.split(j);l=t.exec(g);m=u.exec(g);if(l&&l[0]==g){r=g.substring(g.length-2).substring(0,1);c=parseInt(d[0],a);if(r.toUpperCase()==v[1].substring(0,1).toUpperCase()){c+=12;if(c==24)c=0}i=parseInt(d[1],a);o=g.length>9?parseInt(d[2].substring(0,2),a):0}else if(m&&m[0]==g){c=parseInt(d[0],a);i=parseInt(d[1],a);o=g.length>5?parseInt(d[2],a):0}k=f<c||f==c&&p<i||f==c&&p==i&&s<=o;if(!k){MaskedEditSetMessage(b,b.MaximumValueMessage,b.MaximumValueText);MaskedEditSetCssClass(b,b.InvalidValueCssClass)}}}return k}function MaskedEditValidatorPartDate(a,p,o,n){var e=10,c=true,b="MDY";switch(a.DateFormat){case"DayMonthYear":b="DMY";break;case"DayYearMonth":b="DYM";break;case"MonthDayYear":b="MDY";break;case"MonthYearDay":b="MYD";break;case"YearDayMonth":b="YDM";break;case"YearMonthDay":b="YMD"}var m=a.DateSeparator,l=p.split(m);if(parseInt(l.length,e)!=3){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);c=false}if(b.indexOf("D")==-1||b.indexOf("M")==-1||b.indexOf("Y")==-1){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);c=false}var k=-1,i=-1,d=-1;if(c){k=parseInt(l[b.indexOf("D")],e);i=parseInt(l[b.indexOf("M")],e);d=parseInt(l[b.indexOf("Y")],e);c=k>0&&i>0&&d>0&&(k<=([,31,28,31,30,31,30,31,31,30,31,30,31])[i]||k==29&&i==2&&d%4==0&&(d%100>0||d%400==0))}if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}if(c&&(n!=""||o!="")){var g,j=-1,h=-1,f=-1;if(o!=""){g=o.split(m);j=parseInt(g[b.indexOf("D")],e);h=parseInt(g[b.indexOf("M")],e);f=parseInt(g[b.indexOf("Y")],e);c=j>0&&h>0&&f>0&&d>f||d==f&&i>h||d==f&&i==h&&k>=j;if(!c){MaskedEditSetMessage(a,a.MinimumValueMessage,a.MinimumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}if(c&&n!=""){g=n.split(m);j=parseInt(g[b.indexOf("D")],e);h=parseInt(g[b.indexOf("M")],e);f=parseInt(g[b.indexOf("Y")],e);c=j>0&&h>0&&f>0&&d<f||d==f&&i<h||d==f&&i==h&&k<=j;if(!c){MaskedEditSetMessage(a,a.MaximumValueMessage,a.MaximumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}}return c}function MaskedEditValidatorDate(a){var d=false,c=true;MaskedEditSetMessage(a,"","");MaskedEditSetCssClass(a,"");MaskedEditMessageShow(a,c);if(a.IsMaskedEdit=="false")return c;var f=$get(a.TargetValidator);if(a.ValidEmpty=="false")if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value()==a.InitialValue){MaskedEditSetMessage(a,a.EmptyValueMessage,a.EmptyValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value()=="")return c;var b=c,e=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value();if(a.ValidationExpression!=""){var i=new RegExp(a.ValidationExpression),g=i.exec(e);b=g!=null&&e==g[0];if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}}b=MaskedEditValidatorPartDate(a,e,a.MinimumValue,a.MaximumValue);if(b&&a.ClientValidationFunction!=""){var h={Value:e,IsValid:c};eval(a.ClientValidationFunction+"(value, args);");b=h.IsValid;if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}!b&&MaskedEditMessageShow(a,b);return b}function MaskedEditValidatorTime(a){var d=false,c=true;MaskedEditSetMessage(a,"","");MaskedEditSetCssClass(a,"");MaskedEditMessageShow(a,c);if(a.IsMaskedEdit=="false")return c;var f=$get(a.TargetValidator);if(a.ValidEmpty=="false")if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value()==a.InitialValue){MaskedEditSetMessage(a,a.EmptyValueMessage,a.EmptyValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value()=="")return c;var b=c,e=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(f).get_Value();if(a.ValidationExpression!=""){var i=new RegExp(a.ValidationExpression),g=i.exec(e);b=g!=null&&e==g[0];if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}}b=MaskedEditValidatorPartTime(a,e,a.MinimumValue,a.MaximumValue);if(b&&a.ClientValidationFunction!=""){var h={Value:e,IsValid:c};eval(a.ClientValidationFunction+"(value, args);");b=h.IsValid;if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}!b&&MaskedEditMessageShow(a,b);return b}function MaskedEditValidatorNumber(a){var d=null,i=false,j=true,e="";MaskedEditSetMessage(a,e,e);MaskedEditSetCssClass(a,e);MaskedEditMessageShow(a,j);if(a.IsMaskedEdit=="false")return j;var p=$get(a.TargetValidator),o=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(p).get_Value().replace(new RegExp("([w_.,s$ ])","g"),e);if(a.ValidEmpty=="false")if(o==a.InitialValue){MaskedEditSetMessage(a,a.EmptyValueMessage,a.EmptyValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,i);return i}if(o==e)return j;var c=j,r=a.Thousands,q=a.Decimal,m=a.Money,u=a.LastMaskPosition+m.length+1,g=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(p).get_Value();if(a.ValidationExpression!=e){var t=new RegExp(a.ValidationExpression),n=t.exec(g);c=n!=d&&g==n[0];if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,i);return i}}c=i;var k=d,l=d,f=d,h=d,b=d;g=g.replace(new RegExp("(\\"+r+")","g"),e);g=g.replace(new RegExp("(\\"+m+")","g"),e);f=g.match(/^\s*(\S+(\s+\S+)*)\s*$/);if(f!=d)g=f[1];l=/^\s*[-\+]?\d+\s*$/;if(g.match(l)!=d){h=parseInt(g,10);c=h==(isNaN(h)?d:h)}if(c){if(a.MaximumValue!=e){b=parseInt(a.MaximumValue,10);if(b==(isNaN(b)?d:b))if(h>b){c=i;MaskedEditSetMessage(a,a.MaximumValueMessage,a.MaximumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}if(c&&a.MinimumValue!=e){b=parseInt(a.MinimumValue,10);if(b==(isNaN(b)?d:b))if(h<b){c=i;MaskedEditSetMessage(a,a.MinimumValueMessage,a.MinimumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}}else{l=new RegExp("^\\s*([-\\+])?(\\d+)?(\\"+q+"(\\d+))?\\s*$");f=g.match(l);if(f!=d){k=d;if(typeof f[1]!="undefined")k=f[1]+(f[2].length>0?f[2]:"0")+"."+f[4];else k=(f[2].length>0?f[2]:"0")+"."+f[4];h=parseFloat(k);c=h==(isNaN(h)?d:h)}if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}if(c){if(a.MaximumValue!=e){b=parseFloat(a.MaximumValue);if(b==(isNaN(b)?d:b))if(h>b){c=i;MaskedEditSetMessage(a,a.MaximumValueMessage,a.MaximumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}if(c&&a.MinimumValue!=e){b=parseFloat(a.MinimumValue);if(b==(isNaN(b)?d:b))if(h<b){c=i;MaskedEditSetMessage(a,a.MinimumValueMessage,a.MinimumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}}}if(c&&a.ClientValidationFunction!=e){var s={Value:g,IsValid:j};eval(a.ClientValidationFunction+"(value, args);");c=s.IsValid;if(!c){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}!c&&MaskedEditMessageShow(a,c);return c}function MaskedEditValidatorNone(a){var e=null,d=false,f=true;MaskedEditSetMessage(a,"","");MaskedEditSetCssClass(a,"");MaskedEditMessageShow(a,f);if(a.IsMaskedEdit=="false")return f;var h=$get(a.TargetValidator);if(a.ValidEmpty=="false")if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(h).get_Value()==a.InitialValue){MaskedEditSetMessage(a,a.EmptyValueMessage,a.EmptyValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(h).get_Value()=="")return f;var b=f,g=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(h).get_Value();if(a.ValidationExpression!=""){var l=new RegExp(a.ValidationExpression),i=l.exec(g);b=i!=e&&g==i[0];if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass);MaskedEditMessageShow(a,d);return d}}var j=/^\d+\s*$/,c=e;if(a.MaximumValue!="")if(a.MaximumValue.match(j)!=e){c=parseInt(a.MaximumValue,10);if(c==(isNaN(c)?e:c))if(g.length>c){b=d;MaskedEditSetMessage(a,a.MaximumValueMessage,a.MaximumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}if(b&&a.MinimumValue!="")if(a.MinimumValue.match(j)!=e){c=parseInt(a.MinimumValue,10);if(c==(isNaN(c)?e:c))if(g.length<c){b=d;MaskedEditSetMessage(a,a.MinimumValueMessage,a.MinimumValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}if(b&&a.ClientValidationFunction!=""){var k={Value:g,IsValid:f};eval(a.ClientValidationFunction+"(value, args);");b=k.IsValid;if(!b){MaskedEditSetMessage(a,a.InvalidValueMessage,a.InvalidValueText);MaskedEditSetCssClass(a,a.InvalidValueCssClass)}}!b&&MaskedEditMessageShow(a,b);return b};