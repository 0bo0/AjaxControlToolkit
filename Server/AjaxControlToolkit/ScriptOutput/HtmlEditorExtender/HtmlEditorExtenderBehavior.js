// (c) 2010 CodePlex Foundation
(function(){var a=null,d="HtmlEditorExtenderBehavior",b=a;function c(){var g="ToolbarButtons",c=false,e="blur",d=true,f="unselectable";Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.HtmlEditorExtenderButton=function(){var b=this;b._name=a;b._iconIndex=a;b._title=a;b._offset=a};Sys.Extended.UI.HtmlEditorExtenderButton.prototype={get_Name:function(){return this._name},set_Name:function(){if(this._name!=value){this._name=value;this.raisePropertyChanged("Name")}},get_Title:function(){return this._title+"test-prototype-success"},set_Title:function(){if(this._title!=value){this._title=value;this.raisePropertyChanged("Title")}},get_IconIndex:function(){return this._iconIndex},set_IconIndex:function(){if(this._iconIndex!=value){this._iconIndex=value;this.raisePropertyChanged("IconIndex")}},get_Offset:function(){return this._offset},set_Offset:function(){if(this._iconIndex!=value){this._iconIndex=value;this.raisePropertyChanged("Offset")}}};Sys.Extended.UI.HtmlEditorExtenderButton.registerClass("Sys.Extended.UI.HtmlEditorExtenderButton");Sys.Extended.UI.HtmlEditorExtenderBehavior=function(g){var c=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.initializeBase(c,[g]);b=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(g);var e=c.get_id();c._ButtonWidth=23;c._ButtonHeight=21;c._containerTemplate={nodeName:"div",properties:{id:e+"_ExtenderContainer"},cssClasses:[f]};c._editableTemplate={nodeName:"div",properties:{id:e+"_ExtenderContentEditable",style:{width:"100%",height:"100%",borderStyle:"outset",overflow:"scroll",clear:"both"},contentEditable:d}};c._buttonTemplate={nodeName:"input",properties:{type:"button",style:{width:c._ButtonWidth+"px",height:c._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button"]};c._topButtonContainerTemplate={nodeName:"div",properties:{id:e+"_ExtenderButtonContainer"}};c._container=a;c._ToolbarButtons=a;c._editableDiv=a;c._topButtonContainer=a;c._buttons=[];c._btnClickHandler=a;c._requested_buttons=[]};Sys.Extended.UI.HtmlEditorExtenderBehavior.prototype={initialize:function(){var c=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(c,"initialize");var h=0;c._button_list=[];c._createContainer();c._createTopButtonContainer();c._createEditableDiv(c._textbox);c._createButton();var f=b._element.parentNode;while(f!=a&&f.nodeName!="FORM")f=f.parentNode;if(f==a)throw"Missing Form tag";$addHandler(b._element,e,c._textBox_onblur,d);$addHandler(c._editableDiv,e,c._editableDiv_onblur,d);$addHandler(f,"submit",c._editableDiv_submit,d);c._btnClickHandler=Function.createDelegate(c,c._executeCommand);for(var g=0;g<c._buttons.length;g++)$addHandler(c._buttons[g],"click",c._btnClickHandler)},_dispose:function(){var a=this;$removeHandler(b._element,e,a._textBox_onblur);$removeHandler(a._editableDiv,e,a._editableDiv_onblur);$removeHandler(document.forms[0],"submit",a._editableDiv_submit);for(var c=0;c<a._buttons.length;c++)$removeHandler(a._buttons[c],"click",a._btnClickHandler);Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(a,"dispose")},_createContainer:function(){var a=this,c=a.get_element();a._container=$common.createElementFromTemplate(a._containerTemplate,c.parentNode);$common.wrapElement(b._element,a._container,a._container)},_createTopButtonContainer:function(){this._topButtonContainer=$common.createElementFromTemplate(this._topButtonContainerTemplate,this._container)},_createButton:function(){var a=this;for(i=0;i<a._ToolbarButtons.length;i++){var b=$common.createElementFromTemplate(a._buttonTemplate,a._topButtonContainer);b.setAttribute("id",a._ToolbarButtons[i].Name);b.setAttribute("name",a._ToolbarButtons[i].Name);b.setAttribute("title",a._ToolbarButtons[i].Title);b.setAttribute(f,"on");b.style.backgroundPosition=a._ToolbarButtons[i].Offset;Array.add(a._buttons,b)}},_createEditableDiv:function(){var a=this,e=a.get_element();a._editableDiv=$common.createElementFromTemplate(a._editableTemplate,a._container);a._editableDiv.innerHTML=b._element.value;var d=$common.getBounds(b._element);$common.setSize(a._editableDiv,{width:d.width,height:d.height});$common.setVisible(b._element,c)},_editableDiv_onblur:function(){b._element.value=this.innerHTML},_textBox_onblur:function(){this._editableDiv.innerHTML=this.value},_editableDiv_submit:function(){var a=b._element.value.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;");b._element.value=a},_executeCommand:function(b){switch(b.target.title.toUpperCase()){case"BOLD":document.execCommand("Bold",c,a);break;case"ITALIC":document.execCommand("Italic",c,a);break;case"UNDERLINE":document.execCommand("Underline",c,a);break;case"STRIKE THROUGH":document.execCommand("StrikeThrough",c,a);break;case"SUB SCRIPT":document.execCommand("Subscript",c,a);break;case"SUPER SCRIPT":document.execCommand("Superscript",c,a);break;case"JUSTIFY LEFT":document.execCommand("Justifyleft",c,a);break;case"JUSTIFY RIGHT":document.execCommand("Justifyright",c,a);break;case"JUSTIFY CENTER":document.execCommand("Justifycenter",c,a);break;case"INSERT ORDERED LIST":document.execCommand("insertOrderedList",c,a);break;case"INSERT UNORDERED LIST":document.execCommand("insertUnorderedList",c,a)}},get_ButtonWidth:function(){return this._ButtonWidth},set_ButtonWidth:function(a){if(this._ButtonWidth!=a){this._ButtonWidth=a;this.raisePropertyChanged("ButtonWidth")}},get_ButtonHeight:function(){return this._ButtonHeight},set_ButtonHeight:function(a){if(this._ButtonHeight!=a){this._ButtonHeight=a;this.raisePropertyChanged("ButtonHeight")}},get_ToolbarButtons:function(){return this._ToolbarButtons},set_ToolbarButtons:function(a){if(this._ToolbarButtons!=a){this._ToolbarButtons=a;this.raisePropertyChanged(g)}},get_Text:function(){return this._Text},set_Text:function(a){if(this._Text!=a){this._Text=a;this.raisePropertyChanged("Text")}}};Sys.Extended.UI.HtmlEditorExtenderBehavior.registerClass("Sys.Extended.UI.HtmlEditorExtenderBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.HtmlEditorExtenderBehavior,{name:"HtmlEditorExtender",parameters:[{name:g,type:"HtmlEditorExtenderButton[]"}]})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(d,["ExtendedBase","ExtendedCommon"],c);else c()})();