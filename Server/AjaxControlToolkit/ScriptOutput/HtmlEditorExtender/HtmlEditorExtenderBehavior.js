// (c) 2010 CodePlex Foundation
(function(){var a=null,d="HtmlEditorExtenderBehavior",b=a;function c(){var f="ToolbarButtons",e=false,d="blur",c=true;Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.HtmlEditorExtenderButton=function(){var b=this;b._name=a;b._iconIndex=a;b._title=a;b._offset=a};Sys.Extended.UI.HtmlEditorExtenderButton.prototype={get_Name:function(){return this._name},set_Name:function(){if(this._name!=value){this._name=value;this.raisePropertyChanged("Name")}},get_Title:function(){return this._title+"test-prototype-success"},set_Title:function(){if(this._title!=value){this._title=value;this.raisePropertyChanged("Title")}},get_IconIndex:function(){return this._iconIndex},set_IconIndex:function(){if(this._iconIndex!=value){this._iconIndex=value;this.raisePropertyChanged("IconIndex")}},get_Offset:function(){return this._offset},set_Offset:function(){if(this._iconIndex!=value){this._iconIndex=value;this.raisePropertyChanged("Offset")}}};Sys.Extended.UI.HtmlEditorExtenderButton.registerClass("Sys.Extended.UI.HtmlEditorExtenderButton");Sys.Extended.UI.HtmlEditorExtenderBehavior=function(h){var f="_ExtenderButtonContainer",e="div",d=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.initializeBase(d,[h]);b=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(h);window.document.designMode="On";var g=d.get_id();d._ButtonWidth=23;d._ButtonHeight=21;d._containerTemplate={nodeName:e,properties:{id:g+"_ExtenderContainer"}};d._editableTemplate={nodeName:e,properties:{id:g+"_ExtenderContentEditable",style:{width:"100%",height:"100%",borderStyle:"outset",overflow:"scroll",clear:"both"},contentEditable:c}};d._buttonTemplate={nodeName:e,properties:{style:{width:d._ButtonWidth+"px",height:d._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button"]};d._topButtonContainerTemplate={nodeName:e,properties:{id:g+f}};d._topButtonContainerTemplate={nodeName:e,properties:{id:g+f}};d._container=a;d._ToolbarButtons=a;d._editableDiv=a;d._topButtonContainer=a;d._buttons=[];d._btnClickHandler=a;d._requested_buttons=[]};Sys.Extended.UI.HtmlEditorExtenderBehavior.prototype={initialize:function(){var e=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(e,"initialize");var h=0;e._button_list=[];e._createContainer();e._createTopButtonContainer();e._createEditableDiv(e._textbox);e._createButton();var f=b._element.parentNode;while(f!=a&&f.nodeName!="FORM")f=f.parentNode;if(f==a)throw"Missing Form tag";$addHandler(b._element,d,e._textBox_onblur,c);$addHandler(e._editableDiv,d,e._editableDiv_onblur,c);$addHandler(f,"submit",e._editableDiv_submit,c);e._btnClickHandler=Function.createDelegate(e,e._executeCommand);for(var g=0;g<e._buttons.length;g++)$addHandler(e._buttons[g],"click",e._btnClickHandler)},_dispose:function(){var a=this;$removeHandler(b._element,d,a._textBox_onblur);$removeHandler(a._editableDiv,d,a._editableDiv_onblur);$removeHandler(document.forms[0],"submit",a._editableDiv_submit);for(var c=0;c<a._buttons.length;c++)$removeHandler(a._buttons[c],"click",a._btnClickHandler);Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(a,"dispose")},_createContainer:function(){var a=this,c=a.get_element();a._container=$common.createElementFromTemplate(a._containerTemplate,c.parentNode);$common.wrapElement(b._element,a._container,a._container)},_createTopButtonContainer:function(){this._topButtonContainer=$common.createElementFromTemplate(this._topButtonContainerTemplate,this._container)},_createButton:function(){var a=this;for(i=0;i<a._ToolbarButtons.length;i++){var b=$common.createElementFromTemplate(a._buttonTemplate,a._topButtonContainer);b.setAttribute("id",a._ToolbarButtons[i].Name);b.setAttribute("name",a._ToolbarButtons[i].Name);b.setAttribute("title",a._ToolbarButtons[i].Title);b.setAttribute("unselectable","on");b.style.backgroundPosition=a._ToolbarButtons[i].Offset;Array.add(a._buttons,b)}},_createEditableDiv:function(){var a=this,d=a.get_element();a._editableDiv=$common.createElementFromTemplate(a._editableTemplate,a._container);a._editableDiv.innerHTML=b._element.value;var c=$common.getBounds(b._element);$common.setSize(a._editableDiv,{width:c.width,height:c.height});$common.setVisible(b._element,e)},_editableDiv_onblur:function(){b._element.value=this.innerHTML},_textBox_onblur:function(){this._editableDiv.innerHTML=this.value},_editableDiv_submit:function(){var a=b._element.value.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;");b._element.value=a},_executeCommand:function(b){switch(b.target.title.toUpperCase()){case"BOLD":document.execCommand("styleWithCSS",0,e);document.execCommand("Bold",e,a);break;case"ITALIC":document.execCommand("Italic",e,a);break;case"UNDERLINE":document.execCommand("Underline");break;case"STRIKE THROUGH":document.execCommand("StrikeThrough");break;case"SUB SCRIPT":document.execCommand("Subscript");break;case"SUPER SCRIPT":document.execCommand("Superscript");break;case"JUSTIFY LEFT":document.execCommand("JustifyLeft");break;case"JUSTIFY RIGHT":document.execCommand("JustifyRight");break;case"JUSTIFY CENTER":document.execCommand("JustifyCenter");break;case"INSERT ORDERED LIST":document.execCommand("insertOrderedList");break;case"INSERT UNORDERED LIST":document.execCommand("insertUnorderedList")}},get_ButtonWidth:function(){return this._ButtonWidth},set_ButtonWidth:function(a){if(this._ButtonWidth!=a){this._ButtonWidth=a;this.raisePropertyChanged("ButtonWidth")}},get_ButtonHeight:function(){return this._ButtonHeight},set_ButtonHeight:function(a){if(this._ButtonHeight!=a){this._ButtonHeight=a;this.raisePropertyChanged("ButtonHeight")}},get_ToolbarButtons:function(){return this._ToolbarButtons},set_ToolbarButtons:function(a){if(this._ToolbarButtons!=a){this._ToolbarButtons=a;this.raisePropertyChanged(f)}},get_Text:function(){return this._Text},set_Text:function(a){if(this._Text!=a){this._Text=a;this.raisePropertyChanged("Text")}}};Sys.Extended.UI.HtmlEditorExtenderBehavior.registerClass("Sys.Extended.UI.HtmlEditorExtenderBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.HtmlEditorExtenderBehavior,{name:"HtmlEditorExtender",parameters:[{name:f,type:"HtmlEditorExtenderButton[]"}]})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(d,["ExtendedBase","ExtendedCommon"],c);else c()})();