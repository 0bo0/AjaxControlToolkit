// (c) 2010 CodePlex Foundation
(function(){var a=null,d="HtmlEditorExtenderBehavior",b=a;function c(){var f="ToolbarContent",d="blur",e="Underline",c=true;Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.HtmlEditorExtenderBehavior=function(h){var f="div",d=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.initializeBase(d,[h]);b=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(h);var g=d.get_id();d._buttonWidth=23;d._buttonHeight=21;d._containerTemplate={nodeName:f,visible:c,properties:{id:g+"_ExtenderContainer"}};d._editableTemplate={nodeName:f,properties:{id:g+"_ExtenderContentEditable",style:{width:"100%",height:"100%",borderStyle:"outset",overflow:"scroll",clear:"both"},contentEditable:c,designMode:"on"},visible:c};d._buttonTemplate={nodeName:f,properties:{style:{width:d._buttonWidth+"px",height:d._buttonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button"]};d._topButtonContainerTemplate={nodeName:f,properties:{id:g+"_ExtenderButtonContainer"}};d._container=a;d._ToolbarContent=a;d._editableDiv=a;d._topButtonContainer=a;d._buttons=[];d._btnClickHandler=a;d._button_names=["undo","redo","bold","italic","underline","strike","subscript","superscript","left_to_right","right_to_left","justify_left","justify_center","justify_right","justify","remove_alignment","ordered_list","bulleted_list","insert_horizontal_rule","insert_edit_url","remove_url","remove_style","cut","paste_plain_text","paste_from_msword","decrease_indent","increase_indent"];d._button_titles=["Undo","Redo","Bold","Italic",e,"Strike Through","Sub script","Super script","Left to right direction","Right to left direction","Justify Left","Justify Center","Justify Right","Justify","Remove Alignment","Ordered List","Bulleted List","Insert horizontal rule","Insert/edit URL","Remove URL","Remove Style","Cut","Paste plain text","Paste from MS Word","Decrease Indent","Increase Indent"]};Sys.Extended.UI.HtmlEditorExtenderBehavior.prototype={initialize:function(){var e=this;Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(e,"initialize");var g=0;e._button_list=[];for(var i in e._button_names){e._button_list[g]=new e._buttonInfo(e._button_names[g],e._button_titles[g],g,g*e._buttonWidth,0);g++}e._createContainer();e._createTopButtonContainer();e._createEditableDiv(e._textbox);e._createButton();var f=b._element.parentNode;while(f!=a&&f.nodeName!="FORM")f=f.parentNode;if(f==a)throw"Missing Form tag";$addHandler(b._element,d,e._textBox_onblur,c);$addHandler(e._editableDiv,d,e._editableDiv_onblur,c);$addHandler(f,"submit",e._editableDiv_submit,c);e._btnClickHandler=Function.createDelegate(e,e._executeCommand);for(var h=0;h<e._buttons.length;h++)$addHandler(e._buttons[h],"click",e._btnClickHandler)},_dispose:function(){var a=this;$removeHandler(b._element,d,a._textBox_onblur);$removeHandler(a._editableDiv,d,a._editableDiv_onblur);$removeHandler(document.forms[0],"submit",a._editableDiv_submit);for(var c=0;c<a._buttons.length;c++)$removeHandler(a._buttons[c],"click",a._btnClickHandler);Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(a,"dispose")},_createContainer:function(){var a=this,c=a.get_element();a._container=$common.createElementFromTemplate(a._containerTemplate,c.parentNode);$common.wrapElement(b._element,a._container,a._container)},_createTopButtonContainer:function(){this._topButtonContainer=$common.createElementFromTemplate(this._topButtonContainerTemplate,this._container)},_createButton:function(){var a=this;for(var b=0;b<a._button_list.length;b++){var c=$common.createElementFromTemplate(a._buttonTemplate,a._topButtonContainer);c.setAttribute("id",a._button_list[b].Name);c.setAttribute("name",a._button_list[b].Name);c.setAttribute("title",a._button_list[b].Title);c.setAttribute("unselectable","on");c.style.backgroundPosition=a._button_list[b].X*-1+"px "+a._button_list[b].Y*-1+"px";Array.add(a._buttons,c)}},_createEditableDiv:function(){var a=this,e=a.get_element();a._editableDiv=$common.createElementFromTemplate(a._editableTemplate,a._container);var d=a._decodeText(b._element.value);a._editableDiv.innerHTML=b._element.value=d;var c=$common.getBounds(b._element);$common.setSize(a._editableDiv,{width:c.width,height:c.height});$common.setVisible(b._element,false)},_editableDiv_onblur:function(){b._element.value=this.innerHTML},_textBox_onblur:function(){this._editableDiv.innerHTML=this.value},_editableDiv_submit:function(){var a=b._element.value.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;");b._element.value=a},_encodeText:function(a){return a.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;")},_decodeText:function(a){return a.replace(/&amp;/ig,"&").replace(/&lt;/ig,"<").replace(/&gt;/ig,">").replace(/&quot;/ig,'"').replace(/&nbsp;/ig,"Â ")},_executeCommand:function(a){switch(a.target.title.toUpperCase()){case"BOLD":document.execCommand("Bold");break;case"ITALIC":document.execCommand("Italic");break;case"UNDERLINE":document.execCommand(e);break;case"STRIKE THROUGH":document.execCommand("StrikeThrough");break;case"SUB SCRIPT":document.execCommand("Subscript");break;case"SUPER SCRIPT":document.execCommand("Superscript");break;case"JUSTIFY LEFT":document.execCommand("JustifyLeft");break;case"JUSTIFY RIGHT":document.execCommand("JustifyRight");break;case"JUSTIFY CENTER":document.execCommand("JustifyCenter");break;case"ORDERED LIST":document.execCommand("insertOrderedList");break;case"BULLETED LIST":document.execCommand("insertUnorderedList")}},_buttonInfo:function(d,c,b,e,f){var a=this;a.Index=b;a.X=e;a.Y=f;a.Name="btn_"+d;a.Title=c},get_ToolbarContent:function(){return this._ToolbarContent},set_ToolbarContent:function(a){if(this._ToolbarContent!=a)this._ToolbarContent=a;this.raisePropertyChanged(f)}};Sys.Extended.UI.HtmlEditorExtenderBehavior.registerClass("Sys.Extended.UI.HtmlEditorExtenderBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.HtmlEditorExtenderBehavior,{name:"HtmlEditorExtender",parameters:[{name:f,type:"String"}]})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(d,["ExtendedBase","ExtendedCommon"],c);else c()})();